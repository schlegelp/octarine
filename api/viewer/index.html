<!DOCTYPE html><html lang="en" class="no-js"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Fast and easy-to-use 3D Viewer for Python"><link href="../../faq/" rel="prev"><link href="../selection/" rel="next"><link rel="icon" href="../../images/icon.png"><meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22"><title>Viewer - octarine</title><link rel="stylesheet" href="../../assets/stylesheets/main.84d31ad4.min.css"><link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css"><link rel="stylesheet" href="../../assets/external/fonts.googleapis.com/css.49ea35f2.css"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel="stylesheet" href="../../assets/_mkdocstrings.css"><link rel="stylesheet" href="../../stylesheets/extra.css"><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><meta property="og:type" content="website"><meta property="og:title" content="Viewer - octarine"><meta property="og:description" content="Fast and easy-to-use 3D Viewer for Python"><meta property="og:image" content="./assets/images/social/api/viewer.png"><meta property="og:image:type" content="image/png"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta property="og:url" content="None"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:title" content="Viewer - octarine"><meta name="twitter:description" content="Fast and easy-to-use 3D Viewer for Python"><meta name="twitter:image" content="./assets/images/social/api/viewer.png"><link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"><script src="../../assets/javascripts/glightbox.min.js"></script><style id="glightbox-style">
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color); }
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color); }
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color); }
        </style></head> <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"> <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off"> <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off"> <label class="md-overlay" for="__drawer"></label> <div data-md-component="skip"> <a href="#octarineviewer" class="md-skip"> Skip to content </a> </div> <div data-md-component="announce"> </div> <header class="md-header md-header--shadow" data-md-component="header"> <nav class="md-header__inner md-grid" aria-label="Header"> <a href="../.." title="octarine" class="md-header__button md-logo" aria-label="octarine" data-md-component="logo"> <img src="../../images/icon.png" alt="logo"> </a> <label class="md-header__button md-icon" for="__drawer"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg> </label> <div class="md-header__title" data-md-component="header-title"> <div class="md-header__ellipsis"> <div class="md-header__topic"> <span class="md-ellipsis"> octarine </span> </div> <div class="md-header__topic" data-md-component="header-topic"> <span class="md-ellipsis"> Viewer </span> </div> </div> </div> <form class="md-header__option" data-md-component="palette"> <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo" aria-label="Switch to dark mode" type="radio" name="__palette" id="__palette_0"> <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M296.5 291.1C321 265.2 336 230.4 336 192c0-79.5-64.5-144-144-144S48 112.5 48 192c0 38.4 15 73.2 39.5 99.1 21.3 22.4 44.9 54 53.3 92.9h102.4c8.4-39 32-70.5 53.3-92.9m34.8 33C307.7 349 288 379.4 288 413.7V432c0 44.2-35.8 80-80 80h-32c-44.2 0-80-35.8-80-80v-18.3c0-34.3-19.7-64.7-43.3-89.6C20 289.7 0 243.2 0 192 0 86 86 0 192 0s192 86 192 192c0 51.2-20 97.7-52.7 132.1M144 184c0 13.3-10.7 24-24 24s-24-10.7-24-24c0-48.6 39.4-88 88-88 13.3 0 24 10.7 24 24s-10.7 24-24 24c-22.1 0-40 17.9-40 40"></path></svg> </label> <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="pink" data-md-color-accent="pink" aria-label="Switch to light mode" type="radio" name="__palette" id="__palette_1"> <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M292.9 384c7.3-22.3 21.9-42.5 38.4-59.9C364 289.7 384 243.2 384 192 384 86 298 0 192 0S0 86 0 192c0 51.2 20 97.7 52.7 132.1 16.5 17.4 31.2 37.6 38.4 59.9h201.7zm-4.9 48H96v16c0 44.2 35.8 80 80 80h32c44.2 0 80-35.8 80-80zM184 112c-39.8 0-72 32.2-72 72 0 13.3-10.7 24-24 24s-24-10.7-24-24c0-66.3 53.7-120 120-120 13.3 0 24 10.7 24 24s-10.7 24-24 24"></path></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for="__search"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> </label> <div class="md-search" data-md-component="search" role="dialog"> <label class="md-search__overlay" for="__search"></label> <div class="md-search__inner" role="search"> <form class="md-search__form" name="search"> <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required> <label class="md-search__icon md-icon" for="__search"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg> </label> <nav class="md-search__options" aria-label="Search"> <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg> </button> </nav> </form> <div class="md-search__output"> <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix> <div class="md-search-result" data-md-component="search-result"> <div class="md-search-result__meta"> Initializing search </div> <ol class="md-search-result__list" role="presentation"></ol> </div> </div> </div> </div> </div> <div class="md-header__source"> <a href="https://github.com/schlegelp/octarine" title="Go to repository" class="md-source" data-md-component="source"> <div class="md-source__icon md-icon"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg> </div> <div class="md-source__repository"> schlegelp/octarine </div> </a> </div> </nav> </header> <div class="md-container" data-md-component="container"> <main class="md-main" data-md-component="main"> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0"> <label class="md-nav__title" for="__drawer"> <a href="../.." title="octarine" class="md-nav__button md-logo" aria-label="octarine" data-md-component="logo"> <img src="../../images/icon.png" alt="logo"> </a> octarine </label> <div class="md-nav__source"> <a href="https://github.com/schlegelp/octarine" title="Go to repository" class="md-source" data-md-component="source"> <div class="md-source__icon md-icon"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg> </div> <div class="md-source__repository"> schlegelp/octarine </div> </a> </div> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../.." class="md-nav__link"> <span class="md-ellipsis"> Home </span> </a> </li> <li class="md-nav__item"> <a href="../../install/" class="md-nav__link"> <span class="md-ellipsis"> Installation </span> </a> </li> <li class="md-nav__item"> <a href="../../intro/" class="md-nav__link"> <span class="md-ellipsis"> The Basics </span> </a> </li> <li class="md-nav__item"> <a href="../../objects/" class="md-nav__link"> <span class="md-ellipsis"> Adding Objects </span> </a> </li> <li class="md-nav__item"> <a href="../../manage/" class="md-nav__link"> <span class="md-ellipsis"> Managing Objects </span> </a> </li> <li class="md-nav__item"> <a href="../../controls/" class="md-nav__link"> <span class="md-ellipsis"> Viewer Controls </span> </a> </li> <li class="md-nav__item"> <a href="../../selections/" class="md-nav__link"> <span class="md-ellipsis"> Selecting Objects </span> </a> </li> <li class="md-nav__item"> <a href="../../animations/" class="md-nav__link"> <span class="md-ellipsis"> Animations </span> </a> </li> <li class="md-nav__item"> <a href="../../triggers/" class="md-nav__link"> <span class="md-ellipsis"> Render Triggers </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10"> <div class="md-nav__link md-nav__container"> <a href="../../extending/" class="md-nav__link "> <span class="md-ellipsis"> Extending Octarine </span> </a> <label class="md-nav__link " for="__nav_10" id="__nav_10_label" tabindex="0"> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false"> <label class="md-nav__title" for="__nav_10"> <span class="md-nav__icon md-icon"></span> Extending Octarine </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item"> <a href="../../extending/converters/" class="md-nav__link"> <span class="md-ellipsis"> Custom Converters </span> </a> </li> <li class="md-nav__item"> <a href="../../extending/plugins/" class="md-nav__link"> <span class="md-ellipsis"> Plugins </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../../changelog/" class="md-nav__link"> <span class="md-ellipsis"> Changelog </span> </a> </li> <li class="md-nav__item"> <a href="../../faq/" class="md-nav__link"> <span class="md-ellipsis"> FAQ </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13" checked> <label class="md-nav__link" for="__nav_13" id="__nav_13_label" tabindex="0"> <span class="md-ellipsis"> API </span> <span class="md-nav__icon md-icon"></span> </label> <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_13_label" aria-expanded="true"> <label class="md-nav__title" for="__nav_13"> <span class="md-nav__icon md-icon"></span> API </label> <ul class="md-nav__list" data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc"> <label class="md-nav__link md-nav__link--active" for="__toc"> <span class="md-ellipsis"> Viewer </span> <span class="md-nav__icon md-icon"></span> </label> <a href="./" class="md-nav__link md-nav__link--active"> <span class="md-ellipsis"> Viewer </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class="md-nav__title" for="__toc"> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix> <li class="md-nav__item"> <a href="#octarine.Viewer" class="md-nav__link"> <span class="md-ellipsis"> Viewer </span> </a> <nav class="md-nav" aria-label="Viewer"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#octarine.Viewer.blend_mode" class="md-nav__link"> <span class="md-ellipsis"> blend_mode </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.bounds" class="md-nav__link"> <span class="md-ellipsis"> bounds </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.controls" class="md-nav__link"> <span class="md-ellipsis"> controls </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.highlighted" class="md-nav__link"> <span class="md-ellipsis"> highlighted </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.invisible" class="md-nav__link"> <span class="md-ellipsis"> invisible </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.max_fps" class="md-nav__link"> <span class="md-ellipsis"> max_fps </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.moveable_object" class="md-nav__link"> <span class="md-ellipsis"> moveable_object </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.on_double_click" class="md-nav__link"> <span class="md-ellipsis"> on_double_click </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.on_hover" class="md-nav__link"> <span class="md-ellipsis"> on_hover </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.pinned" class="md-nav__link"> <span class="md-ellipsis"> pinned </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.render_trigger" class="md-nav__link"> <span class="md-ellipsis"> render_trigger </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.selected" class="md-nav__link"> <span class="md-ellipsis"> selected </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.shadows" class="md-nav__link"> <span class="md-ellipsis"> shadows </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.show_bounds" class="md-nav__link"> <span class="md-ellipsis"> show_bounds </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.show_fps" class="md-nav__link"> <span class="md-ellipsis"> show_fps </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.size" class="md-nav__link"> <span class="md-ellipsis"> size </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.visible" class="md-nav__link"> <span class="md-ellipsis"> visible </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.visuals" class="md-nav__link"> <span class="md-ellipsis"> visuals </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.__init__" class="md-nav__link"> <span class="md-ellipsis"> __init__ </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.add" class="md-nav__link"> <span class="md-ellipsis"> add </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.add_animation" class="md-nav__link"> <span class="md-ellipsis"> add_animation </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.add_effect" class="md-nav__link"> <span class="md-ellipsis"> add_effect </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.add_lines" class="md-nav__link"> <span class="md-ellipsis"> add_lines </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.add_mesh" class="md-nav__link"> <span class="md-ellipsis"> add_mesh </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.add_points" class="md-nav__link"> <span class="md-ellipsis"> add_points </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.add_volume" class="md-nav__link"> <span class="md-ellipsis"> add_volume </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.bind_key" class="md-nav__link"> <span class="md-ellipsis"> bind_key </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.center_camera" class="md-nav__link"> <span class="md-ellipsis"> center_camera </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.clear" class="md-nav__link"> <span class="md-ellipsis"> clear </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.close" class="md-nav__link"> <span class="md-ellipsis"> close </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.colorize" class="md-nav__link"> <span class="md-ellipsis"> colorize </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.get_view" class="md-nav__link"> <span class="md-ellipsis"> get_view </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.hide_controls" class="md-nav__link"> <span class="md-ellipsis"> hide_controls </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.hide_objects" class="md-nav__link"> <span class="md-ellipsis"> hide_objects </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.hide_selected" class="md-nav__link"> <span class="md-ellipsis"> hide_selected </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.highlight_objects" class="md-nav__link"> <span class="md-ellipsis"> highlight_objects </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.pin_objects" class="md-nav__link"> <span class="md-ellipsis"> pin_objects </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.pop" class="md-nav__link"> <span class="md-ellipsis"> pop </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.remove_animation" class="md-nav__link"> <span class="md-ellipsis"> remove_animation </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.remove_bounds" class="md-nav__link"> <span class="md-ellipsis"> remove_bounds </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.remove_objects" class="md-nav__link"> <span class="md-ellipsis"> remove_objects </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.resize" class="md-nav__link"> <span class="md-ellipsis"> resize </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.screenshot" class="md-nav__link"> <span class="md-ellipsis"> screenshot </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.set_alpha_mode" class="md-nav__link"> <span class="md-ellipsis"> set_alpha_mode </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.set_bgcolor" class="md-nav__link"> <span class="md-ellipsis"> set_bgcolor </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.set_colors" class="md-nav__link"> <span class="md-ellipsis"> set_colors </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.set_view" class="md-nav__link"> <span class="md-ellipsis"> set_view </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.show" class="md-nav__link"> <span class="md-ellipsis"> show </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.show_controls" class="md-nav__link"> <span class="md-ellipsis"> show_controls </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.show_message" class="md-nav__link"> <span class="md-ellipsis"> show_message </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.toggle_bounds" class="md-nav__link"> <span class="md-ellipsis"> toggle_bounds </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.unhide_objects" class="md-nav__link"> <span class="md-ellipsis"> unhide_objects </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.unhighlight_objects" class="md-nav__link"> <span class="md-ellipsis"> unhighlight_objects </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.unpin_objects" class="md-nav__link"> <span class="md-ellipsis"> unpin_objects </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.update_bounds" class="md-nav__link"> <span class="md-ellipsis"> update_bounds </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item"> <a href="../selection/" class="md-nav__link"> <span class="md-ellipsis"> Selection </span> </a> </li> <li class="md-nav__item"> <a href="../utils/" class="md-nav__link"> <span class="md-ellipsis"> Utility </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc"> <div class="md-sidebar__scrollwrap"> <div class="md-sidebar__inner"> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class="md-nav__title" for="__toc"> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix> <li class="md-nav__item"> <a href="#octarine.Viewer" class="md-nav__link"> <span class="md-ellipsis"> Viewer </span> </a> <nav class="md-nav" aria-label="Viewer"> <ul class="md-nav__list"> <li class="md-nav__item"> <a href="#octarine.Viewer.blend_mode" class="md-nav__link"> <span class="md-ellipsis"> blend_mode </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.bounds" class="md-nav__link"> <span class="md-ellipsis"> bounds </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.controls" class="md-nav__link"> <span class="md-ellipsis"> controls </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.highlighted" class="md-nav__link"> <span class="md-ellipsis"> highlighted </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.invisible" class="md-nav__link"> <span class="md-ellipsis"> invisible </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.max_fps" class="md-nav__link"> <span class="md-ellipsis"> max_fps </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.moveable_object" class="md-nav__link"> <span class="md-ellipsis"> moveable_object </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.on_double_click" class="md-nav__link"> <span class="md-ellipsis"> on_double_click </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.on_hover" class="md-nav__link"> <span class="md-ellipsis"> on_hover </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.pinned" class="md-nav__link"> <span class="md-ellipsis"> pinned </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.render_trigger" class="md-nav__link"> <span class="md-ellipsis"> render_trigger </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.selected" class="md-nav__link"> <span class="md-ellipsis"> selected </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.shadows" class="md-nav__link"> <span class="md-ellipsis"> shadows </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.show_bounds" class="md-nav__link"> <span class="md-ellipsis"> show_bounds </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.show_fps" class="md-nav__link"> <span class="md-ellipsis"> show_fps </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.size" class="md-nav__link"> <span class="md-ellipsis"> size </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.visible" class="md-nav__link"> <span class="md-ellipsis"> visible </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.visuals" class="md-nav__link"> <span class="md-ellipsis"> visuals </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.__init__" class="md-nav__link"> <span class="md-ellipsis"> __init__ </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.add" class="md-nav__link"> <span class="md-ellipsis"> add </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.add_animation" class="md-nav__link"> <span class="md-ellipsis"> add_animation </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.add_effect" class="md-nav__link"> <span class="md-ellipsis"> add_effect </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.add_lines" class="md-nav__link"> <span class="md-ellipsis"> add_lines </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.add_mesh" class="md-nav__link"> <span class="md-ellipsis"> add_mesh </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.add_points" class="md-nav__link"> <span class="md-ellipsis"> add_points </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.add_volume" class="md-nav__link"> <span class="md-ellipsis"> add_volume </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.bind_key" class="md-nav__link"> <span class="md-ellipsis"> bind_key </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.center_camera" class="md-nav__link"> <span class="md-ellipsis"> center_camera </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.clear" class="md-nav__link"> <span class="md-ellipsis"> clear </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.close" class="md-nav__link"> <span class="md-ellipsis"> close </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.colorize" class="md-nav__link"> <span class="md-ellipsis"> colorize </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.get_view" class="md-nav__link"> <span class="md-ellipsis"> get_view </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.hide_controls" class="md-nav__link"> <span class="md-ellipsis"> hide_controls </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.hide_objects" class="md-nav__link"> <span class="md-ellipsis"> hide_objects </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.hide_selected" class="md-nav__link"> <span class="md-ellipsis"> hide_selected </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.highlight_objects" class="md-nav__link"> <span class="md-ellipsis"> highlight_objects </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.pin_objects" class="md-nav__link"> <span class="md-ellipsis"> pin_objects </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.pop" class="md-nav__link"> <span class="md-ellipsis"> pop </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.remove_animation" class="md-nav__link"> <span class="md-ellipsis"> remove_animation </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.remove_bounds" class="md-nav__link"> <span class="md-ellipsis"> remove_bounds </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.remove_objects" class="md-nav__link"> <span class="md-ellipsis"> remove_objects </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.resize" class="md-nav__link"> <span class="md-ellipsis"> resize </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.screenshot" class="md-nav__link"> <span class="md-ellipsis"> screenshot </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.set_alpha_mode" class="md-nav__link"> <span class="md-ellipsis"> set_alpha_mode </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.set_bgcolor" class="md-nav__link"> <span class="md-ellipsis"> set_bgcolor </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.set_colors" class="md-nav__link"> <span class="md-ellipsis"> set_colors </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.set_view" class="md-nav__link"> <span class="md-ellipsis"> set_view </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.show" class="md-nav__link"> <span class="md-ellipsis"> show </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.show_controls" class="md-nav__link"> <span class="md-ellipsis"> show_controls </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.show_message" class="md-nav__link"> <span class="md-ellipsis"> show_message </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.toggle_bounds" class="md-nav__link"> <span class="md-ellipsis"> toggle_bounds </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.unhide_objects" class="md-nav__link"> <span class="md-ellipsis"> unhide_objects </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.unhighlight_objects" class="md-nav__link"> <span class="md-ellipsis"> unhighlight_objects </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.unpin_objects" class="md-nav__link"> <span class="md-ellipsis"> unpin_objects </span> </a> </li> <li class="md-nav__item"> <a href="#octarine.Viewer.update_bounds" class="md-nav__link"> <span class="md-ellipsis"> update_bounds </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-content" data-md-component="content"> <article class="md-content__inner md-typeset"> <h1 id="octarineviewer">octarine.Viewer<a class="headerlink" href="#octarineviewer" title="Permanent link">#</a></h1> <div class="doc doc-object doc-class"> <h2 id="octarine.Viewer" class="doc doc-heading"> <code>octarine.Viewer</code> <a href="#octarine.Viewer" class="headerlink" title="Permanent link">#</a></h2> <div class="doc doc-contents first"> <p>PyGFX 3D viewer.</p> <table> <thead> <tr> <th><span class="doc-section-title">PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class="doc-section-item"> <td> <code>offscreen</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    If True, will use an offscreen Canvas. Useful if you only
    want a screenshot.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>False</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>title</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    Title of the viewer window.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> str</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>'Octarine Viewer'</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>max_fps</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    Maximum frames per second to render.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> int</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>30</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>size</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    Size of the viewer window.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> tuple</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>camera</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    Type of camera to use. Defaults to "ortho". Note you can always
    change the camera type by adjust the `Viewer.camera.fov` attribute
    (0 = ortho, &gt;0 = perspective).
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> "ortho" | "perspective"</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>'ortho'</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>control</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    Controller type to use. Defaults to "trackball".
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> "trackball" | "panzoom" | "fly" | "orbit"</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>'trackball'</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>show</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    Whether to immediately show the viewer. When set to "auto" (default),
    will immmediately show the viewer if:
     - we are in a Jupyter environment
     - we are in an iPython session and we can hook into an iPython event loop
    If neither of the above applies or `show=False`, you will have to manually run
    `Viewer.show()`. This gives you the chance to add objects to the viewer
    before it is shown and the blocking event loop is started.
    The `show` parameter is ignored if `offscreen` is True.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> "auto" (default) | bool</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>True</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>**kwargs</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    Keyword arguments are passed through to ``WgpuCanvas``.
</code></pre></div> </div> <p> <span class="doc-param-default"> <b>DEFAULT:</b> <code>{}</code> </span> </p> </td> </tr> </tbody> </table> <details class="quote"> <summary>Source code in <code>octarine/viewer.py</code></summary> <div class="highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  86</span>
<span class="normal">  87</span>
<span class="normal">  88</span>
<span class="normal">  89</span>
<span class="normal">  90</span>
<span class="normal">  91</span>
<span class="normal">  92</span>
<span class="normal">  93</span>
<span class="normal">  94</span>
<span class="normal">  95</span>
<span class="normal">  96</span>
<span class="normal">  97</span>
<span class="normal">  98</span>
<span class="normal">  99</span>
<span class="normal"> 100</span>
<span class="normal"> 101</span>
<span class="normal"> 102</span>
<span class="normal"> 103</span>
<span class="normal"> 104</span>
<span class="normal"> 105</span>
<span class="normal"> 106</span>
<span class="normal"> 107</span>
<span class="normal"> 108</span>
<span class="normal"> 109</span>
<span class="normal"> 110</span>
<span class="normal"> 111</span>
<span class="normal"> 112</span>
<span class="normal"> 113</span>
<span class="normal"> 114</span>
<span class="normal"> 115</span>
<span class="normal"> 116</span>
<span class="normal"> 117</span>
<span class="normal"> 118</span>
<span class="normal"> 119</span>
<span class="normal"> 120</span>
<span class="normal"> 121</span>
<span class="normal"> 122</span>
<span class="normal"> 123</span>
<span class="normal"> 124</span>
<span class="normal"> 125</span>
<span class="normal"> 126</span>
<span class="normal"> 127</span>
<span class="normal"> 128</span>
<span class="normal"> 129</span>
<span class="normal"> 130</span>
<span class="normal"> 131</span>
<span class="normal"> 132</span>
<span class="normal"> 133</span>
<span class="normal"> 134</span>
<span class="normal"> 135</span>
<span class="normal"> 136</span>
<span class="normal"> 137</span>
<span class="normal"> 138</span>
<span class="normal"> 139</span>
<span class="normal"> 140</span>
<span class="normal"> 141</span>
<span class="normal"> 142</span>
<span class="normal"> 143</span>
<span class="normal"> 144</span>
<span class="normal"> 145</span>
<span class="normal"> 146</span>
<span class="normal"> 147</span>
<span class="normal"> 148</span>
<span class="normal"> 149</span>
<span class="normal"> 150</span>
<span class="normal"> 151</span>
<span class="normal"> 152</span>
<span class="normal"> 153</span>
<span class="normal"> 154</span>
<span class="normal"> 155</span>
<span class="normal"> 156</span>
<span class="normal"> 157</span>
<span class="normal"> 158</span>
<span class="normal"> 159</span>
<span class="normal"> 160</span>
<span class="normal"> 161</span>
<span class="normal"> 162</span>
<span class="normal"> 163</span>
<span class="normal"> 164</span>
<span class="normal"> 165</span>
<span class="normal"> 166</span>
<span class="normal"> 167</span>
<span class="normal"> 168</span>
<span class="normal"> 169</span>
<span class="normal"> 170</span>
<span class="normal"> 171</span>
<span class="normal"> 172</span>
<span class="normal"> 173</span>
<span class="normal"> 174</span>
<span class="normal"> 175</span>
<span class="normal"> 176</span>
<span class="normal"> 177</span>
<span class="normal"> 178</span>
<span class="normal"> 179</span>
<span class="normal"> 180</span>
<span class="normal"> 181</span>
<span class="normal"> 182</span>
<span class="normal"> 183</span>
<span class="normal"> 184</span>
<span class="normal"> 185</span>
<span class="normal"> 186</span>
<span class="normal"> 187</span>
<span class="normal"> 188</span>
<span class="normal"> 189</span>
<span class="normal"> 190</span>
<span class="normal"> 191</span>
<span class="normal"> 192</span>
<span class="normal"> 193</span>
<span class="normal"> 194</span>
<span class="normal"> 195</span>
<span class="normal"> 196</span>
<span class="normal"> 197</span>
<span class="normal"> 198</span>
<span class="normal"> 199</span>
<span class="normal"> 200</span>
<span class="normal"> 201</span>
<span class="normal"> 202</span>
<span class="normal"> 203</span>
<span class="normal"> 204</span>
<span class="normal"> 205</span>
<span class="normal"> 206</span>
<span class="normal"> 207</span>
<span class="normal"> 208</span>
<span class="normal"> 209</span>
<span class="normal"> 210</span>
<span class="normal"> 211</span>
<span class="normal"> 212</span>
<span class="normal"> 213</span>
<span class="normal"> 214</span>
<span class="normal"> 215</span>
<span class="normal"> 216</span>
<span class="normal"> 217</span>
<span class="normal"> 218</span>
<span class="normal"> 219</span>
<span class="normal"> 220</span>
<span class="normal"> 221</span>
<span class="normal"> 222</span>
<span class="normal"> 223</span>
<span class="normal"> 224</span>
<span class="normal"> 225</span>
<span class="normal"> 226</span>
<span class="normal"> 227</span>
<span class="normal"> 228</span>
<span class="normal"> 229</span>
<span class="normal"> 230</span>
<span class="normal"> 231</span>
<span class="normal"> 232</span>
<span class="normal"> 233</span>
<span class="normal"> 234</span>
<span class="normal"> 235</span>
<span class="normal"> 236</span>
<span class="normal"> 237</span>
<span class="normal"> 238</span>
<span class="normal"> 239</span>
<span class="normal"> 240</span>
<span class="normal"> 241</span>
<span class="normal"> 242</span>
<span class="normal"> 243</span>
<span class="normal"> 244</span>
<span class="normal"> 245</span>
<span class="normal"> 246</span>
<span class="normal"> 247</span>
<span class="normal"> 248</span>
<span class="normal"> 249</span>
<span class="normal"> 250</span>
<span class="normal"> 251</span>
<span class="normal"> 252</span>
<span class="normal"> 253</span>
<span class="normal"> 254</span>
<span class="normal"> 255</span>
<span class="normal"> 256</span>
<span class="normal"> 257</span>
<span class="normal"> 258</span>
<span class="normal"> 259</span>
<span class="normal"> 260</span>
<span class="normal"> 261</span>
<span class="normal"> 262</span>
<span class="normal"> 263</span>
<span class="normal"> 264</span>
<span class="normal"> 265</span>
<span class="normal"> 266</span>
<span class="normal"> 267</span>
<span class="normal"> 268</span>
<span class="normal"> 269</span>
<span class="normal"> 270</span>
<span class="normal"> 271</span>
<span class="normal"> 272</span>
<span class="normal"> 273</span>
<span class="normal"> 274</span>
<span class="normal"> 275</span>
<span class="normal"> 276</span>
<span class="normal"> 277</span>
<span class="normal"> 278</span>
<span class="normal"> 279</span>
<span class="normal"> 280</span>
<span class="normal"> 281</span>
<span class="normal"> 282</span>
<span class="normal"> 283</span>
<span class="normal"> 284</span>
<span class="normal"> 285</span>
<span class="normal"> 286</span>
<span class="normal"> 287</span>
<span class="normal"> 288</span>
<span class="normal"> 289</span>
<span class="normal"> 290</span>
<span class="normal"> 291</span>
<span class="normal"> 292</span>
<span class="normal"> 293</span>
<span class="normal"> 294</span>
<span class="normal"> 295</span>
<span class="normal"> 296</span>
<span class="normal"> 297</span>
<span class="normal"> 298</span>
<span class="normal"> 299</span>
<span class="normal"> 300</span>
<span class="normal"> 301</span>
<span class="normal"> 302</span>
<span class="normal"> 303</span>
<span class="normal"> 304</span>
<span class="normal"> 305</span>
<span class="normal"> 306</span>
<span class="normal"> 307</span>
<span class="normal"> 308</span>
<span class="normal"> 309</span>
<span class="normal"> 310</span>
<span class="normal"> 311</span>
<span class="normal"> 312</span>
<span class="normal"> 313</span>
<span class="normal"> 314</span>
<span class="normal"> 315</span>
<span class="normal"> 316</span>
<span class="normal"> 317</span>
<span class="normal"> 318</span>
<span class="normal"> 319</span>
<span class="normal"> 320</span>
<span class="normal"> 321</span>
<span class="normal"> 322</span>
<span class="normal"> 323</span>
<span class="normal"> 324</span>
<span class="normal"> 325</span>
<span class="normal"> 326</span>
<span class="normal"> 327</span>
<span class="normal"> 328</span>
<span class="normal"> 329</span>
<span class="normal"> 330</span>
<span class="normal"> 331</span>
<span class="normal"> 332</span>
<span class="normal"> 333</span>
<span class="normal"> 334</span>
<span class="normal"> 335</span>
<span class="normal"> 336</span>
<span class="normal"> 337</span>
<span class="normal"> 338</span>
<span class="normal"> 339</span>
<span class="normal"> 340</span>
<span class="normal"> 341</span>
<span class="normal"> 342</span>
<span class="normal"> 343</span>
<span class="normal"> 344</span>
<span class="normal"> 345</span>
<span class="normal"> 346</span>
<span class="normal"> 347</span>
<span class="normal"> 348</span>
<span class="normal"> 349</span>
<span class="normal"> 350</span>
<span class="normal"> 351</span>
<span class="normal"> 352</span>
<span class="normal"> 353</span>
<span class="normal"> 354</span>
<span class="normal"> 355</span>
<span class="normal"> 356</span>
<span class="normal"> 357</span>
<span class="normal"> 358</span>
<span class="normal"> 359</span>
<span class="normal"> 360</span>
<span class="normal"> 361</span>
<span class="normal"> 362</span>
<span class="normal"> 363</span>
<span class="normal"> 364</span>
<span class="normal"> 365</span>
<span class="normal"> 366</span>
<span class="normal"> 367</span>
<span class="normal"> 368</span>
<span class="normal"> 369</span>
<span class="normal"> 370</span>
<span class="normal"> 371</span>
<span class="normal"> 372</span>
<span class="normal"> 373</span>
<span class="normal"> 374</span>
<span class="normal"> 375</span>
<span class="normal"> 376</span>
<span class="normal"> 377</span>
<span class="normal"> 378</span>
<span class="normal"> 379</span>
<span class="normal"> 380</span>
<span class="normal"> 381</span>
<span class="normal"> 382</span>
<span class="normal"> 383</span>
<span class="normal"> 384</span>
<span class="normal"> 385</span>
<span class="normal"> 386</span>
<span class="normal"> 387</span>
<span class="normal"> 388</span>
<span class="normal"> 389</span>
<span class="normal"> 390</span>
<span class="normal"> 391</span>
<span class="normal"> 392</span>
<span class="normal"> 393</span>
<span class="normal"> 394</span>
<span class="normal"> 395</span>
<span class="normal"> 396</span>
<span class="normal"> 397</span>
<span class="normal"> 398</span>
<span class="normal"> 399</span>
<span class="normal"> 400</span>
<span class="normal"> 401</span>
<span class="normal"> 402</span>
<span class="normal"> 403</span>
<span class="normal"> 404</span>
<span class="normal"> 405</span>
<span class="normal"> 406</span>
<span class="normal"> 407</span>
<span class="normal"> 408</span>
<span class="normal"> 409</span>
<span class="normal"> 410</span>
<span class="normal"> 411</span>
<span class="normal"> 412</span>
<span class="normal"> 413</span>
<span class="normal"> 414</span>
<span class="normal"> 415</span>
<span class="normal"> 416</span>
<span class="normal"> 417</span>
<span class="normal"> 418</span>
<span class="normal"> 419</span>
<span class="normal"> 420</span>
<span class="normal"> 421</span>
<span class="normal"> 422</span>
<span class="normal"> 423</span>
<span class="normal"> 424</span>
<span class="normal"> 425</span>
<span class="normal"> 426</span>
<span class="normal"> 427</span>
<span class="normal"> 428</span>
<span class="normal"> 429</span>
<span class="normal"> 430</span>
<span class="normal"> 431</span>
<span class="normal"> 432</span>
<span class="normal"> 433</span>
<span class="normal"> 434</span>
<span class="normal"> 435</span>
<span class="normal"> 436</span>
<span class="normal"> 437</span>
<span class="normal"> 438</span>
<span class="normal"> 439</span>
<span class="normal"> 440</span>
<span class="normal"> 441</span>
<span class="normal"> 442</span>
<span class="normal"> 443</span>
<span class="normal"> 444</span>
<span class="normal"> 445</span>
<span class="normal"> 446</span>
<span class="normal"> 447</span>
<span class="normal"> 448</span>
<span class="normal"> 449</span>
<span class="normal"> 450</span>
<span class="normal"> 451</span>
<span class="normal"> 452</span>
<span class="normal"> 453</span>
<span class="normal"> 454</span>
<span class="normal"> 455</span>
<span class="normal"> 456</span>
<span class="normal"> 457</span>
<span class="normal"> 458</span>
<span class="normal"> 459</span>
<span class="normal"> 460</span>
<span class="normal"> 461</span>
<span class="normal"> 462</span>
<span class="normal"> 463</span>
<span class="normal"> 464</span>
<span class="normal"> 465</span>
<span class="normal"> 466</span>
<span class="normal"> 467</span>
<span class="normal"> 468</span>
<span class="normal"> 469</span>
<span class="normal"> 470</span>
<span class="normal"> 471</span>
<span class="normal"> 472</span>
<span class="normal"> 473</span>
<span class="normal"> 474</span>
<span class="normal"> 475</span>
<span class="normal"> 476</span>
<span class="normal"> 477</span>
<span class="normal"> 478</span>
<span class="normal"> 479</span>
<span class="normal"> 480</span>
<span class="normal"> 481</span>
<span class="normal"> 482</span>
<span class="normal"> 483</span>
<span class="normal"> 484</span>
<span class="normal"> 485</span>
<span class="normal"> 486</span>
<span class="normal"> 487</span>
<span class="normal"> 488</span>
<span class="normal"> 489</span>
<span class="normal"> 490</span>
<span class="normal"> 491</span>
<span class="normal"> 492</span>
<span class="normal"> 493</span>
<span class="normal"> 494</span>
<span class="normal"> 495</span>
<span class="normal"> 496</span>
<span class="normal"> 497</span>
<span class="normal"> 498</span>
<span class="normal"> 499</span>
<span class="normal"> 500</span>
<span class="normal"> 501</span>
<span class="normal"> 502</span>
<span class="normal"> 503</span>
<span class="normal"> 504</span>
<span class="normal"> 505</span>
<span class="normal"> 506</span>
<span class="normal"> 507</span>
<span class="normal"> 508</span>
<span class="normal"> 509</span>
<span class="normal"> 510</span>
<span class="normal"> 511</span>
<span class="normal"> 512</span>
<span class="normal"> 513</span>
<span class="normal"> 514</span>
<span class="normal"> 515</span>
<span class="normal"> 516</span>
<span class="normal"> 517</span>
<span class="normal"> 518</span>
<span class="normal"> 519</span>
<span class="normal"> 520</span>
<span class="normal"> 521</span>
<span class="normal"> 522</span>
<span class="normal"> 523</span>
<span class="normal"> 524</span>
<span class="normal"> 525</span>
<span class="normal"> 526</span>
<span class="normal"> 527</span>
<span class="normal"> 528</span>
<span class="normal"> 529</span>
<span class="normal"> 530</span>
<span class="normal"> 531</span>
<span class="normal"> 532</span>
<span class="normal"> 533</span>
<span class="normal"> 534</span>
<span class="normal"> 535</span>
<span class="normal"> 536</span>
<span class="normal"> 537</span>
<span class="normal"> 538</span>
<span class="normal"> 539</span>
<span class="normal"> 540</span>
<span class="normal"> 541</span>
<span class="normal"> 542</span>
<span class="normal"> 543</span>
<span class="normal"> 544</span>
<span class="normal"> 545</span>
<span class="normal"> 546</span>
<span class="normal"> 547</span>
<span class="normal"> 548</span>
<span class="normal"> 549</span>
<span class="normal"> 550</span>
<span class="normal"> 551</span>
<span class="normal"> 552</span>
<span class="normal"> 553</span>
<span class="normal"> 554</span>
<span class="normal"> 555</span>
<span class="normal"> 556</span>
<span class="normal"> 557</span>
<span class="normal"> 558</span>
<span class="normal"> 559</span>
<span class="normal"> 560</span>
<span class="normal"> 561</span>
<span class="normal"> 562</span>
<span class="normal"> 563</span>
<span class="normal"> 564</span>
<span class="normal"> 565</span>
<span class="normal"> 566</span>
<span class="normal"> 567</span>
<span class="normal"> 568</span>
<span class="normal"> 569</span>
<span class="normal"> 570</span>
<span class="normal"> 571</span>
<span class="normal"> 572</span>
<span class="normal"> 573</span>
<span class="normal"> 574</span>
<span class="normal"> 575</span>
<span class="normal"> 576</span>
<span class="normal"> 577</span>
<span class="normal"> 578</span>
<span class="normal"> 579</span>
<span class="normal"> 580</span>
<span class="normal"> 581</span>
<span class="normal"> 582</span>
<span class="normal"> 583</span>
<span class="normal"> 584</span>
<span class="normal"> 585</span>
<span class="normal"> 586</span>
<span class="normal"> 587</span>
<span class="normal"> 588</span>
<span class="normal"> 589</span>
<span class="normal"> 590</span>
<span class="normal"> 591</span>
<span class="normal"> 592</span>
<span class="normal"> 593</span>
<span class="normal"> 594</span>
<span class="normal"> 595</span>
<span class="normal"> 596</span>
<span class="normal"> 597</span>
<span class="normal"> 598</span>
<span class="normal"> 599</span>
<span class="normal"> 600</span>
<span class="normal"> 601</span>
<span class="normal"> 602</span>
<span class="normal"> 603</span>
<span class="normal"> 604</span>
<span class="normal"> 605</span>
<span class="normal"> 606</span>
<span class="normal"> 607</span>
<span class="normal"> 608</span>
<span class="normal"> 609</span>
<span class="normal"> 610</span>
<span class="normal"> 611</span>
<span class="normal"> 612</span>
<span class="normal"> 613</span>
<span class="normal"> 614</span>
<span class="normal"> 615</span>
<span class="normal"> 616</span>
<span class="normal"> 617</span>
<span class="normal"> 618</span>
<span class="normal"> 619</span>
<span class="normal"> 620</span>
<span class="normal"> 621</span>
<span class="normal"> 622</span>
<span class="normal"> 623</span>
<span class="normal"> 624</span>
<span class="normal"> 625</span>
<span class="normal"> 626</span>
<span class="normal"> 627</span>
<span class="normal"> 628</span>
<span class="normal"> 629</span>
<span class="normal"> 630</span>
<span class="normal"> 631</span>
<span class="normal"> 632</span>
<span class="normal"> 633</span>
<span class="normal"> 634</span>
<span class="normal"> 635</span>
<span class="normal"> 636</span>
<span class="normal"> 637</span>
<span class="normal"> 638</span>
<span class="normal"> 639</span>
<span class="normal"> 640</span>
<span class="normal"> 641</span>
<span class="normal"> 642</span>
<span class="normal"> 643</span>
<span class="normal"> 644</span>
<span class="normal"> 645</span>
<span class="normal"> 646</span>
<span class="normal"> 647</span>
<span class="normal"> 648</span>
<span class="normal"> 649</span>
<span class="normal"> 650</span>
<span class="normal"> 651</span>
<span class="normal"> 652</span>
<span class="normal"> 653</span>
<span class="normal"> 654</span>
<span class="normal"> 655</span>
<span class="normal"> 656</span>
<span class="normal"> 657</span>
<span class="normal"> 658</span>
<span class="normal"> 659</span>
<span class="normal"> 660</span>
<span class="normal"> 661</span>
<span class="normal"> 662</span>
<span class="normal"> 663</span>
<span class="normal"> 664</span>
<span class="normal"> 665</span>
<span class="normal"> 666</span>
<span class="normal"> 667</span>
<span class="normal"> 668</span>
<span class="normal"> 669</span>
<span class="normal"> 670</span>
<span class="normal"> 671</span>
<span class="normal"> 672</span>
<span class="normal"> 673</span>
<span class="normal"> 674</span>
<span class="normal"> 675</span>
<span class="normal"> 676</span>
<span class="normal"> 677</span>
<span class="normal"> 678</span>
<span class="normal"> 679</span>
<span class="normal"> 680</span>
<span class="normal"> 681</span>
<span class="normal"> 682</span>
<span class="normal"> 683</span>
<span class="normal"> 684</span>
<span class="normal"> 685</span>
<span class="normal"> 686</span>
<span class="normal"> 687</span>
<span class="normal"> 688</span>
<span class="normal"> 689</span>
<span class="normal"> 690</span>
<span class="normal"> 691</span>
<span class="normal"> 692</span>
<span class="normal"> 693</span>
<span class="normal"> 694</span>
<span class="normal"> 695</span>
<span class="normal"> 696</span>
<span class="normal"> 697</span>
<span class="normal"> 698</span>
<span class="normal"> 699</span>
<span class="normal"> 700</span>
<span class="normal"> 701</span>
<span class="normal"> 702</span>
<span class="normal"> 703</span>
<span class="normal"> 704</span>
<span class="normal"> 705</span>
<span class="normal"> 706</span>
<span class="normal"> 707</span>
<span class="normal"> 708</span>
<span class="normal"> 709</span>
<span class="normal"> 710</span>
<span class="normal"> 711</span>
<span class="normal"> 712</span>
<span class="normal"> 713</span>
<span class="normal"> 714</span>
<span class="normal"> 715</span>
<span class="normal"> 716</span>
<span class="normal"> 717</span>
<span class="normal"> 718</span>
<span class="normal"> 719</span>
<span class="normal"> 720</span>
<span class="normal"> 721</span>
<span class="normal"> 722</span>
<span class="normal"> 723</span>
<span class="normal"> 724</span>
<span class="normal"> 725</span>
<span class="normal"> 726</span>
<span class="normal"> 727</span>
<span class="normal"> 728</span>
<span class="normal"> 729</span>
<span class="normal"> 730</span>
<span class="normal"> 731</span>
<span class="normal"> 732</span>
<span class="normal"> 733</span>
<span class="normal"> 734</span>
<span class="normal"> 735</span>
<span class="normal"> 736</span>
<span class="normal"> 737</span>
<span class="normal"> 738</span>
<span class="normal"> 739</span>
<span class="normal"> 740</span>
<span class="normal"> 741</span>
<span class="normal"> 742</span>
<span class="normal"> 743</span>
<span class="normal"> 744</span>
<span class="normal"> 745</span>
<span class="normal"> 746</span>
<span class="normal"> 747</span>
<span class="normal"> 748</span>
<span class="normal"> 749</span>
<span class="normal"> 750</span>
<span class="normal"> 751</span>
<span class="normal"> 752</span>
<span class="normal"> 753</span>
<span class="normal"> 754</span>
<span class="normal"> 755</span>
<span class="normal"> 756</span>
<span class="normal"> 757</span>
<span class="normal"> 758</span>
<span class="normal"> 759</span>
<span class="normal"> 760</span>
<span class="normal"> 761</span>
<span class="normal"> 762</span>
<span class="normal"> 763</span>
<span class="normal"> 764</span>
<span class="normal"> 765</span>
<span class="normal"> 766</span>
<span class="normal"> 767</span>
<span class="normal"> 768</span>
<span class="normal"> 769</span>
<span class="normal"> 770</span>
<span class="normal"> 771</span>
<span class="normal"> 772</span>
<span class="normal"> 773</span>
<span class="normal"> 774</span>
<span class="normal"> 775</span>
<span class="normal"> 776</span>
<span class="normal"> 777</span>
<span class="normal"> 778</span>
<span class="normal"> 779</span>
<span class="normal"> 780</span>
<span class="normal"> 781</span>
<span class="normal"> 782</span>
<span class="normal"> 783</span>
<span class="normal"> 784</span>
<span class="normal"> 785</span>
<span class="normal"> 786</span>
<span class="normal"> 787</span>
<span class="normal"> 788</span>
<span class="normal"> 789</span>
<span class="normal"> 790</span>
<span class="normal"> 791</span>
<span class="normal"> 792</span>
<span class="normal"> 793</span>
<span class="normal"> 794</span>
<span class="normal"> 795</span>
<span class="normal"> 796</span>
<span class="normal"> 797</span>
<span class="normal"> 798</span>
<span class="normal"> 799</span>
<span class="normal"> 800</span>
<span class="normal"> 801</span>
<span class="normal"> 802</span>
<span class="normal"> 803</span>
<span class="normal"> 804</span>
<span class="normal"> 805</span>
<span class="normal"> 806</span>
<span class="normal"> 807</span>
<span class="normal"> 808</span>
<span class="normal"> 809</span>
<span class="normal"> 810</span>
<span class="normal"> 811</span>
<span class="normal"> 812</span>
<span class="normal"> 813</span>
<span class="normal"> 814</span>
<span class="normal"> 815</span>
<span class="normal"> 816</span>
<span class="normal"> 817</span>
<span class="normal"> 818</span>
<span class="normal"> 819</span>
<span class="normal"> 820</span>
<span class="normal"> 821</span>
<span class="normal"> 822</span>
<span class="normal"> 823</span>
<span class="normal"> 824</span>
<span class="normal"> 825</span>
<span class="normal"> 826</span>
<span class="normal"> 827</span>
<span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span>
<span class="normal">1726</span>
<span class="normal">1727</span>
<span class="normal">1728</span>
<span class="normal">1729</span>
<span class="normal">1730</span>
<span class="normal">1731</span>
<span class="normal">1732</span>
<span class="normal">1733</span>
<span class="normal">1734</span>
<span class="normal">1735</span>
<span class="normal">1736</span>
<span class="normal">1737</span>
<span class="normal">1738</span>
<span class="normal">1739</span>
<span class="normal">1740</span>
<span class="normal">1741</span>
<span class="normal">1742</span>
<span class="normal">1743</span>
<span class="normal">1744</span>
<span class="normal">1745</span>
<span class="normal">1746</span>
<span class="normal">1747</span>
<span class="normal">1748</span>
<span class="normal">1749</span>
<span class="normal">1750</span>
<span class="normal">1751</span>
<span class="normal">1752</span>
<span class="normal">1753</span>
<span class="normal">1754</span>
<span class="normal">1755</span>
<span class="normal">1756</span>
<span class="normal">1757</span>
<span class="normal">1758</span>
<span class="normal">1759</span>
<span class="normal">1760</span>
<span class="normal">1761</span>
<span class="normal">1762</span>
<span class="normal">1763</span>
<span class="normal">1764</span>
<span class="normal">1765</span>
<span class="normal">1766</span>
<span class="normal">1767</span>
<span class="normal">1768</span>
<span class="normal">1769</span>
<span class="normal">1770</span>
<span class="normal">1771</span>
<span class="normal">1772</span>
<span class="normal">1773</span>
<span class="normal">1774</span>
<span class="normal">1775</span>
<span class="normal">1776</span>
<span class="normal">1777</span>
<span class="normal">1778</span>
<span class="normal">1779</span>
<span class="normal">1780</span>
<span class="normal">1781</span>
<span class="normal">1782</span>
<span class="normal">1783</span>
<span class="normal">1784</span>
<span class="normal">1785</span>
<span class="normal">1786</span>
<span class="normal">1787</span>
<span class="normal">1788</span>
<span class="normal">1789</span>
<span class="normal">1790</span>
<span class="normal">1791</span>
<span class="normal">1792</span>
<span class="normal">1793</span>
<span class="normal">1794</span>
<span class="normal">1795</span>
<span class="normal">1796</span>
<span class="normal">1797</span>
<span class="normal">1798</span>
<span class="normal">1799</span>
<span class="normal">1800</span>
<span class="normal">1801</span>
<span class="normal">1802</span>
<span class="normal">1803</span>
<span class="normal">1804</span>
<span class="normal">1805</span>
<span class="normal">1806</span>
<span class="normal">1807</span>
<span class="normal">1808</span>
<span class="normal">1809</span>
<span class="normal">1810</span>
<span class="normal">1811</span>
<span class="normal">1812</span>
<span class="normal">1813</span>
<span class="normal">1814</span>
<span class="normal">1815</span>
<span class="normal">1816</span>
<span class="normal">1817</span>
<span class="normal">1818</span>
<span class="normal">1819</span>
<span class="normal">1820</span>
<span class="normal">1821</span>
<span class="normal">1822</span>
<span class="normal">1823</span>
<span class="normal">1824</span>
<span class="normal">1825</span>
<span class="normal">1826</span>
<span class="normal">1827</span>
<span class="normal">1828</span>
<span class="normal">1829</span>
<span class="normal">1830</span>
<span class="normal">1831</span>
<span class="normal">1832</span>
<span class="normal">1833</span>
<span class="normal">1834</span>
<span class="normal">1835</span>
<span class="normal">1836</span>
<span class="normal">1837</span>
<span class="normal">1838</span>
<span class="normal">1839</span>
<span class="normal">1840</span>
<span class="normal">1841</span>
<span class="normal">1842</span>
<span class="normal">1843</span>
<span class="normal">1844</span>
<span class="normal">1845</span>
<span class="normal">1846</span>
<span class="normal">1847</span>
<span class="normal">1848</span>
<span class="normal">1849</span>
<span class="normal">1850</span>
<span class="normal">1851</span>
<span class="normal">1852</span>
<span class="normal">1853</span>
<span class="normal">1854</span>
<span class="normal">1855</span>
<span class="normal">1856</span>
<span class="normal">1857</span>
<span class="normal">1858</span>
<span class="normal">1859</span>
<span class="normal">1860</span>
<span class="normal">1861</span>
<span class="normal">1862</span>
<span class="normal">1863</span>
<span class="normal">1864</span>
<span class="normal">1865</span>
<span class="normal">1866</span>
<span class="normal">1867</span>
<span class="normal">1868</span>
<span class="normal">1869</span>
<span class="normal">1870</span>
<span class="normal">1871</span>
<span class="normal">1872</span>
<span class="normal">1873</span>
<span class="normal">1874</span>
<span class="normal">1875</span>
<span class="normal">1876</span>
<span class="normal">1877</span>
<span class="normal">1878</span>
<span class="normal">1879</span>
<span class="normal">1880</span>
<span class="normal">1881</span>
<span class="normal">1882</span>
<span class="normal">1883</span>
<span class="normal">1884</span>
<span class="normal">1885</span>
<span class="normal">1886</span>
<span class="normal">1887</span>
<span class="normal">1888</span>
<span class="normal">1889</span>
<span class="normal">1890</span>
<span class="normal">1891</span>
<span class="normal">1892</span>
<span class="normal">1893</span>
<span class="normal">1894</span>
<span class="normal">1895</span>
<span class="normal">1896</span>
<span class="normal">1897</span>
<span class="normal">1898</span>
<span class="normal">1899</span>
<span class="normal">1900</span>
<span class="normal">1901</span>
<span class="normal">1902</span>
<span class="normal">1903</span>
<span class="normal">1904</span>
<span class="normal">1905</span>
<span class="normal">1906</span>
<span class="normal">1907</span>
<span class="normal">1908</span>
<span class="normal">1909</span>
<span class="normal">1910</span>
<span class="normal">1911</span>
<span class="normal">1912</span>
<span class="normal">1913</span>
<span class="normal">1914</span>
<span class="normal">1915</span>
<span class="normal">1916</span>
<span class="normal">1917</span>
<span class="normal">1918</span>
<span class="normal">1919</span>
<span class="normal">1920</span>
<span class="normal">1921</span>
<span class="normal">1922</span>
<span class="normal">1923</span>
<span class="normal">1924</span>
<span class="normal">1925</span>
<span class="normal">1926</span>
<span class="normal">1927</span>
<span class="normal">1928</span>
<span class="normal">1929</span>
<span class="normal">1930</span>
<span class="normal">1931</span>
<span class="normal">1932</span>
<span class="normal">1933</span>
<span class="normal">1934</span>
<span class="normal">1935</span>
<span class="normal">1936</span>
<span class="normal">1937</span>
<span class="normal">1938</span>
<span class="normal">1939</span>
<span class="normal">1940</span>
<span class="normal">1941</span>
<span class="normal">1942</span>
<span class="normal">1943</span>
<span class="normal">1944</span>
<span class="normal">1945</span>
<span class="normal">1946</span>
<span class="normal">1947</span>
<span class="normal">1948</span>
<span class="normal">1949</span>
<span class="normal">1950</span>
<span class="normal">1951</span>
<span class="normal">1952</span>
<span class="normal">1953</span>
<span class="normal">1954</span>
<span class="normal">1955</span>
<span class="normal">1956</span>
<span class="normal">1957</span>
<span class="normal">1958</span>
<span class="normal">1959</span>
<span class="normal">1960</span>
<span class="normal">1961</span>
<span class="normal">1962</span>
<span class="normal">1963</span>
<span class="normal">1964</span>
<span class="normal">1965</span>
<span class="normal">1966</span>
<span class="normal">1967</span>
<span class="normal">1968</span>
<span class="normal">1969</span>
<span class="normal">1970</span>
<span class="normal">1971</span>
<span class="normal">1972</span>
<span class="normal">1973</span>
<span class="normal">1974</span>
<span class="normal">1975</span>
<span class="normal">1976</span>
<span class="normal">1977</span>
<span class="normal">1978</span>
<span class="normal">1979</span>
<span class="normal">1980</span>
<span class="normal">1981</span>
<span class="normal">1982</span>
<span class="normal">1983</span>
<span class="normal">1984</span>
<span class="normal">1985</span>
<span class="normal">1986</span>
<span class="normal">1987</span>
<span class="normal">1988</span>
<span class="normal">1989</span>
<span class="normal">1990</span>
<span class="normal">1991</span>
<span class="normal">1992</span>
<span class="normal">1993</span>
<span class="normal">1994</span>
<span class="normal">1995</span>
<span class="normal">1996</span>
<span class="normal">1997</span>
<span class="normal">1998</span>
<span class="normal">1999</span>
<span class="normal">2000</span>
<span class="normal">2001</span>
<span class="normal">2002</span>
<span class="normal">2003</span>
<span class="normal">2004</span>
<span class="normal">2005</span>
<span class="normal">2006</span>
<span class="normal">2007</span>
<span class="normal">2008</span>
<span class="normal">2009</span>
<span class="normal">2010</span>
<span class="normal">2011</span>
<span class="normal">2012</span>
<span class="normal">2013</span>
<span class="normal">2014</span>
<span class="normal">2015</span>
<span class="normal">2016</span>
<span class="normal">2017</span>
<span class="normal">2018</span>
<span class="normal">2019</span>
<span class="normal">2020</span>
<span class="normal">2021</span>
<span class="normal">2022</span>
<span class="normal">2023</span>
<span class="normal">2024</span>
<span class="normal">2025</span>
<span class="normal">2026</span>
<span class="normal">2027</span>
<span class="normal">2028</span>
<span class="normal">2029</span>
<span class="normal">2030</span>
<span class="normal">2031</span>
<span class="normal">2032</span>
<span class="normal">2033</span>
<span class="normal">2034</span>
<span class="normal">2035</span>
<span class="normal">2036</span>
<span class="normal">2037</span>
<span class="normal">2038</span>
<span class="normal">2039</span>
<span class="normal">2040</span>
<span class="normal">2041</span>
<span class="normal">2042</span>
<span class="normal">2043</span>
<span class="normal">2044</span>
<span class="normal">2045</span>
<span class="normal">2046</span>
<span class="normal">2047</span>
<span class="normal">2048</span>
<span class="normal">2049</span>
<span class="normal">2050</span>
<span class="normal">2051</span>
<span class="normal">2052</span>
<span class="normal">2053</span>
<span class="normal">2054</span>
<span class="normal">2055</span>
<span class="normal">2056</span>
<span class="normal">2057</span>
<span class="normal">2058</span>
<span class="normal">2059</span>
<span class="normal">2060</span>
<span class="normal">2061</span>
<span class="normal">2062</span>
<span class="normal">2063</span>
<span class="normal">2064</span>
<span class="normal">2065</span>
<span class="normal">2066</span>
<span class="normal">2067</span>
<span class="normal">2068</span>
<span class="normal">2069</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Viewer</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""PyGFX 3D viewer.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    offscreen : bool</span>
<span class="sd">                If True, will use an offscreen Canvas. Useful if you only</span>
<span class="sd">                want a screenshot.</span>
<span class="sd">    title :     str</span>
<span class="sd">                Title of the viewer window.</span>
<span class="sd">    max_fps :   int</span>
<span class="sd">                Maximum frames per second to render.</span>
<span class="sd">    size :      tuple, optional</span>
<span class="sd">                Size of the viewer window.</span>
<span class="sd">    camera :    "ortho" | "perspective"</span>
<span class="sd">                Type of camera to use. Defaults to "ortho". Note you can always</span>
<span class="sd">                change the camera type by adjust the `Viewer.camera.fov` attribute</span>
<span class="sd">                (0 = ortho, &gt;0 = perspective).</span>
<span class="sd">    control :   "trackball" | "panzoom" | "fly" | "orbit"</span>
<span class="sd">                Controller type to use. Defaults to "trackball".</span>
<span class="sd">    show :      "auto" (default) | bool</span>
<span class="sd">                Whether to immediately show the viewer. When set to "auto" (default),</span>
<span class="sd">                will immmediately show the viewer if:</span>
<span class="sd">                 - we are in a Jupyter environment</span>
<span class="sd">                 - we are in an iPython session and we can hook into an iPython event loop</span>
<span class="sd">                If neither of the above applies or `show=False`, you will have to manually run</span>
<span class="sd">                `Viewer.show()`. This gives you the chance to add objects to the viewer</span>
<span class="sd">                before it is shown and the blocking event loop is started.</span>
<span class="sd">                The `show` parameter is ignored if `offscreen` is True.</span>
<span class="sd">    **kwargs</span>
<span class="sd">                Keyword arguments are passed through to ``WgpuCanvas``.</span>

<span class="sd">    """</span>

    <span class="c1"># Palette used for assigning colors to objects</span>
    <span class="n">palette</span> <span class="o">=</span> <span class="s2">"seaborn:tab10"</span>
    <span class="n">highlight_color</span> <span class="o">=</span> <span class="s2">"yellow"</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">offscreen</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">"Octarine Viewer"</span><span class="p">,</span>
        <span class="n">max_fps</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
        <span class="n">camera</span><span class="o">=</span><span class="s2">"ortho"</span><span class="p">,</span>
        <span class="n">control</span><span class="o">=</span><span class="s2">"trackball"</span><span class="p">,</span>
        <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="c1"># We need to import WgpuCanvas before we (potentially) start the event loop</span>
        <span class="c1"># If we don't we get a segfault.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">offscreen</span><span class="p">:</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">rendercanvas.auto</span><span class="w"> </span><span class="kn">import</span> <span class="n">RenderCanvas</span>

        <span class="c1"># Check if we're running in an IPython environment</span>
        <span class="k">if</span> <span class="n">utils</span><span class="o">.</span><span class="n">_type_of_script</span><span class="p">()</span> <span class="o">==</span> <span class="s2">"ipython"</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">offscreen</span><span class="p">:</span>
            <span class="n">ip</span> <span class="o">=</span> <span class="n">get_ipython</span><span class="p">()</span>  <span class="c1"># noqa: F821</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">ip</span><span class="o">.</span><span class="n">active_eventloop</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">AUTOSTART_EVENT_LOOP</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">ip</span><span class="o">.</span><span class="n">enable_gui</span><span class="p">(</span><span class="s2">"qt6"</span><span class="p">)</span>
                        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                            <span class="s2">"Looks like you're running in an IPython environment but haven't "</span>
                            <span class="s2">"started a GUI event loop. We've started one for you using the "</span>
                            <span class="s2">"Qt6 backend."</span>
                        <span class="p">)</span>
                    <span class="k">except</span> <span class="p">(</span><span class="ne">ModuleNotFoundError</span><span class="p">,</span> <span class="ne">ImportError</span><span class="p">):</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                            <span class="s2">"Looks like you're running in an IPython environment but haven't "</span>
                            <span class="s2">"started a GUI event loop. We tried to start one for you using the "</span>
                            <span class="s2">"Qt6 backend (via </span><span class="si">%g</span><span class="s2">ui qt6) but that failed. You may have to start "</span>
                            <span class="s2">"the event loop manually. See "</span>
                            <span class="s2">"https://ipython.readthedocs.io/en/stable/config/eventloops.html"</span>
                            <span class="s2">"for details."</span>
                        <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="s1">'IPython event loop not running. Please use e.g. "</span><span class="si">%g</span><span class="s1">ui qt6" to hook into the event loop.'</span>
                    <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_title</span> <span class="o">=</span> <span class="n">title</span>

        <span class="c1"># Update some defaults as necessary</span>
        <span class="n">defaults</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"title"</span><span class="p">:</span> <span class="n">title</span><span class="p">,</span> <span class="s2">"max_fps"</span><span class="p">:</span> <span class="n">max_fps</span><span class="p">}</span>
        <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">defaults</span><span class="p">[</span><span class="s2">"size"</span><span class="p">]</span> <span class="o">=</span> <span class="n">size</span>
        <span class="n">defaults</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># If we're running in headless mode (primarily for tests on CI) we will</span>
        <span class="c1"># simply not initialize the gfx objects. Not ideal but it turns</span>
        <span class="c1"># out to be very annoying to correctly setup on Github Actions.</span>
        <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="s2">"HEADLESS"</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">offscreen</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="n">RenderCanvas</span><span class="p">(</span><span class="o">**</span><span class="n">defaults</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="n">OffscreenRenderCanvas</span><span class="p">(</span><span class="o">**</span><span class="n">defaults</span><span class="p">)</span>

        <span class="c1"># There is a bug in pygfx 0.1.18 that causes the renderer to crash</span>
        <span class="c1"># when using a Jupyter canvas without explicitly setting the pixel_ratio.</span>
        <span class="c1"># This is already fixed in main but for now:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_jupyter</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">renderer</span> <span class="o">=</span> <span class="n">gfx</span><span class="o">.</span><span class="n">renderers</span><span class="o">.</span><span class="n">WgpuRenderer</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">,</span> <span class="n">show_fps</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">pixel_ratio</span><span class="o">=</span><span class="mi">2</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">renderer</span> <span class="o">=</span> <span class="n">gfx</span><span class="o">.</span><span class="n">renderers</span><span class="o">.</span><span class="n">WgpuRenderer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">,</span> <span class="n">show_fps</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># Set up a default scene</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scene</span> <span class="o">=</span> <span class="n">gfx</span><span class="o">.</span><span class="n">Scene</span><span class="p">()</span>

        <span class="c1"># A minor ambient light</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">gfx</span><span class="o">.</span><span class="n">AmbientLight</span><span class="p">(</span><span class="n">intensity</span><span class="o">=</span><span class="mf">0.5</span><span class="p">))</span>

        <span class="c1"># A strong point light form front/top/left</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">gfx</span><span class="o">.</span><span class="n">PointLight</span><span class="p">(</span><span class="n">intensity</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shadow</span><span class="o">.</span><span class="n">bias</span> <span class="o">=</span> <span class="mf">0.0000005</span>  <span class="c1"># this helps with shadow acne</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">local</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1000000</span>  <span class="c1"># move to the left</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">local</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1000000</span>  <span class="c1"># move up</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">local</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1000000</span>  <span class="c1"># move light forward</span>

        <span class="c1"># A weaker point light from the back</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">gfx</span><span class="o">.</span><span class="n">PointLight</span><span class="p">(</span><span class="n">intensity</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shadow</span><span class="o">.</span><span class="n">bias</span> <span class="o">=</span> <span class="mf">0.0000005</span>  <span class="c1"># this helps with shadow acne</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">local</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">1000000</span>  <span class="c1"># move to the left</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">local</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="mi">1000000</span>  <span class="c1"># move up</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">local</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="mi">1000000</span>  <span class="c1"># move light forward</span>

        <span class="c1"># Set up a default background</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_background</span> <span class="o">=</span> <span class="n">gfx</span><span class="o">.</span><span class="n">Background</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">gfx</span><span class="o">.</span><span class="n">BackgroundMaterial</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_background</span><span class="p">)</span>

        <span class="c1"># Add camera</span>
        <span class="k">if</span> <span class="n">camera</span> <span class="o">==</span> <span class="s2">"ortho"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">camera</span> <span class="o">=</span> <span class="n">gfx</span><span class="o">.</span><span class="n">OrthographicCamera</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">camera</span> <span class="o">==</span> <span class="s2">"perspective"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">camera</span> <span class="o">=</span> <span class="n">gfx</span><span class="o">.</span><span class="n">PerspectiveCamera</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Unknown camera type: </span><span class="si">{</span><span class="n">camera</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

        <span class="c1"># Add controller</span>
        <span class="n">controller</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">"trackball"</span><span class="p">:</span> <span class="n">gfx</span><span class="o">.</span><span class="n">TrackballController</span><span class="p">,</span>
            <span class="s2">"panzoom"</span><span class="p">:</span> <span class="n">gfx</span><span class="o">.</span><span class="n">PanZoomController</span><span class="p">,</span>
            <span class="s2">"fly"</span><span class="p">:</span> <span class="n">gfx</span><span class="o">.</span><span class="n">FlyController</span><span class="p">,</span>
            <span class="s2">"orbit"</span><span class="p">:</span> <span class="n">gfx</span><span class="o">.</span><span class="n">OrbitController</span><span class="p">,</span>
        <span class="p">}</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">control</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">controller</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Unknown controller type: </span><span class="si">{</span><span class="n">control</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">controller</span> <span class="o">=</span> <span class="n">controller</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="p">,</span> <span class="n">register_events</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">renderer</span><span class="p">)</span>

        <span class="c1"># Setup overlay</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">overlay_camera</span> <span class="o">=</span> <span class="n">gfx</span><span class="o">.</span><span class="n">NDCCamera</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">overlay_scene</span> <span class="o">=</span> <span class="n">gfx</span><span class="o">.</span><span class="n">Scene</span><span class="p">()</span>

        <span class="c1"># Setup transform gizmo</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transform_gizmo</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Stats</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stats</span> <span class="o">=</span> <span class="n">gfx</span><span class="o">.</span><span class="n">Stats</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">renderer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_show_fps</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># Setup key events</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_key_events</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_key_events</span><span class="p">[</span><span class="s2">"1"</span><span class="p">]</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_view</span><span class="p">(</span><span class="s2">"XY"</span><span class="p">)</span>  <span class="c1"># frontal view</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_key_events</span><span class="p">[</span><span class="s2">"2"</span><span class="p">]</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_view</span><span class="p">(</span><span class="s2">"XZ"</span><span class="p">)</span>  <span class="c1"># lateral view</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_key_events</span><span class="p">[</span><span class="s2">"3"</span><span class="p">]</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_view</span><span class="p">(</span><span class="s2">"YZ"</span><span class="p">)</span>  <span class="c1"># top view</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_key_events</span><span class="p">[(</span><span class="s2">"1"</span><span class="p">,</span> <span class="p">(</span><span class="s2">"Shift"</span><span class="p">,))]</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_view</span><span class="p">(</span><span class="s2">"-XY"</span><span class="p">)</span>  <span class="c1"># back view</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_key_events</span><span class="p">[(</span><span class="s2">"2"</span><span class="p">,</span> <span class="p">(</span><span class="s2">"Shift"</span><span class="p">,))]</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_view</span><span class="p">(</span>
            <span class="s2">"-XZ"</span>
        <span class="p">)</span>  <span class="c1"># other lateral view</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_key_events</span><span class="p">[(</span><span class="s2">"3"</span><span class="p">,</span> <span class="p">(</span><span class="s2">"Shift"</span><span class="p">,))]</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_view</span><span class="p">(</span>
            <span class="s2">"-YZ"</span>
        <span class="p">)</span>  <span class="c1"># bottom view</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_key_events</span><span class="p">[</span><span class="s2">"f"</span><span class="p">]</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_toggle_fps</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_key_events</span><span class="p">[</span><span class="s2">"c"</span><span class="p">]</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_toggle_controls</span><span class="p">()</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">_keydown</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
<span class="w">            </span><span class="sd">"""Handle key presses."""</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">event</span><span class="o">.</span><span class="n">modifiers</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_key_events</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_key_events</span><span class="p">[</span><span class="n">event</span><span class="o">.</span><span class="n">key</span><span class="p">]()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">tup</span> <span class="o">=</span> <span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">modifiers</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">tup</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_key_events</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_key_events</span><span class="p">[</span><span class="n">tup</span><span class="p">]()</span>

        <span class="c1"># Register events</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">renderer</span><span class="o">.</span><span class="n">add_event_handler</span><span class="p">(</span><span class="n">_keydown</span><span class="p">,</span> <span class="s2">"key_down"</span><span class="p">)</span>

        <span class="c1"># Finally, setting some variables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_show_bounds</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shadows</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_animations</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_animations_flagged_for_removal</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_animations_frame_counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_on_double_click</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_on_hover</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_objects_pickable</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_selected</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_render_trigger</span> <span class="o">=</span> <span class="s2">"continuous"</span>

        <span class="n">viewers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="c1"># This starts the animation loop</span>
        <span class="k">if</span> <span class="n">show</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_jupyter</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">start_loop</span><span class="o">=</span><span class="n">show</span> <span class="o">==</span> <span class="s2">"start_loop"</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_animate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Run the rendering loop."""</span>
        <span class="n">rm</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">render_trigger</span>

        <span class="c1"># First run the user animations</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_animations_frame_counter</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_animations_frame_counter</span> <span class="o">==</span> <span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span><span class="p">:</span>  <span class="c1"># reset to avoid overflow</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_animations_frame_counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># N.B. we're iterating over the list because the user might add / remove</span>
        <span class="c1"># animations during the loop</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="p">(</span><span class="n">on_error</span><span class="p">,</span> <span class="n">run_every</span><span class="p">,</span> <span class="n">req_render</span><span class="p">))</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
            <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_animations</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
        <span class="p">):</span>
            <span class="c1"># Skip if we're not supposed to run this frame</span>
            <span class="k">if</span> <span class="n">run_every</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_animations_frame_counter</span> <span class="o">%</span> <span class="n">run_every</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">func</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">req_render</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_render_stale</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">except</span> <span class="ne">BaseException</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">on_error</span> <span class="o">==</span> <span class="s2">"raise"</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">e</span>
                <span class="k">elif</span> <span class="n">on_error</span> <span class="o">==</span> <span class="s2">"remove"</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">"Removing animation function '</span><span class="si">{</span><span class="n">func</span><span class="si">}</span><span class="s2">' because of error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">"</span>
                    <span class="p">)</span>
                    <span class="c1"># Flag animation for removal</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_animations_flagged_for_removal</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

        <span class="c1"># Check if any animations need to be removed</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_animations_flagged_for_removal</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_animations</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_animations_flagged_for_removal</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Now check if we need to render the scene</span>
        <span class="k">if</span> <span class="n">rm</span> <span class="o">==</span> <span class="s2">"active_window"</span><span class="p">:</span>
            <span class="c1"># Note to self: we need to explore how to do this with different backends / Window managers</span>
            <span class="c1"># Not sure if this will work with e.g. Jupyter (does it know when the notebook is active?)</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">,</span> <span class="s2">"isActiveWindow"</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">isActiveWindow</span><span class="p">():</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">request_draw</span><span class="p">()</span>
                    <span class="k">return</span>
        <span class="k">elif</span> <span class="n">rm</span> <span class="o">==</span> <span class="s2">"reactive"</span><span class="p">:</span>
            <span class="c1"># If the scene is not stale, we can skip rendering</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">"_render_stale"</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">request_draw</span><span class="p">()</span>
                <span class="k">return</span>

        <span class="c1"># Now render the scene</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_show_fps</span><span class="p">:</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">renderer</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform_gizmo</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">renderer</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transform_gizmo</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">renderer</span><span class="o">.</span><span class="n">render</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">overlay_scene</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">overlay_camera</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">False</span>
                <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">render</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">renderer</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform_gizmo</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">renderer</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transform_gizmo</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">renderer</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">overlay_scene</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">overlay_camera</span><span class="p">)</span>

        <span class="c1"># Set stale to False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_render_stale</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">request_draw</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_next_color</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Return next color in the colormap."""</span>
        <span class="c1"># Cache the full palette. N.B. that ordering of colors in cmap depends on</span>
        <span class="c1"># the number of colors requested - i.e. we can't just grab the last color.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">"_cached_palette"</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">palette</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_palette</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_cached_colors</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">cmap</span><span class="o">.</span><span class="n">Colormap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">palette</span><span class="p">)</span><span class="o">.</span><span class="n">iter_colors</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_cached_palette</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">palette</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">"_palette_index"</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_palette_index</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_palette_index</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_colors</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_palette_index</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_cached_colors</span><span class="p">)]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_next_label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s2">"Object"</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Return next label."""</span>
        <span class="n">existing</span> <span class="o">=</span> <span class="p">[</span><span class="n">o</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span> <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">o</span><span class="p">)</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">prefix</span><span class="p">)]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">existing</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">prefix</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s2">.</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">existing</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">:</span><span class="s2">03</span><span class="si">}</span><span class="s2">"</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Get item."""</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Check if object is on canvas."""</span>
        <span class="k">return</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Return number of objects on canvas."""</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_object_ids</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">blend_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Deprecated! Render blend mode.</span>

<span class="sd">        This property has been deprecated. Please use `Viewer.set_alpha_mode()` instead.</span>

<span class="sd">        """</span>
        <span class="k">raise</span> <span class="ne">DeprecationWarning</span><span class="p">(</span>
            <span class="s2">"The 'blend_mode' property is deprecated. Please use 'Viewer.set_alpha_mode()' instead."</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">render_trigger</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Determines when the scene is (re)rendered.</span>

<span class="sd">        By default, we leave it to the renderer to decide when to render the scene.</span>
<span class="sd">        You can adjust that behaviour by setting render mode to:</span>
<span class="sd">         - "continuous" (default): leave it to the renderer to decide when to render the scene</span>
<span class="sd">         - "reactive": rendering is only triggered when the scene changes</span>
<span class="sd">         - "active_window": rendering is only done when the window is active; this currently</span>
<span class="sd">           only works with the PySide backend</span>

<span class="sd">        """</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_render_trigger</span>

    <span class="nd">@render_trigger</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">render_trigger</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="p">):</span>
        <span class="n">valid</span> <span class="o">=</span> <span class="p">(</span><span class="s2">"continuous"</span><span class="p">,</span> <span class="s2">"active_window"</span><span class="p">,</span> <span class="s2">"reactive"</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">valid</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Unknown render mode: </span><span class="si">{</span><span class="n">mode</span><span class="si">}</span><span class="s2">. Must be one of </span><span class="si">{</span><span class="n">valid</span><span class="si">}</span><span class="s2">."</span><span class="p">)</span>

        <span class="c1"># No need to do anything if the value is the same</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">"_render_trigger"</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
            <span class="k">return</span>

        <span class="c1"># Add/remove event handlers as necessary</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">"reactive"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_set_stale_func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">event</span><span class="p">:</span> <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">"_render_stale"</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">renderer</span><span class="o">.</span><span class="n">add_event_handler</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_set_stale_func</span><span class="p">,</span>
                <span class="s2">"pointer_down"</span><span class="p">,</span>
                <span class="s2">"pointer_move"</span><span class="p">,</span>
                <span class="s2">"pointer_up"</span><span class="p">,</span>
                <span class="s2">"wheel"</span><span class="p">,</span>
                <span class="c1"># "before_render",</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_render_trigger</span> <span class="o">==</span> <span class="s2">"reactive"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">renderer</span><span class="o">.</span><span class="n">remove_event_handler</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_set_stale_func</span><span class="p">,</span>
                <span class="s2">"pointer_down"</span><span class="p">,</span>
                <span class="s2">"pointer_move"</span><span class="p">,</span>
                <span class="s2">"pointer_up"</span><span class="p">,</span>
                <span class="s2">"wheel"</span><span class="p">,</span>
                <span class="c1"># "before_render",</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_render_trigger</span> <span class="o">=</span> <span class="n">mode</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">controls</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Return the controls widget."""</span>
        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">"_controls"</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">visible</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""List IDs of currently visible objects."""</span>
        <span class="n">objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span>  <span class="c1"># grab this only once to speed things up</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">objects</span> <span class="k">if</span> <span class="n">objects</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">visible</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">invisible</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""List IDs of currently visible objects."""</span>
        <span class="n">objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span>  <span class="c1"># grab this only once to speed things up</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">objects</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">objects</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">visible</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">pinned</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""List IDs of currently pinned objects."""</span>
        <span class="n">objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span>  <span class="c1"># grab this only once to speed things up</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">objects</span> <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">objects</span><span class="p">[</span><span class="n">s</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="s2">"_pinned"</span><span class="p">,</span> <span class="kc">False</span><span class="p">)]</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">selected</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Return IDs of or set selected objects."""</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selected</span>

    <span class="nd">@selected</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">selected</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="p">):</span>
        <span class="n">val</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">make_iterable</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[]</span>

        <span class="n">objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span>  <span class="c1"># grab once to speed things up</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">)</span><span class="si">}</span><span class="s2"> objects selected (</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selected</span><span class="p">)</span><span class="si">}</span><span class="s2"> previously)"</span><span class="p">)</span>
        <span class="c1"># First un-highlight neurons which aren't selected anymore</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selected</span> <span class="k">if</span> <span class="n">s</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">val</span><span class="p">]:</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">objects</span><span class="p">[</span><span class="n">s</span><span class="p">]:</span>
                <span class="n">v</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">_stored_color</span>

        <span class="c1"># Highlight new additions</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">val</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">s</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selected</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">objects</span><span class="p">[</span><span class="n">s</span><span class="p">]:</span>
                    <span class="c1"># Keep track of old colour</span>
                    <span class="n">v</span><span class="o">.</span><span class="n">_stored_color</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">color</span>
                    <span class="n">v</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">gfx</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">highlight_color</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_selected</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>

        <span class="c1"># Update legend and set render stale (if applicable)</span>
        <span class="n">update_helper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Return size of the canvas."""</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">get_logical_size</span><span class="p">()</span>

    <span class="nd">@size</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Set size of the canvas."""</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">size</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">set_logical_size</span><span class="p">(</span><span class="o">*</span><span class="n">size</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">shadows</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Return shadow state."""</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shadows</span>

    <span class="nd">@shadows</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">shadows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Set shadow state."""</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Expected bool, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">set_shadow</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">"cast_shadow"</span><span class="p">):</span>
                <span class="n">obj</span><span class="o">.</span><span class="n">cast_shadow</span> <span class="o">=</span> <span class="n">state</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">"receive_shadow"</span><span class="p">):</span>
                <span class="n">obj</span><span class="o">.</span><span class="n">receive_shadow</span> <span class="o">=</span> <span class="n">state</span>

        <span class="k">if</span> <span class="n">v</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shadows</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_shadows</span> <span class="o">=</span> <span class="n">v</span>
            <span class="k">for</span> <span class="n">vis</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">visuals</span><span class="p">:</span>
                <span class="n">set_shadow</span><span class="p">(</span><span class="n">vis</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">children</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ch</span><span class="p">,</span> <span class="n">gfx</span><span class="o">.</span><span class="n">PointLight</span><span class="p">):</span>
                    <span class="n">ch</span><span class="o">.</span><span class="n">cast_shadow</span> <span class="o">=</span> <span class="n">v</span>

            <span class="c1"># self.scene.traverse(lambda x: set_shadow(x, v))</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">visuals</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""List of all visuals on this canvas."""</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">children</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="s2">"_object_id"</span><span class="p">)]</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Bounds of all currently visuals (visible and invisible)."""</span>
        <span class="n">bounds</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">vis</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">visuals</span><span class="p">:</span>
            <span class="c1"># Skip the bounding box itself</span>
            <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">vis</span><span class="p">,</span> <span class="s2">"_object_id"</span><span class="p">,</span> <span class="s2">""</span><span class="p">)</span> <span class="o">==</span> <span class="s2">"boundingbox"</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">bounds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vis</span><span class="o">.</span><span class="n">_bounds</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">BaseException</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">bounds</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="n">bounds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dstack</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span>

        <span class="n">mn</span> <span class="o">=</span> <span class="n">bounds</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">mx</span> <span class="o">=</span> <span class="n">bounds</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">mn</span><span class="p">,</span> <span class="n">mx</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">max_fps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Maximum frames per second to render."""</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">_subwidget</span><span class="o">.</span><span class="n">_BaseRenderCanvas__scheduler</span><span class="o">.</span><span class="n">_max_fps</span>

    <span class="nd">@max_fps</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">max_fps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">_subwidget</span><span class="o">.</span><span class="n">_BaseRenderCanvas__scheduler</span><span class="o">.</span><span class="n">_max_fps</span> <span class="o">=</span> <span class="n">v</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">moveable_object</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Get/Set the object that can be moved via the transform gizmo."""</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform_gizmo</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform_gizmo</span><span class="o">.</span><span class="n">_object_to_control</span>

    <span class="nd">@moveable_object</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">moveable_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform_gizmo</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">transform_gizmo</span><span class="o">.</span><span class="n">_object_to_control</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">obj</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Object '</span><span class="si">{</span><span class="n">obj</span><span class="si">}</span><span class="s2">' not found."</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="n">obj</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Object '</span><span class="si">{</span><span class="n">obj</span><span class="si">}</span><span class="s2">' consists of multiple WorldObjects."</span><span class="p">)</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="n">obj</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">gfx</span><span class="o">.</span><span class="n">WorldObject</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Expected pygfx object, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform_gizmo</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># The transform gizmo is rendered independent of the scene (so it always stay on top)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">transform_gizmo</span> <span class="o">=</span> <span class="n">gfx</span><span class="o">.</span><span class="n">TransformGizmo</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">transform_gizmo</span><span class="o">.</span><span class="n">add_default_event_handlers</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">renderer</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">transform_gizmo</span><span class="o">.</span><span class="n">_object_to_control</span> <span class="o">=</span> <span class="n">obj</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_is_jupyter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Check if Viewer is using Jupyter canvas."""</span>
        <span class="k">return</span> <span class="s2">"JupyterWgpuCanvas"</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_is_offscreen</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Check if Viewer is using offscreen canvas."""</span>
        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">,</span> <span class="n">OffscreenRenderCanvas</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_window_manager</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Which window manager is being used."""</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">)</span><span class="o">.</span><span class="vm">__module__</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">"."</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">BaseException</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"na"</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_object_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""All object IDs on this canvas in order of addition."""</span>
        <span class="n">obj_ids</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">visuals</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="s2">"_object_id"</span><span class="p">):</span>
                <span class="n">obj_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">_object_id</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">obj_ids</span><span class="p">),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">obj_ids</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">objects</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_objects</span><span class="p">()</span>

    <span class="nd">@lru_cache</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Ordered dictionary {name-&gt;[visuals]} of all objects in order of addition."""</span>
        <span class="n">objects</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">visuals</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="s2">"_object_id"</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">_object_id</span> <span class="ow">in</span> <span class="n">objects</span><span class="p">:</span>
                    <span class="n">objects</span><span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">_object_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">objects</span><span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">_object_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">objects</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">objects_pickable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_objects_pickable</span>

    <span class="nd">@objects_pickable</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">objects_pickable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Expected bool, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

        <span class="c1"># No need to do anything if the value is the same</span>
        <span class="k">if</span> <span class="n">v</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_objects_pickable</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_objects_pickable</span> <span class="o">=</span> <span class="n">v</span>

        <span class="c1"># Set pick_write to new value for all materials</span>
        <span class="k">for</span> <span class="n">objects</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">ob</span> <span class="ow">in</span> <span class="n">objects</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">ob</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">pick_write</span> <span class="o">=</span> <span class="n">v</span>
                <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                    <span class="k">pass</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">highlighted</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Return IDs of currently highlighted objects."""</span>
        <span class="n">highlighted</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="nb">getattr</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="s2">"_highlighted"</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="n">obj</span><span class="p">]]):</span>
                <span class="n">highlighted</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">highlighted</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">on_hover</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Determines what to do when hovering over objects.</span>

<span class="sd">        Can be set to:</span>
<span class="sd">         - `None`: do nothing</span>
<span class="sd">         - "highlight": hide object</span>

<span class="sd">        """</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_hover</span>

    <span class="nd">@on_hover</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">on_hover</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="n">valid</span> <span class="o">=</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="s2">"highlight"</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">valid</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">"Unknown value for on_hover: </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">. Must be one of </span><span class="si">{</span><span class="n">valid</span><span class="si">}</span><span class="s2">."</span>
            <span class="p">)</span>

        <span class="c1"># No need to do anything if the value is the same</span>
        <span class="k">if</span> <span class="n">v</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_hover</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">v</span><span class="p">:</span>
            <span class="c1"># Make objects pickable</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">objects_pickable</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="c1"># Add the event handler</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">add_event_handler</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_highlight_on_hover_event</span><span class="p">,</span> <span class="s2">"pointer_move"</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">remove_event_handler</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_highlight_on_hover_event</span><span class="p">,</span> <span class="s2">"pointer_move"</span>
            <span class="p">)</span>
            <span class="n">current_hover</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">"_current_hover_object"</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

            <span class="c1"># Make sure to unhighlight the current hover object</span>
            <span class="k">if</span> <span class="n">current_hover</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">unhighlight_objects</span><span class="p">(</span><span class="n">current_hover</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_current_hover_object</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_on_hover</span> <span class="o">=</span> <span class="n">v</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_highlight_on_hover_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""This is the event callback for highlighting objects on hover."""</span>
        <span class="c1"># If any buttons are pressed (e.g. mouse left during panning) ignore the event</span>
        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">buttons</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="c1"># Parse the current object</span>
        <span class="n">new_hover</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">pick_info</span><span class="p">[</span><span class="s2">"world_object"</span><span class="p">]</span>
        <span class="n">current_hover</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">"_current_hover_object"</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="c1"># Break early if there is nothing to do</span>
        <span class="k">if</span> <span class="n">new_hover</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">current_hover</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># print("  No hover")</span>
            <span class="k">return</span>

        <span class="n">new_hover_id</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">new_hover</span> <span class="ow">in</span> <span class="n">v</span><span class="p">]</span>
        <span class="n">new_hover_id</span> <span class="o">=</span> <span class="n">new_hover_id</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">new_hover_id</span> <span class="k">else</span> <span class="kc">None</span>

        <span class="c1"># See if we need to de-highlight the current hover object</span>
        <span class="k">if</span> <span class="n">current_hover</span><span class="p">:</span>
            <span class="c1"># If the new object is the same as the current one, we don't need to do anything</span>
            <span class="k">if</span> <span class="n">current_hover</span> <span class="o">==</span> <span class="n">new_hover_id</span><span class="p">:</span>
                <span class="k">return</span>
            <span class="k">if</span> <span class="n">current_hover</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">unhighlight_objects</span><span class="p">(</span><span class="n">current_hover</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_current_hover_object</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Highlight the new object</span>
        <span class="k">if</span> <span class="n">new_hover_id</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">highlight_objects</span><span class="p">(</span>
                <span class="n">new_hover_id</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">"_highlight_on_hover_color"</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_current_hover_object</span> <span class="o">=</span> <span class="n">new_hover_id</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">on_double_click</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Determines what to do when double clicking on objects.</span>

<span class="sd">        Can be set to:</span>
<span class="sd">         - `None`: do nothing</span>
<span class="sd">         - "hide": hide object</span>
<span class="sd">         - "remove": remove object</span>
<span class="sd">         - "select": select object</span>

<span class="sd">        """</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_double_click</span>

    <span class="nd">@on_double_click</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">on_double_click</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="n">valid</span> <span class="o">=</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="s2">"hide"</span><span class="p">,</span> <span class="s2">"remove"</span><span class="p">,</span> <span class="s2">"select"</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">valid</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">"Unknown value for on_double_click: </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">. Must be one of </span><span class="si">{</span><span class="n">valid</span><span class="si">}</span><span class="s2">."</span>
            <span class="p">)</span>

        <span class="c1"># No need to do anything if the value is the same</span>
        <span class="k">if</span> <span class="n">v</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_on_double_click</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="c1"># First try to remove the current event handler for double clicks</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">remove_event_handler</span><span class="p">(</span>
                <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">"_on_double_click_func"</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span> <span class="s2">"double_click"</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">if</span> <span class="n">v</span><span class="p">:</span>
            <span class="c1"># Make objects pickable</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">objects_pickable</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="c1"># Now add the new event handler</span>
            <span class="n">func</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">handle_object_event</span><span class="p">,</span> <span class="n">viewer</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">actions</span><span class="o">=</span><span class="p">(</span><span class="n">v</span><span class="p">,))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">add_event_handler</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="s2">"double_click"</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__on_double_click_func</span> <span class="o">=</span> <span class="n">func</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_on_double_click</span> <span class="o">=</span> <span class="n">v</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_animation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">on_error</span><span class="o">=</span><span class="s2">"remove"</span><span class="p">,</span> <span class="n">run_every</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">req_render</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Add animation function to the Viewer.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x :         callable</span>
<span class="sd">                    Function to add to the animation loop.</span>
<span class="sd">        on_error :  "remove" | "ignore" | "raise"</span>
<span class="sd">                    What to do if the function throws an error. If "remove",</span>
<span class="sd">                    the function will be removed from the animation loop. If</span>
<span class="sd">                    "ignore", the error will be ignored and the function will</span>
<span class="sd">                    continue to be called.</span>
<span class="sd">        run_every : int, optional</span>
<span class="sd">                    Use to run the function every n frames.</span>
<span class="sd">        req_render : bool, optional</span>
<span class="sd">                    Whether this animation requires a re-render of the scene.</span>
<span class="sd">                    This is mainly a flag to help the viewer to decide</span>
<span class="sd">                    whether/when to trigger a render. See also the `render_trigger`</span>
<span class="sd">                    property.</span>

<span class="sd">        """</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">callable</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Expected callable, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

        <span class="k">assert</span> <span class="n">on_error</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">"remove"</span><span class="p">,</span> <span class="s2">"ignore"</span><span class="p">,</span> <span class="s2">"raise"</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_animations</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">on_error</span><span class="p">,</span> <span class="n">run_every</span><span class="p">,</span> <span class="n">req_render</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">remove_animation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Remove animation function from the Viewer.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x :     callable | int</span>
<span class="sd">                Either the function itself or its index</span>
<span class="sd">                in the list of animations.</span>

<span class="sd">        """</span>
        <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_animations_flagged_for_removal</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_animations_flagged_for_removal</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_animations</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="n">x</span><span class="p">]</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Expected callable or index (int), got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_effect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">effect</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Add post-processing effect to the renderer.</span>

<span class="sd">        You can also use this method to adjust the parameters of an existing effect.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        effect :   str</span>
<span class="sd">                    Name of the effect to add. Currently supported:</span>
<span class="sd">                     - "edl" (Eye-Dome Lighting)</span>
<span class="sd">                       This effect enhances depth perception for complex</span>
<span class="sd">                       geometries by darkening edges based on depth differences.</span>

<span class="sd">        **kwargs</span>
<span class="sd">                    Keyword arguments passed to the effect constructor:</span>
<span class="sd">                    - edl:</span>
<span class="sd">                      - strength (default 5): EDL strength; ypical range ~ [0.5, 10.0].</span>
<span class="sd">                      - radius (default 1.5): sampling radius in pixels</span>
<span class="sd">                      - depth_edge_threshold (default 0.0)</span>

<span class="sd">        """</span>
        <span class="n">effect</span> <span class="o">=</span> <span class="n">EFFECT_CLASSES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">effect</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">effect</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Unknown effect: </span><span class="si">{</span><span class="n">effect</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

        <span class="c1"># Check if we already have this effect</span>
        <span class="n">p</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">renderer</span><span class="o">.</span><span class="n">effect_passes</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">effect</span><span class="p">):</span>
                <span class="n">p</span> <span class="o">=</span> <span class="n">e</span>
                <span class="k">break</span>

        <span class="k">if</span> <span class="n">p</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Overwrite the default of 1 (seems too weak in my hands)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">effect</span> <span class="ow">is</span> <span class="n">EDLPass</span><span class="p">)</span> <span class="ow">and</span> <span class="s2">"strength"</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s2">"strength"</span><span class="p">]</span> <span class="o">=</span> <span class="mf">5.0</span>

            <span class="n">p</span> <span class="o">=</span> <span class="n">effect</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">renderer</span><span class="o">.</span><span class="n">effect_passes</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">renderer</span><span class="o">.</span><span class="n">effect_passes</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="n">p</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Update parameters</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
                    <span class="nb">setattr</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Effect '</span><span class="si">{</span><span class="n">effect</span><span class="si">}</span><span class="s2">' has no parameter '</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">'"</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">use_sidecar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">toolbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">start_loop</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Show viewer.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        For Jupyter lab only:</span>

<span class="sd">        use_sidecar : bool</span>
<span class="sd">                      If True, will use the Sidecar extension to display the</span>
<span class="sd">                      viewer outside the notebooks. Will throw an error if</span>
<span class="sd">                      Sidecar is not installed.</span>
<span class="sd">        toolbar :     bool</span>
<span class="sd">                      If True, will show a toolbar. You can always show/hide</span>
<span class="sd">                      the toolbar with ``viewer.show_controls()`` and</span>
<span class="sd">                      ``viewer.hide_controls()``, or the `c` hotkey.</span>

<span class="sd">        For scripts &amp; standard REPL:</span>

<span class="sd">        start_loop :  bool</span>
<span class="sd">                      If True, will start the blocking (!) event loop. This is</span>
<span class="sd">                      the recommended way to show the viewer when using it in a script.</span>
<span class="sd">                      From an interactive REPL such as IPython you should be able to</span>
<span class="sd">                      just call ``Viewer.show()`` and the interactive viewer will appear</span>
<span class="sd">                      while still allowing you to interact with the REPL.</span>

<span class="sd">        """</span>
        <span class="c1"># This is for e.g. headless testing</span>
        <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="s2">"HEADLESS"</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">"Viewer widget not shown - running in headless mode."</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="c1"># Start the animation loop</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">request_draw</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_animate</span><span class="p">)</span>

        <span class="c1"># If this is an offscreen canvas, we don't need to do anything else</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">,</span> <span class="n">OffscreenRenderCanvas</span><span class="p">):</span>
            <span class="k">return</span>

        <span class="c1"># In terminal we can just show the window</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_jupyter</span><span class="p">:</span>
            <span class="c1"># Not all backends have a show method (e.g. GLFW does not)</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">,</span> <span class="s2">"show"</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">start_loop</span><span class="p">:</span>
                <span class="kn">from</span><span class="w"> </span><span class="nn">rendercanvas.auto</span><span class="w"> </span><span class="kn">import</span> <span class="n">loop</span>

                <span class="n">loop</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">utils</span><span class="o">.</span><span class="n">_type_of_script</span><span class="p">()</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">"terminal"</span><span class="p">,</span> <span class="s2">"script"</span><span class="p">):</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="s2">"Running in a (potentially) non-interactive terminal or script "</span>
                    <span class="s2">"environment. You may have to manually start the event loop "</span>
                    <span class="s2">"for the canvas to render:</span><span class="se">\n\n</span><span class="s2">"</span>
                    <span class="s2">"  &gt;&gt;&gt; v = octarine.Viewer(show=False)</span><span class="se">\n</span><span class="s2">"</span>
                    <span class="s2">"  &gt;&gt;&gt; ...  # setup your viewer</span><span class="se">\n</span><span class="s2">"</span>
                    <span class="s2">"  &gt;&gt;&gt; v.show(start_loop=True)</span><span class="se">\n\n</span><span class="s2">"</span>
                    <span class="s2">"Alternatively, use the loop.run() function:</span><span class="se">\n\n</span><span class="s2">"</span>
                    <span class="s2">"  &gt;&gt;&gt; from rendercanvas.auto import loop</span><span class="se">\n</span><span class="s2">"</span>
                    <span class="s2">"  &gt;&gt;&gt; ...  # setup your viewer</span><span class="se">\n</span><span class="s2">"</span>
                    <span class="s2">"  &gt;&gt;&gt; v.show()</span><span class="se">\n</span><span class="s2">"</span>
                    <span class="s2">"  &gt;&gt;&gt; loop.run()</span><span class="se">\n\n</span><span class="s2">"</span>  <span class="c1"># do not remove the \n\n here</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># if not hasattr(self, 'widget'):</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">.jupyter</span><span class="w"> </span><span class="kn">import</span> <span class="n">JupyterOutput</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">display</span>

            <span class="c1"># Construct the widget</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">"widget"</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">widget</span> <span class="o">=</span> <span class="n">JupyterOutput</span><span class="p">(</span>
                    <span class="bp">self</span><span class="p">,</span>
                    <span class="n">use_sidecar</span><span class="o">=</span><span class="n">use_sidecar</span><span class="p">,</span>
                    <span class="n">toolbar</span><span class="o">=</span><span class="n">toolbar</span><span class="p">,</span>
                    <span class="n">sidecar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">"title"</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_title</span><span class="p">},</span>
                <span class="p">)</span>

            <span class="c1"># This will display the viewer right here and there</span>
            <span class="n">display</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">show_message</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s2">"top-right"</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">"""Show message on canvas.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        message :   str | None</span>
<span class="sd">                    Message to show. Set to `None` to remove the existing message.</span>
<span class="sd">        position :  "top-left" | "top-right" | "bottom-left" | "bottom-right" | "center"</span>
<span class="sd">                    Position of the message on the canvas.</span>
<span class="sd">        font_size : int, optional</span>
<span class="sd">                    Font size of the message.</span>
<span class="sd">        color :     str | tuple, optional</span>
<span class="sd">                    Color of the message. If `None`, will use white.</span>
<span class="sd">        duration :  int, optional</span>
<span class="sd">                    Number of seconds after which to fade the message.</span>

<span class="sd">        """</span>
        <span class="k">if</span> <span class="n">message</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">"_message_text"</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_text</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">overlay_scene</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_message_text</span><span class="p">)</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_text</span>
            <span class="k">return</span>

        <span class="n">_positions</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">"top-left"</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="s2">"top-right"</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="s2">"bottom-left"</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.95</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.95</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="s2">"bottom-right"</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.95</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.95</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
            <span class="s2">"center"</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="n">position</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">_positions</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Unknown position: </span><span class="si">{</span><span class="n">position</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">"_message_text"</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_message_text</span> <span class="o">=</span> <span class="n">text2gfx</span><span class="p">(</span>
                <span class="n">message</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"white"</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="n">font_size</span><span class="p">,</span> <span class="n">screen_space</span><span class="o">=</span><span class="kc">True</span>
            <span class="p">)</span>

        <span class="c1"># Make sure the text is in the scene</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_text</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">overlay_scene</span><span class="o">.</span><span class="n">children</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">overlay_scene</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_message_text</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_message_text</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_message_text</span><span class="o">.</span><span class="n">font_size</span> <span class="o">=</span> <span class="n">font_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_message_text</span><span class="o">.</span><span class="n">anchor</span> <span class="o">=</span> <span class="n">position</span>
        <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_message_text</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">cmap</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="n">color</span><span class="p">)</span><span class="o">.</span><span class="n">rgba</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_message_text</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">opacity</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_message_text</span><span class="o">.</span><span class="n">local</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">_positions</span><span class="p">[</span><span class="n">position</span><span class="p">]</span>

        <span class="c1"># When do we need to start fading out?</span>
        <span class="k">if</span> <span class="n">duration</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_fade_out_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">+</span> <span class="n">duration</span>

            <span class="k">def</span><span class="w"> </span><span class="nf">_fade_message</span><span class="p">():</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">"_message_text"</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">remove_animation</span><span class="p">(</span><span class="n">_fade_message</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fade_out_time</span><span class="p">:</span>
                        <span class="c1"># This means the text will fade fade over 1/0.02 = 50 frames</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_message_text</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">opacity</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_message_text</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">opacity</span> <span class="o">-</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mi">0</span>
                        <span class="p">)</span>

                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_text</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">opacity</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_text</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">overlay_scene</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_message_text</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">remove_animation</span><span class="p">(</span><span class="n">_fade_message</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">add_animation</span><span class="p">(</span><span class="n">_fade_message</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">show_controls</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Show controls."""</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_jupyter</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">toolbar</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">"_controls"</span><span class="p">):</span>
                <span class="kn">from</span><span class="w"> </span><span class="nn">.controls</span><span class="w"> </span><span class="kn">import</span> <span class="n">Controls</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">_controls</span> <span class="o">=</span> <span class="n">Controls</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_controls</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">hide_controls</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Hide controls."""</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_jupyter</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">toolbar</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">hide</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">"_controls"</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_controls</span><span class="o">.</span><span class="n">hide</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_toggle_controls</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Switch controls on and off."""</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_jupyter</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">toolbar</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">toggle</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">"_controls"</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">show_controls</span><span class="p">()</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_controls</span><span class="o">.</span><span class="n">isVisible</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">hide_controls</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">show_controls</span><span class="p">()</span>

    <span class="nd">@update_viewer</span><span class="p">(</span><span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Clear canvas of objects (expects lights and background)."""</span>
        <span class="c1"># Skip if running in headless mode</span>
        <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="s2">"HEADLESS"</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="k">return</span>

        <span class="c1"># Remove everything but the lights and backgrounds</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">visuals</span><span class="p">)</span>

        <span class="c1"># Rset the transform gizmo</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">transform_gizmo</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@update_viewer</span><span class="p">(</span><span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">remove_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">to_remove</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Remove given neurons/visuals from canvas."""</span>
        <span class="n">to_remove</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">make_iterable</span><span class="p">(</span><span class="n">to_remove</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">vis</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">children</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">vis</span> <span class="ow">in</span> <span class="n">to_remove</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">vis</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">vis</span><span class="p">,</span> <span class="s2">"_object_id"</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">vis</span><span class="o">.</span><span class="n">_object_id</span> <span class="ow">in</span> <span class="n">to_remove</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">vis</span><span class="p">)</span>

    <span class="nd">@update_viewer</span><span class="p">(</span><span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">pop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Remove the most recently added N visuals."""</span>
        <span class="k">for</span> <span class="n">vis</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="o">-</span><span class="n">N</span><span class="p">:]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_objects</span><span class="p">(</span><span class="n">vis</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">show_bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Set to ``True`` to show bounding box."""</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_show_bounds</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">show_fps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Show frames per second."""</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_show_fps</span>

    <span class="nd">@show_fps</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">show_fps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Expected bool, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_show_fps</span> <span class="o">=</span> <span class="n">v</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_render_stale</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">toggle_bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Toggle bounding box."""</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show_bounds</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_bounds</span>

    <span class="nd">@show_bounds</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">show_bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Need bool, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_show_bounds</span> <span class="o">=</span> <span class="n">v</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_bounds</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_bounds</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_bounds</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">remove_bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Remove bounding box visual."""</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_show_bounds</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">visuals</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="s2">"_object_type"</span><span class="p">,</span> <span class="s2">""</span><span class="p">)</span> <span class="o">==</span> <span class="s2">"boundingbox"</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">remove_objects</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">resize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Resize canvas.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        size :  (width, height) tuple</span>
<span class="sd">                New size of the canvas.</span>
<span class="sd">        """</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">size</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">set_logical_size</span><span class="p">(</span><span class="o">*</span><span class="n">size</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">update_bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"w"</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Update bounding box visual."""</span>
        <span class="c1"># Remove any existing visual</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_bounds</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_show_bounds</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># Skip if no visual on canvas</span>
        <span class="n">bounds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">get_bounding_box</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bounds</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
            <span class="k">return</span>

        <span class="c1"># Create box visual</span>
        <span class="n">box</span> <span class="o">=</span> <span class="n">gfx</span><span class="o">.</span><span class="n">BoxHelper</span><span class="p">()</span>
        <span class="n">box</span><span class="o">.</span><span class="n">set_transform_by_aabb</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span>

        <span class="c1"># Add custom attributes</span>
        <span class="n">box</span><span class="o">.</span><span class="n">_object_type</span> <span class="o">=</span> <span class="s2">"boundingbox"</span>
        <span class="n">box</span><span class="o">.</span><span class="n">_object_id</span> <span class="o">=</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">box</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">center_camera</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Center camera on visuals."""</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">show_object</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">view_dir</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="n">up</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
            <span class="p">)</span>

    <span class="nd">@update_viewer</span><span class="p">(</span><span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">clear</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Add object to canvas.</span>

<span class="sd">        This function is a general entry point for adding objects to the canvas.</span>
<span class="sd">        It will look at the type of the input and try to find an appropriate</span>
<span class="sd">        function to convert the input to visuals.</span>

<span class="sd">        Use `octarine.register_converter` to add custom converters.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x</span>
<span class="sd">                    Object(s) to add to the canvas.</span>
<span class="sd">        name :      str, optional</span>
<span class="sd">                    Name for the visual(s).</span>
<span class="sd">        center :    bool, optional</span>
<span class="sd">                    If True, re-center camera to all objects on canvas.</span>
<span class="sd">        clear :     bool, optional</span>
<span class="sd">                    If True, clear canvas before adding new objects.</span>
<span class="sd">        **kwargs</span>
<span class="sd">                    Keyword arguments passed to the conversion functions when</span>
<span class="sd">                    generating visuals.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        """</span>
        <span class="k">if</span> <span class="n">clear</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">utils</span><span class="o">.</span><span class="n">is_iterable</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">xx</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">clear</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">center</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">center_camera</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="n">converter</span> <span class="o">=</span> <span class="n">get_converter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">raise_missing</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">converter</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"No converter found for </span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="s2">)"</span><span class="p">)</span>

        <span class="c1"># Check if we have to provide a color</span>
        <span class="k">if</span> <span class="s2">"color"</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="s2">"color"</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">converter</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">"color"</span><span class="p">]</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_next_color</span><span class="p">()</span><span class="o">.</span><span class="n">rgba</span><span class="p">)</span>

        <span class="n">visuals</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">make_iterable</span><span class="p">(</span><span class="n">converter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">visuals</span><span class="p">:</span>
            <span class="c1"># If we have a name, assign it to the visual</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">v</span><span class="o">.</span><span class="n">_object_id</span> <span class="o">=</span> <span class="n">name</span>
            <span class="c1"># If not we either use existing ID or generate a new one</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Give visuals an _object_id if they don't already have one</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="s2">"_object_id"</span><span class="p">):</span>
                    <span class="n">new_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_label</span><span class="p">(</span><span class="s2">"Object"</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">v2</span> <span class="ow">in</span> <span class="n">visuals</span><span class="p">:</span>
                        <span class="n">v</span><span class="o">.</span><span class="n">_object_id</span> <span class="o">=</span> <span class="n">new_id</span>
                <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">_object_id</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="n">v</span><span class="o">.</span><span class="n">_object_id</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">_object_id</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">center</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">center_camera</span><span class="p">()</span>

    <span class="nd">@update_viewer</span><span class="p">(</span><span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_add_to_scene</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">visual</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Add visual to scene.</span>

<span class="sd">        This is just a convenient collection point for us to trigger a bunch of updates in one go,</span>
<span class="sd">        """</span>
        <span class="c1"># If we need objects to be pickable, set the material accordingly</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects_pickable</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">visual</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">pick_write</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">visual</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">center</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">center_camera</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_mesh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mesh</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Add mesh to canvas.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        mesh :      Mesh-like</span>
<span class="sd">                    Mesh to plot. If this is a pygfx.Mesh, it will be added</span>
<span class="sd">                    directly to the scene without modification (i.e. `color`,</span>
<span class="sd">                    `alpha`, etc. will be ignored).</span>
<span class="sd">        name :      str, optional</span>
<span class="sd">                    Name for the visual.</span>
<span class="sd">        color :     str | tuple, optional</span>
<span class="sd">                    Color to use for plotting. If multiple colors,</span>
<span class="sd">                    must be a list of colors with the same length as</span>
<span class="sd">                    the number of faces or vertices.</span>
<span class="sd">        alpha :     float, optional</span>
<span class="sd">                    Opacity value [0-1]. If provided, will override</span>
<span class="sd">                    the alpha channel of the color.</span>
<span class="sd">        center :    bool, optional</span>
<span class="sd">                    If True, re-center camera to all objects on canvas.</span>

<span class="sd">        """</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">tm</span><span class="o">.</span><span class="n">Scene</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">ob</span> <span class="ow">in</span> <span class="n">mesh</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">ob</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">utils</span><span class="o">.</span><span class="n">is_mesh_like</span><span class="p">(</span><span class="n">mesh</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Expected mesh-like object, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_color</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_label</span><span class="p">(</span><span class="s2">"Mesh"</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">gfx</span><span class="o">.</span><span class="n">Mesh</span><span class="p">):</span>
            <span class="n">visual</span> <span class="o">=</span> <span class="n">mesh2gfx</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">visual</span> <span class="o">=</span> <span class="n">mesh</span>

        <span class="n">visual</span><span class="o">.</span><span class="n">_object_id</span> <span class="o">=</span> <span class="n">name</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_add_to_scene</span><span class="p">(</span><span class="n">visual</span><span class="p">,</span> <span class="n">center</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_points</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">points</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">marker</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">size_space</span><span class="o">=</span><span class="s2">"screen"</span><span class="p">,</span>
        <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">"""Add points plot to canvas.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        points :    (N, 3) array</span>
<span class="sd">                    Points to plot.</span>
<span class="sd">        name :      str, optional</span>
<span class="sd">                    Name for the visual.</span>
<span class="sd">        color :     str | tuple, optional</span>
<span class="sd">                    Color to use for plotting. Can be the name of</span>
<span class="sd">                    a colormap or a single color.</span>
<span class="sd">        marker :    str, optional</span>
<span class="sd">                    Marker to use for plotting. By default (None), will</span>
<span class="sd">                    use a point. Other options include e.g. "circle", "ring"</span>
<span class="sd">                    or "diamond". See `pygfx.MarkerShape` for the definitive</span>
<span class="sd">                    list of options. Please note that you may have to</span>
<span class="sd">                    increase the size of the marker to see some of the shapes.</span>
<span class="sd">        size :      int | float</span>
<span class="sd">                    Marker size. Can be a single value or an array of</span>
<span class="sd">                    sizes for each point.</span>
<span class="sd">        size_space : "screen" | "world" | "model", optional</span>
<span class="sd">                    Units to use for the marker size. "screen" (default)</span>
<span class="sd">                    will keep the line width constant on the screen, while</span>
<span class="sd">                    "world" and "model" will keep it constant in world and</span>
<span class="sd">                    model coordinates, respectively. In the latter two cases,</span>
<span class="sd">                    `size` corresponds to the diameter (not radius) of the</span>
<span class="sd">                    marker!</span>
<span class="sd">        center :    bool, optional</span>
<span class="sd">                    If True, re-center camera to all objects on canvas.</span>

<span class="sd">        """</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Expected numpy array, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">points</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">points</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Expected (N, 3) array, got </span><span class="si">{</span><span class="n">points</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_color</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_label</span><span class="p">(</span><span class="s2">"Scatter"</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

        <span class="n">visual</span> <span class="o">=</span> <span class="n">points2gfx</span><span class="p">(</span>
            <span class="n">points</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">size_space</span><span class="o">=</span><span class="n">size_space</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span>
        <span class="p">)</span>
        <span class="n">visual</span><span class="o">.</span><span class="n">_object_id</span> <span class="o">=</span> <span class="n">name</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_add_to_scene</span><span class="p">(</span><span class="n">visual</span><span class="p">,</span> <span class="n">center</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_lines</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">lines</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">linewidth_space</span><span class="o">=</span><span class="s2">"screen"</span><span class="p">,</span>
        <span class="n">linestyle</span><span class="o">=</span><span class="s2">"solid"</span><span class="p">,</span>
        <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">"""Add lines to canvas.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        lines :     list of (N, 3) arrays | (N, 3) array</span>
<span class="sd">                    Lines to plot. If a list of arrays, each array</span>
<span class="sd">                    represents a separate line. If a single array,</span>
<span class="sd">                    each row represents a point in the line. You can</span>
<span class="sd">                    introduce breaks in the line by inserting NaNs.</span>
<span class="sd">        name :      str, optional</span>
<span class="sd">                    Name for the visual.</span>
<span class="sd">        color :     str | tuple, optional</span>
<span class="sd">                    Color to use for plotting. Can be a single color</span>
<span class="sd">                    or one for every point in the line(s).</span>
<span class="sd">        linewidth : float, optional</span>
<span class="sd">                    Line width.</span>
<span class="sd">        linewidth_space : "screen" | "world" | "model", optional</span>
<span class="sd">                    Units to use for the line width. "screen" (default)</span>
<span class="sd">                    will keep the line width constant on the screen, while</span>
<span class="sd">                    "world" and "model" will keep it constant in world and</span>
<span class="sd">                    model coordinates, respectively.</span>
<span class="sd">        linestyle : "solid" | "dashed" | "dotted" | "dashdot" | tuple, optional</span>
<span class="sd">                    Line style to use. If a tuple, must define the on/off</span>
<span class="sd">                    sequence.</span>
<span class="sd">        center :    bool, optional</span>
<span class="sd">                    If True, re-center camera to all objects on canvas.</span>

<span class="sd">        """</span>
        <span class="c1"># TODO:</span>
        <span class="c1"># - allow providing a tuple of (positions, edges) for lines</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">lines</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">lines</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Expected (N, 3) array, got </span><span class="si">{</span><span class="n">lines</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span><span class="n">l</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">l</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">]):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Expected list of (N, 3) arrays."</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Expected numpy array or list, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_color</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_label</span><span class="p">(</span><span class="s2">"Lines"</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

        <span class="n">visual</span> <span class="o">=</span> <span class="n">lines2gfx</span><span class="p">(</span>
            <span class="n">lines</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span>
            <span class="n">linewidth_space</span><span class="o">=</span><span class="n">linewidth_space</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="n">dash_pattern</span><span class="o">=</span><span class="n">linestyle</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">visual</span><span class="o">.</span><span class="n">_object_id</span> <span class="o">=</span> <span class="n">name</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_to_scene</span><span class="p">(</span><span class="n">visual</span><span class="p">,</span> <span class="n">center</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_volume</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">volume</span><span class="p">,</span>
        <span class="n">spacing</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
        <span class="n">offset</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="n">clim</span><span class="o">=</span><span class="s2">"data"</span><span class="p">,</span>
        <span class="nb">slice</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">interpolation</span><span class="o">=</span><span class="s2">"linear"</span><span class="p">,</span>
        <span class="n">hide_zero</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">"""Add image volume to canvas.</span>

<span class="sd">        Note that the default blend mode for the renderer may cause objects</span>
<span class="sd">        behind or inside the volume to look funny. You can change the blend</span>
<span class="sd">        mode by setting e.g. `viewer.blend_mode='additive'`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        volume :    (N, M, K) array</span>
<span class="sd">                    Volume to plot.</span>
<span class="sd">        spacing :   tuple</span>
<span class="sd">                    Spacing between voxels.</span>
<span class="sd">        name :      str, optional</span>
<span class="sd">                    Name for the visual.</span>
<span class="sd">        color :     color | list of colors | pygfx.Texture, optional</span>
<span class="sd">                    Colormap to render the volume. This can be:</span>
<span class="sd">                      - name of a colormap (e.g. "viridis" or "magma")</span>
<span class="sd">                      - a single color (name, hex, rgb, rgba)</span>
<span class="sd">                      - a list of colors</span>
<span class="sd">                      - a 1D pygfx.Texture</span>
<span class="sd">                    Note that single colors typically don't look good and</span>
<span class="sd">                    it's better to define at least two colors. For example,</span>
<span class="sd">                    instead of "red" use ["red", "yellow"]. If `None` will</span>
<span class="sd">                    use one of the built-in pygfx colormaps.</span>
<span class="sd">        opacity :   float, optional</span>
<span class="sd">                    Overall opacity of the volume. Must be between 0 and 1.</span>
<span class="sd">        offset :    tuple, optional</span>
<span class="sd">                    (x, y, z) offset for the volume. If None, will use (0, 0, 0).</span>
<span class="sd">        clim :      "data" | "datatype" | tuple, optional</span>
<span class="sd">                    The contrast limits to scale the data values with.</span>
<span class="sd">                      - "data" (default) will use the min/max of the data</span>
<span class="sd">                      - "datatype" will use (0, theoretical max of data type)</span>
<span class="sd">                        for integer data, e.g. (0, 255) for int8 and uint8,</span>
<span class="sd">                        and (0, 1) for float data assuming the data has been</span>
<span class="sd">                        normalized</span>
<span class="sd">                      - tuple of min/max values or combination of "data" and</span>
<span class="sd">                        "datatype" strings</span>
<span class="sd">        slice :         bool | tuple, optional</span>
<span class="sd">                        Render volume slices instead of the full volume:</span>
<span class="sd">                        - True: render slices along all three dimensions</span>
<span class="sd">                        - tuple of bools, e.g. `(True, True, False)`: render slices</span>
<span class="sd">                          in the respective dimensions</span>
<span class="sd">                        - tuple of floats, e.g. `(0.5, 0.5, 0.5)`: render slices</span>
<span class="sd">                          at the respective positions (relative to the volume size)</span>
<span class="sd">        interpolation : "linear" | "nearest"</span>
<span class="sd">                    Interpolation to use when rendering the volume. "linear"</span>
<span class="sd">                    (default) looks better but is slower.</span>
<span class="sd">        hide_zero : bool</span>
<span class="sd">                    If True, will hide voxels with lowest value according to `cmin`.</span>
<span class="sd">        center :    bool, optional</span>
<span class="sd">                    If True, re-center camera to all objects on canvas.</span>

<span class="sd">        """</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">volume</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Expected numpy array, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">volume</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">volume</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Expected 3D array, got </span><span class="si">{</span><span class="n">volume</span><span class="o">.</span><span class="n">ndim</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_label</span><span class="p">(</span><span class="s2">"Volume"</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

        <span class="n">visuals</span> <span class="o">=</span> <span class="n">volume2gfx</span><span class="p">(</span>
            <span class="n">volume</span><span class="p">,</span>
            <span class="n">spacing</span><span class="o">=</span><span class="n">spacing</span><span class="p">,</span>
            <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="n">opacity</span><span class="o">=</span><span class="n">opacity</span><span class="p">,</span>
            <span class="n">clim</span><span class="o">=</span><span class="n">clim</span><span class="p">,</span>
            <span class="nb">slice</span><span class="o">=</span><span class="nb">slice</span><span class="p">,</span>
            <span class="n">interpolation</span><span class="o">=</span><span class="n">interpolation</span><span class="p">,</span>
            <span class="n">hide_zero</span><span class="o">=</span><span class="n">hide_zero</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">vis</span> <span class="ow">in</span> <span class="n">visuals</span><span class="p">:</span>
            <span class="n">vis</span><span class="o">.</span><span class="n">_object_id</span> <span class="o">=</span> <span class="n">name</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_to_scene</span><span class="p">(</span><span class="n">vis</span><span class="p">,</span> <span class="n">center</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Close the viewer."""</span>
        <span class="c1"># Skip if this is headless mode</span>
        <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="s2">"HEADLESS"</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="k">return</span>

        <span class="c1"># Clear first to free all visuals</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

        <span class="c1"># Remove from config if this is the primary viewer</span>
        <span class="k">if</span> <span class="bp">self</span> <span class="o">==</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="s2">"PRIMARY_VIEWER"</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
            <span class="k">del</span> <span class="n">config</span><span class="o">.</span><span class="n">PRIMARY_VIEWER</span>

        <span class="c1"># Close if not already closed</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">get_closed</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">"_controls"</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_controls</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="c1"># Close the Jupyter widget</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">"widget"</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="p">,</span> <span class="s2">"_is_closed"</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">close_viewer</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">viewers</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">pass</span>

    <span class="nd">@update_viewer</span><span class="p">(</span><span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">hide_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Hide given object(s).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        obj :   str | list</span>
<span class="sd">                Object(s) to hide.</span>

<span class="sd">        """</span>
        <span class="n">objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span>  <span class="c1"># grab once to speed things up</span>
        <span class="k">for</span> <span class="n">ob</span> <span class="ow">in</span> <span class="n">utils</span><span class="o">.</span><span class="n">make_iterable</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">ob</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">objects</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s1">'Object "</span><span class="si">{</span><span class="n">ob</span><span class="si">}</span><span class="s1">" not found on canvas.'</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">objects</span><span class="p">[</span><span class="n">ob</span><span class="p">]:</span>
                <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="s2">"_pinned"</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
                    <span class="k">continue</span>
                <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">visible</span><span class="p">:</span>
                    <span class="n">v</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="nd">@update_viewer</span><span class="p">(</span><span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">hide_selected</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Hide currently selected object(s)."""</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hide_neurons</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selected</span><span class="p">)</span>

    <span class="nd">@update_viewer</span><span class="p">(</span><span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">unhide_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Unhide given object(s).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        obj :   str | list | None</span>
<span class="sd">                Object(s) to unhide. If None, will unhide all objects.</span>

<span class="sd">        """</span>
        <span class="n">objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span>  <span class="c1"># grab once to speed things up</span>
        <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ids</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">make_iterable</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ids</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">objects</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

        <span class="k">for</span> <span class="n">ob</span> <span class="ow">in</span> <span class="n">ids</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ob</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">objects</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Object </span><span class="si">{</span><span class="n">ob</span><span class="si">}</span><span class="s2"> not found on canvas."</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">objects</span><span class="p">[</span><span class="n">ob</span><span class="p">]:</span>
                <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="s2">"_pinned"</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
                    <span class="k">continue</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span><span class="o">.</span><span class="n">visible</span><span class="p">:</span>
                    <span class="n">v</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">highlight_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="mf">0.2</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Highlight given object(s) by increasing their brightness.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        obj :   str | int | list | visual</span>
<span class="sd">                Object(s) to highlight. Can be the name(s) or ID(s) of</span>
<span class="sd">                the object(s), their index(es) in the list of visuals,</span>
<span class="sd">                or the visual(s) themselves. Objects already highlighted</span>
<span class="sd">                will be silently ignored.</span>
<span class="sd">        color : float | tuple</span>
<span class="sd">                Color to use for highlighting. If a float, will change</span>
<span class="sd">                the HSV value of the current color. If a tuple, will</span>
<span class="sd">                use the RGB(A) color.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        Viewer.unhighlight_objects</span>
<span class="sd">                Use to remove highlights.</span>

<span class="sd">        """</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">utils</span><span class="o">.</span><span class="n">is_iterable</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
            <span class="n">objects</span> <span class="o">=</span> <span class="p">[</span><span class="n">obj</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">objects</span> <span class="o">=</span> <span class="n">obj</span>

        <span class="n">all_objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span>  <span class="c1"># grab once to speed things up</span>

        <span class="k">for</span> <span class="n">ob</span> <span class="ow">in</span> <span class="n">objects</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ob</span> <span class="ow">in</span> <span class="n">all_objects</span><span class="p">:</span>
                <span class="n">list_</span> <span class="o">=</span> <span class="n">all_objects</span><span class="p">[</span><span class="n">ob</span><span class="p">]</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ob</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                <span class="n">list_</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="n">ob</span><span class="p">]</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ob</span><span class="p">,</span> <span class="n">gfx</span><span class="o">.</span><span class="n">WorldObject</span><span class="p">):</span>
                <span class="n">list_</span> <span class="o">=</span> <span class="p">[</span><span class="n">ob</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Unknown object type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">ob</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">list_</span><span class="p">:</span>
                <span class="c1"># Skip if object is pinned</span>
                <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="s2">"_pinned"</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
                    <span class="k">continue</span>
                <span class="c1"># Skip if object is already highlighted</span>
                <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="s2">"_highlighted"</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
                    <span class="k">continue</span>

                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
                    <span class="c1"># Work in HSL space</span>
                    <span class="n">h</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">l</span> <span class="o">=</span> <span class="n">o</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">to_hsl</span><span class="p">()</span>
                    <span class="c1"># If the value is not maxed yet, increase it</span>
                    <span class="k">if</span> <span class="n">l</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">l</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="n">color</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">l</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">l</span> <span class="o">-</span> <span class="n">color</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

                    <span class="n">new_color</span> <span class="o">=</span> <span class="n">gfx</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">from_hsl</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># See if pygfx can handle the color</span>
                    <span class="n">new_color</span> <span class="o">=</span> <span class="n">gfx</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>

                <span class="n">o</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">_original_color</span> <span class="o">=</span> <span class="n">o</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">color</span>
                <span class="n">o</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">new_color</span>
                <span class="n">o</span><span class="o">.</span><span class="n">_highlighted</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">unhighlight_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Unhighlight given object(s).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        obj :   str | int | list | visual</span>
<span class="sd">                Object(s) to unhighlight. Can be the name(s) or ID(s) of</span>
<span class="sd">                the object(s), their index(es) in the list of visuals,</span>
<span class="sd">                or the visual(s) themselves. If None, will unhighlight all</span>
<span class="sd">                objects. Objects that aren't highlighted will be silently</span>
<span class="sd">                ignored.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        Viewer.highlight_objects</span>
<span class="sd">                Use to highlight objects</span>

<span class="sd">        """</span>
        <span class="c1"># Important note: it looks like any attribute we added previously</span>
        <span class="c1"># will (at some point) have been silently renamed to "_Viewer{attribute}"</span>
        <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">visuals</span> <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="s2">"_highlighted"</span><span class="p">,</span> <span class="kc">False</span><span class="p">)]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">utils</span><span class="o">.</span><span class="n">is_iterable</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
            <span class="n">objects</span> <span class="o">=</span> <span class="p">[</span><span class="n">obj</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">objects</span> <span class="o">=</span> <span class="n">obj</span>

        <span class="n">all_objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span>  <span class="c1"># grab once to speed things up</span>

        <span class="k">for</span> <span class="n">ob</span> <span class="ow">in</span> <span class="n">objects</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ob</span> <span class="ow">in</span> <span class="n">all_objects</span><span class="p">:</span>
                <span class="n">list_</span> <span class="o">=</span> <span class="n">all_objects</span><span class="p">[</span><span class="n">ob</span><span class="p">]</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ob</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                <span class="n">list_</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">visuals</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="n">ob</span><span class="p">]</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ob</span><span class="p">,</span> <span class="n">gfx</span><span class="o">.</span><span class="n">WorldObject</span><span class="p">):</span>
                <span class="n">list_</span> <span class="o">=</span> <span class="p">[</span><span class="n">ob</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Unknown object type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">ob</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">list_</span><span class="p">:</span>
                <span class="c1"># Skip if object is pinned</span>
                <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="s2">"_pinned"</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
                    <span class="k">continue</span>

                <span class="c1"># Skip if object isn't actually highlighed</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="s2">"_highlighted"</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
                    <span class="k">continue</span>
                <span class="n">o</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">o</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">_original_color</span>
                <span class="k">del</span> <span class="n">o</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">_original_color</span>
                <span class="k">del</span> <span class="n">o</span><span class="o">.</span><span class="n">_highlighted</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">pin_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Pin given object(s).</span>

<span class="sd">        Changes to the color or visibility of pinned neurons are silently</span>
<span class="sd">        ignored. You can use this to keep specific neurons visible while</span>
<span class="sd">        cycling through the rest - useful for comparisons.</span>

<span class="sd">        """</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">make_iterable</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="n">objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span>  <span class="c1"># grab only once to speed things up</span>

        <span class="k">for</span> <span class="n">ob</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ob</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">objects</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Object </span><span class="si">{</span><span class="n">ob</span><span class="si">}</span><span class="s2"> not found on canvas."</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">objects</span><span class="p">[</span><span class="n">ob</span><span class="p">]:</span>
                <span class="n">v</span><span class="o">.</span><span class="n">_pinned</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">unpin_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Unpin given object(s).</span>

<span class="sd">        Use ``obj`` to unhide specific neurons.</span>

<span class="sd">        """</span>
        <span class="n">objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span>  <span class="c1"># grab once to speed things up</span>
        <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="n">objects</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">make_iterable</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">ob</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ob</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">objects</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Object </span><span class="si">{</span><span class="n">ob</span><span class="si">}</span><span class="s2"> not found on canvas."</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">objects</span><span class="p">[</span><span class="n">ob</span><span class="p">]:</span>
                <span class="n">v</span><span class="o">.</span><span class="n">_pinned</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="nd">@update_viewer</span><span class="p">(</span><span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_alpha_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">objects</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Defines how objects' colors are blended.</span>

<span class="sd">        With version v0.13.0 pygfx replaced the single renderer.blend_mode property with</span>
<span class="sd">        customizable per-material alpha modes. The Viewer.set_alpha_mode function provides</span>
<span class="sd">        a high-level interface to these settings. If you need more fine-grained control,</span>
<span class="sd">        see the material.alpha_mode property of individual objects.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        mode :      str</span>
<span class="sd">                    The mode to set. Please see the pygfx documentation for details:</span>
<span class="sd">                      &gt;&gt;&gt; import pygfx</span>
<span class="sd">                      &gt;&gt;&gt; help(pygfx.Material.alpha_mode)</span>
<span class="sd">        objects :   list, optional</span>
<span class="sd">                    Objects to set the alpha mode for. If None, will set for all objects.</span>

<span class="sd">        """</span>
        <span class="k">if</span> <span class="n">objects</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">objects</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">objects</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="n">n</span><span class="p">]:</span>
                <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="s2">"_pinned"</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
                    <span class="k">continue</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="s2">"material"</span><span class="p">):</span>
                    <span class="k">continue</span>
                <span class="n">v</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">alpha_mode</span> <span class="o">=</span> <span class="n">mode</span>

    <span class="nd">@update_viewer</span><span class="p">(</span><span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_colors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">alpha_mode</span><span class="o">=</span><span class="s2">"auto"</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Set object color.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        c :     tuple | dict</span>
<span class="sd">                RGB color(s) to apply. Values must be 0-1. Accepted:</span>
<span class="sd">                   1. Tuple of single color. Applied to all visible objects.</span>
<span class="sd">                   2. Dictionary names/IDs to colors.</span>
<span class="sd">        alpha_mode : str</span>
<span class="sd">                If "auto" (default), will set the alpha mode to "add" if the</span>
<span class="sd">                opacity is &lt; 1, and "opaque" otherwise. Set `alpha_mode` to `None` to</span>
<span class="sd">                skip this adjustment.</span>

<span class="sd">        """</span>
        <span class="n">objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span>  <span class="c1"># grab once to speed things up</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">str</span><span class="p">)):</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="p">{</span><span class="n">s</span><span class="p">:</span> <span class="n">c</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">objects</span><span class="p">}</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">cmap</span> <span class="o">=</span> <span class="n">c</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">'Unable to use colors of type "</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="si">}</span><span class="s1">"'</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">objects</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">cmap</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">objects</span><span class="p">[</span><span class="n">n</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="s2">"_pinned"</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
                        <span class="k">continue</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="s2">"material"</span><span class="p">):</span>
                        <span class="k">continue</span>
                    <span class="c1"># Note: there is currently a bug where removing or adding an alpha</span>
                    <span class="c1"># channel from a color will break the rendering pipeline</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">color</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                        <span class="n">new_c</span> <span class="o">=</span> <span class="n">gfx</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="n">cmap</span><span class="p">[</span><span class="n">n</span><span class="p">])</span><span class="o">.</span><span class="n">rgba</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">new_c</span> <span class="o">=</span> <span class="n">gfx</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="n">cmap</span><span class="p">[</span><span class="n">n</span><span class="p">])</span><span class="o">.</span><span class="n">rgb</span>
                    <span class="n">v</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">gfx</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="n">new_c</span><span class="p">)</span>

                    <span class="c1"># Determine if we consider this transparent</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_c</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span> <span class="ow">and</span> <span class="n">new_c</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">is_transparent</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">elif</span> <span class="n">v</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">opacity</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">is_transparent</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">is_transparent</span> <span class="o">=</span> <span class="kc">False</span>

                    <span class="k">if</span> <span class="n">alpha_mode</span> <span class="o">==</span> <span class="s2">"auto"</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">is_transparent</span><span class="p">:</span>
                            <span class="n">v</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">alpha_mode</span> <span class="o">=</span> <span class="s2">"add"</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">v</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">alpha_mode</span> <span class="o">=</span> <span class="s2">"solid"</span>
                    <span class="k">elif</span> <span class="n">alpha_mode</span><span class="p">:</span>
                        <span class="n">v</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">alpha_mode</span> <span class="o">=</span> <span class="n">alpha_mode</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">colorize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s2">"seaborn:tab10"</span><span class="p">,</span> <span class="n">objects</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">randomize</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Colorize objects using a color palette.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        palette :   str | cmap Colormap</span>
<span class="sd">                    Name of the `cmap` palette to use. See</span>
<span class="sd">                    https://cmap-docs.readthedocs.io/en/latest/catalog/#colormaps-by-category</span>
<span class="sd">                    for available options.</span>
<span class="sd">        objects :   list, optional</span>
<span class="sd">                    Objects to colorize. If None, will colorize all objects.</span>
<span class="sd">        randomize : bool</span>
<span class="sd">                    If True (default), will randomly shuffle the colors.</span>

<span class="sd">        """</span>
        <span class="k">if</span> <span class="n">objects</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span>  <span class="c1"># grab once to speed things up</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">palette</span><span class="p">,</span> <span class="n">cmap</span><span class="o">.</span><span class="n">_colormap</span><span class="o">.</span><span class="n">Colormap</span><span class="p">):</span>
            <span class="n">palette</span> <span class="o">=</span> <span class="n">cmap</span><span class="o">.</span><span class="n">Colormap</span><span class="p">(</span><span class="n">palette</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">randomize</span><span class="p">:</span>
            <span class="c1"># Note: can't use numpy here because it claims array is not 1d</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">palette</span><span class="o">.</span><span class="n">iter_colors</span><span class="p">()),</span> <span class="n">k</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">objects</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">palette</span><span class="o">.</span><span class="n">iter_colors</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">objects</span><span class="p">)))</span>

        <span class="n">colormap</span> <span class="o">=</span> <span class="p">{</span><span class="n">s</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">rgba</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">objects</span><span class="p">)}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_colors</span><span class="p">(</span><span class="n">colormap</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_bgcolor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Set background color.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        c :     tuple | str</span>
<span class="sd">                RGB(A) color to use for the background.</span>

<span class="sd">        """</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_background</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">set_colors</span><span class="p">(</span><span class="n">gfx</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">rgba</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_toggle_fps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Switch FPS measurement on and off."""</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show_fps</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_fps</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">screenshot</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s2">"screenshot.png"</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pixel_ratio</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">"""Save a screenshot of the canvas.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        filename :      str | pathlib.Path, optional</span>
<span class="sd">                        Filename to save to. If ``None``, will return image array.</span>
<span class="sd">                        Note that this will always save a PNG file, no matter</span>
<span class="sd">                        the extension.</span>
<span class="sd">        size :          tuple, optional</span>
<span class="sd">                        Size of the screenshot. If provided, will temporarily</span>
<span class="sd">                        change the canvas size.</span>
<span class="sd">        pixel_ratio :   int, optional</span>
<span class="sd">                        Factor by which to scale canvas. Determines image</span>
<span class="sd">                        dimensions. Note that this seems to have no effect</span>
<span class="sd">                        on offscreen canvases.</span>
<span class="sd">        alpha :         bool, optional</span>
<span class="sd">                        If True, will export transparent background.</span>

<span class="sd">        """</span>
        <span class="n">im</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_screenshot</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">pixel_ratio</span><span class="o">=</span><span class="n">pixel_ratio</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">filename</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">suffix</span> <span class="o">!=</span> <span class="s2">".png"</span><span class="p">:</span>
                <span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">filename</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">.png"</span>
            <span class="n">png</span><span class="o">.</span><span class="n">from_array</span><span class="p">(</span>
                <span class="n">im</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">im</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">im</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">im</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="n">mode</span><span class="o">=</span><span class="s2">"RGBA"</span>
            <span class="p">)</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">filename</span><span class="o">.</span><span class="n">resolve</span><span class="p">()))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">im</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_screenshot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pixel_ratio</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Return image array for screenshot."""</span>
        <span class="k">if</span> <span class="n">alpha</span><span class="p">:</span>
            <span class="n">vis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_background</span><span class="o">.</span><span class="n">visible</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_background</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">size</span><span class="p">:</span>
            <span class="n">os</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">size</span>
        <span class="k">if</span> <span class="n">pixel_ratio</span><span class="p">:</span>
            <span class="n">opr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">renderer</span><span class="o">.</span><span class="n">pixel_ratio</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">renderer</span><span class="o">.</span><span class="n">pixel_ratio</span> <span class="o">=</span> <span class="n">pixel_ratio</span>

        <span class="c1"># If this is an offscreen canvas, we need to manually trigger a draw first</span>
        <span class="c1"># Note: this has to happen _after_ adjust parameters!</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">,</span> <span class="n">OffscreenRenderCanvas</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># This is a bit of a hack to make sure a new frame with the (potentially)</span>
            <span class="c1"># updated size, pixel ratio, etc. is drawn before taking the screenshot.</span>
            <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s2">"ignore"</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">_subwidget</span><span class="o">.</span><span class="n">_draw_frame_and_present</span><span class="p">()</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">im</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">renderer</span><span class="o">.</span><span class="n">snapshot</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">BaseException</span><span class="p">:</span>
            <span class="k">raise</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">alpha</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_background</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="n">vis</span>
            <span class="k">if</span> <span class="n">size</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">os</span>
            <span class="k">if</span> <span class="n">pixel_ratio</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">renderer</span><span class="o">.</span><span class="n">pixel_ratio</span> <span class="o">=</span> <span class="n">opr</span>

        <span class="k">return</span> <span class="n">im</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_view</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">view</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""(Re-)set camera position.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        view :      XY | XZ | YZ | dict</span>
<span class="sd">                    View to set. Can be inverted to e.g. "-XY" to show view from back.</span>
<span class="sd">                    If a dictionary, should describe the state of the camera. Typically,</span>
<span class="sd">                    this is obtained by calling `viewer.get_view()`.</span>

<span class="sd">        """</span>
        <span class="k">if</span> <span class="n">view</span> <span class="o">==</span> <span class="s2">"XY"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">show_object</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">,</span> <span class="n">view_dir</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="n">up</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">view</span> <span class="o">==</span> <span class="s2">"-XY"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">show_object</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">,</span> <span class="n">view_dir</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">),</span> <span class="n">up</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">view</span> <span class="o">==</span> <span class="s2">"XZ"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">show_object</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">view_dir</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="n">up</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">view</span> <span class="o">==</span> <span class="s2">"-XZ"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">show_object</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">view_dir</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="n">up</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">view</span> <span class="o">==</span> <span class="s2">"YZ"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">show_object</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">view_dir</span><span class="o">=</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="n">up</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">view</span> <span class="o">==</span> <span class="s2">"YZ"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">show_object</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">view_dir</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="n">up</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">view</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="n">view</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Unable to set view from </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">view</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_view</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Get current camera position."""</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">get_state</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">bind_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">modifiers</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Bind a function to a key press.</span>

<span class="sd">        Note that any existing keybindings for `key` + `modifiers` will be</span>
<span class="sd">        silently overwritten.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key :       str</span>
<span class="sd">                    Key to bind to. Can be any key on the keyboard.</span>
<span class="sd">        func :      callable</span>
<span class="sd">                    Function to call when key is pressed.</span>
<span class="sd">        modifiers : str | list thereof, optional</span>
<span class="sd">                    Modifier(s) to use with the key. Can be "Shift", "Control",</span>
<span class="sd">                    "Alt" or "Meta".</span>

<span class="sd">        """</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">callable</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">"`func` needs to be callable"</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Expected `key` to be a string, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">modifiers</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_key_events</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># We need to make `modifiers` is hashable</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">modifiers</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">modifiers</span> <span class="o">=</span> <span class="p">(</span><span class="n">modifiers</span><span class="p">,)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">modifiers</span><span class="p">,</span> <span class="p">(</span><span class="nb">set</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
                <span class="n">modifiers</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">modifiers</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">modifiers</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">"Unexpected datatype for `modifiers`: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">modifiers</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span>
                <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_key_events</span><span class="p">[(</span><span class="n">key</span><span class="p">,</span> <span class="n">modifiers</span><span class="p">)]</span> <span class="o">=</span> <span class="n">func</span>
</code></pre></div></td></tr></tbody></table></div> </details> <div class="doc doc-children"> <div class="doc doc-object doc-attribute"> <h3 id="octarine.Viewer.blend_mode" class="doc doc-heading"> <code class="highlight language-python"><span class="n">blend_mode</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href="#octarine.Viewer.blend_mode" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <p>Deprecated! Render blend mode.</p> <p>This property has been deprecated. Please use <code>Viewer.set_alpha_mode()</code> instead.</p> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id="octarine.Viewer.bounds" class="doc doc-heading"> <code class="highlight language-python"><span class="n">bounds</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href="#octarine.Viewer.bounds" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <p>Bounds of all currently visuals (visible and invisible).</p> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id="octarine.Viewer.controls" class="doc doc-heading"> <code class="highlight language-python"><span class="n">controls</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href="#octarine.Viewer.controls" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <p>Return the controls widget.</p> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id="octarine.Viewer.highlighted" class="doc doc-heading"> <code class="highlight language-python"><span class="n">highlighted</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href="#octarine.Viewer.highlighted" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <p>Return IDs of currently highlighted objects.</p> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id="octarine.Viewer.invisible" class="doc doc-heading"> <code class="highlight language-python"><span class="n">invisible</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href="#octarine.Viewer.invisible" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <p>List IDs of currently visible objects.</p> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id="octarine.Viewer.max_fps" class="doc doc-heading"> <code class="highlight language-python"><span class="n">max_fps</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> <small class="doc doc-label doc-label-writable"><code>writable</code></small> </span> <a href="#octarine.Viewer.max_fps" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <p>Maximum frames per second to render.</p> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id="octarine.Viewer.moveable_object" class="doc doc-heading"> <code class="highlight language-python"><span class="n">moveable_object</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> <small class="doc doc-label doc-label-writable"><code>writable</code></small> </span> <a href="#octarine.Viewer.moveable_object" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <p>Get/Set the object that can be moved via the transform gizmo.</p> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id="octarine.Viewer.on_double_click" class="doc doc-heading"> <code class="highlight language-python"><span class="n">on_double_click</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> <small class="doc doc-label doc-label-writable"><code>writable</code></small> </span> <a href="#octarine.Viewer.on_double_click" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <p>Determines what to do when double clicking on objects.</p> <p>Can be set to: - <code>None</code>: do nothing - "hide": hide object - "remove": remove object - "select": select object</p> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id="octarine.Viewer.on_hover" class="doc doc-heading"> <code class="highlight language-python"><span class="n">on_hover</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> <small class="doc doc-label doc-label-writable"><code>writable</code></small> </span> <a href="#octarine.Viewer.on_hover" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <p>Determines what to do when hovering over objects.</p> <p>Can be set to: - <code>None</code>: do nothing - "highlight": hide object</p> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id="octarine.Viewer.pinned" class="doc doc-heading"> <code class="highlight language-python"><span class="n">pinned</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href="#octarine.Viewer.pinned" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <p>List IDs of currently pinned objects.</p> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id="octarine.Viewer.render_trigger" class="doc doc-heading"> <code class="highlight language-python"><span class="n">render_trigger</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> <small class="doc doc-label doc-label-writable"><code>writable</code></small> </span> <a href="#octarine.Viewer.render_trigger" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <p>Determines when the scene is (re)rendered.</p> <p>By default, we leave it to the renderer to decide when to render the scene. You can adjust that behaviour by setting render mode to: - "continuous" (default): leave it to the renderer to decide when to render the scene - "reactive": rendering is only triggered when the scene changes - "active_window": rendering is only done when the window is active; this currently only works with the PySide backend</p> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id="octarine.Viewer.selected" class="doc doc-heading"> <code class="highlight language-python"><span class="n">selected</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> <small class="doc doc-label doc-label-writable"><code>writable</code></small> </span> <a href="#octarine.Viewer.selected" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <p>Return IDs of or set selected objects.</p> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id="octarine.Viewer.shadows" class="doc doc-heading"> <code class="highlight language-python"><span class="n">shadows</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> <small class="doc doc-label doc-label-writable"><code>writable</code></small> </span> <a href="#octarine.Viewer.shadows" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <p>Return shadow state.</p> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id="octarine.Viewer.show_bounds" class="doc doc-heading"> <code class="highlight language-python"><span class="n">show_bounds</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> <small class="doc doc-label doc-label-writable"><code>writable</code></small> </span> <a href="#octarine.Viewer.show_bounds" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <p>Set to <code>True</code> to show bounding box.</p> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id="octarine.Viewer.show_fps" class="doc doc-heading"> <code class="highlight language-python"><span class="n">show_fps</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> <small class="doc doc-label doc-label-writable"><code>writable</code></small> </span> <a href="#octarine.Viewer.show_fps" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <p>Show frames per second.</p> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id="octarine.Viewer.size" class="doc doc-heading"> <code class="highlight language-python"><span class="n">size</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> <small class="doc doc-label doc-label-writable"><code>writable</code></small> </span> <a href="#octarine.Viewer.size" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <p>Return size of the canvas.</p> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id="octarine.Viewer.visible" class="doc doc-heading"> <code class="highlight language-python"><span class="n">visible</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href="#octarine.Viewer.visible" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <p>List IDs of currently visible objects.</p> </div> </div> <div class="doc doc-object doc-attribute"> <h3 id="octarine.Viewer.visuals" class="doc doc-heading"> <code class="highlight language-python"><span class="n">visuals</span></code> <span class="doc doc-labels"> <small class="doc doc-label doc-label-property"><code>property</code></small> </span> <a href="#octarine.Viewer.visuals" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <p>List of all visuals on this canvas.</p> </div> </div> <div class="doc doc-object doc-function"> <h3 id="octarine.Viewer.__init__" class="doc doc-heading"> <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">offscreen</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">'Octarine Viewer'</span><span class="p">,</span> <span class="n">max_fps</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">camera</span><span class="o">=</span><span class="s1">'ortho'</span><span class="p">,</span> <span class="n">control</span><span class="o">=</span><span class="s1">'trackball'</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code> <a href="#octarine.Viewer.__init__" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <details class="quote"> <summary>Source code in <code>octarine/viewer.py</code></summary> <div class="highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">offscreen</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">"Octarine Viewer"</span><span class="p">,</span>
    <span class="n">max_fps</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
    <span class="n">camera</span><span class="o">=</span><span class="s2">"ortho"</span><span class="p">,</span>
    <span class="n">control</span><span class="o">=</span><span class="s2">"trackball"</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
    <span class="c1"># We need to import WgpuCanvas before we (potentially) start the event loop</span>
    <span class="c1"># If we don't we get a segfault.</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">offscreen</span><span class="p">:</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">rendercanvas.auto</span><span class="w"> </span><span class="kn">import</span> <span class="n">RenderCanvas</span>

    <span class="c1"># Check if we're running in an IPython environment</span>
    <span class="k">if</span> <span class="n">utils</span><span class="o">.</span><span class="n">_type_of_script</span><span class="p">()</span> <span class="o">==</span> <span class="s2">"ipython"</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">offscreen</span><span class="p">:</span>
        <span class="n">ip</span> <span class="o">=</span> <span class="n">get_ipython</span><span class="p">()</span>  <span class="c1"># noqa: F821</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ip</span><span class="o">.</span><span class="n">active_eventloop</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">AUTOSTART_EVENT_LOOP</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">ip</span><span class="o">.</span><span class="n">enable_gui</span><span class="p">(</span><span class="s2">"qt6"</span><span class="p">)</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                        <span class="s2">"Looks like you're running in an IPython environment but haven't "</span>
                        <span class="s2">"started a GUI event loop. We've started one for you using the "</span>
                        <span class="s2">"Qt6 backend."</span>
                    <span class="p">)</span>
                <span class="k">except</span> <span class="p">(</span><span class="ne">ModuleNotFoundError</span><span class="p">,</span> <span class="ne">ImportError</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="s2">"Looks like you're running in an IPython environment but haven't "</span>
                        <span class="s2">"started a GUI event loop. We tried to start one for you using the "</span>
                        <span class="s2">"Qt6 backend (via </span><span class="si">%g</span><span class="s2">ui qt6) but that failed. You may have to start "</span>
                        <span class="s2">"the event loop manually. See "</span>
                        <span class="s2">"https://ipython.readthedocs.io/en/stable/config/eventloops.html"</span>
                        <span class="s2">"for details."</span>
                    <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s1">'IPython event loop not running. Please use e.g. "</span><span class="si">%g</span><span class="s1">ui qt6" to hook into the event loop.'</span>
                <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_title</span> <span class="o">=</span> <span class="n">title</span>

    <span class="c1"># Update some defaults as necessary</span>
    <span class="n">defaults</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"title"</span><span class="p">:</span> <span class="n">title</span><span class="p">,</span> <span class="s2">"max_fps"</span><span class="p">:</span> <span class="n">max_fps</span><span class="p">}</span>
    <span class="k">if</span> <span class="n">size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">defaults</span><span class="p">[</span><span class="s2">"size"</span><span class="p">]</span> <span class="o">=</span> <span class="n">size</span>
    <span class="n">defaults</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="c1"># If we're running in headless mode (primarily for tests on CI) we will</span>
    <span class="c1"># simply not initialize the gfx objects. Not ideal but it turns</span>
    <span class="c1"># out to be very annoying to correctly setup on Github Actions.</span>
    <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="s2">"HEADLESS"</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">offscreen</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="n">RenderCanvas</span><span class="p">(</span><span class="o">**</span><span class="n">defaults</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="n">OffscreenRenderCanvas</span><span class="p">(</span><span class="o">**</span><span class="n">defaults</span><span class="p">)</span>

    <span class="c1"># There is a bug in pygfx 0.1.18 that causes the renderer to crash</span>
    <span class="c1"># when using a Jupyter canvas without explicitly setting the pixel_ratio.</span>
    <span class="c1"># This is already fixed in main but for now:</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_jupyter</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">renderer</span> <span class="o">=</span> <span class="n">gfx</span><span class="o">.</span><span class="n">renderers</span><span class="o">.</span><span class="n">WgpuRenderer</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">,</span> <span class="n">show_fps</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">pixel_ratio</span><span class="o">=</span><span class="mi">2</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">renderer</span> <span class="o">=</span> <span class="n">gfx</span><span class="o">.</span><span class="n">renderers</span><span class="o">.</span><span class="n">WgpuRenderer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">,</span> <span class="n">show_fps</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Set up a default scene</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">scene</span> <span class="o">=</span> <span class="n">gfx</span><span class="o">.</span><span class="n">Scene</span><span class="p">()</span>

    <span class="c1"># A minor ambient light</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">gfx</span><span class="o">.</span><span class="n">AmbientLight</span><span class="p">(</span><span class="n">intensity</span><span class="o">=</span><span class="mf">0.5</span><span class="p">))</span>

    <span class="c1"># A strong point light form front/top/left</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">gfx</span><span class="o">.</span><span class="n">PointLight</span><span class="p">(</span><span class="n">intensity</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shadow</span><span class="o">.</span><span class="n">bias</span> <span class="o">=</span> <span class="mf">0.0000005</span>  <span class="c1"># this helps with shadow acne</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">local</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1000000</span>  <span class="c1"># move to the left</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">local</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1000000</span>  <span class="c1"># move up</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">local</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1000000</span>  <span class="c1"># move light forward</span>

    <span class="c1"># A weaker point light from the back</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">gfx</span><span class="o">.</span><span class="n">PointLight</span><span class="p">(</span><span class="n">intensity</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shadow</span><span class="o">.</span><span class="n">bias</span> <span class="o">=</span> <span class="mf">0.0000005</span>  <span class="c1"># this helps with shadow acne</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">local</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">1000000</span>  <span class="c1"># move to the left</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">local</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="mi">1000000</span>  <span class="c1"># move up</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">local</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="mi">1000000</span>  <span class="c1"># move light forward</span>

    <span class="c1"># Set up a default background</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_background</span> <span class="o">=</span> <span class="n">gfx</span><span class="o">.</span><span class="n">Background</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">gfx</span><span class="o">.</span><span class="n">BackgroundMaterial</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_background</span><span class="p">)</span>

    <span class="c1"># Add camera</span>
    <span class="k">if</span> <span class="n">camera</span> <span class="o">==</span> <span class="s2">"ortho"</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">camera</span> <span class="o">=</span> <span class="n">gfx</span><span class="o">.</span><span class="n">OrthographicCamera</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">camera</span> <span class="o">==</span> <span class="s2">"perspective"</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">camera</span> <span class="o">=</span> <span class="n">gfx</span><span class="o">.</span><span class="n">PerspectiveCamera</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Unknown camera type: </span><span class="si">{</span><span class="n">camera</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

    <span class="c1"># Add controller</span>
    <span class="n">controller</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">"trackball"</span><span class="p">:</span> <span class="n">gfx</span><span class="o">.</span><span class="n">TrackballController</span><span class="p">,</span>
        <span class="s2">"panzoom"</span><span class="p">:</span> <span class="n">gfx</span><span class="o">.</span><span class="n">PanZoomController</span><span class="p">,</span>
        <span class="s2">"fly"</span><span class="p">:</span> <span class="n">gfx</span><span class="o">.</span><span class="n">FlyController</span><span class="p">,</span>
        <span class="s2">"orbit"</span><span class="p">:</span> <span class="n">gfx</span><span class="o">.</span><span class="n">OrbitController</span><span class="p">,</span>
    <span class="p">}</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">control</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">controller</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Unknown controller type: </span><span class="si">{</span><span class="n">control</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">controller</span> <span class="o">=</span> <span class="n">controller</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="p">,</span> <span class="n">register_events</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">renderer</span><span class="p">)</span>

    <span class="c1"># Setup overlay</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">overlay_camera</span> <span class="o">=</span> <span class="n">gfx</span><span class="o">.</span><span class="n">NDCCamera</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">overlay_scene</span> <span class="o">=</span> <span class="n">gfx</span><span class="o">.</span><span class="n">Scene</span><span class="p">()</span>

    <span class="c1"># Setup transform gizmo</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">transform_gizmo</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># Stats</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">stats</span> <span class="o">=</span> <span class="n">gfx</span><span class="o">.</span><span class="n">Stats</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">renderer</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_show_fps</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="c1"># Setup key events</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_key_events</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_key_events</span><span class="p">[</span><span class="s2">"1"</span><span class="p">]</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_view</span><span class="p">(</span><span class="s2">"XY"</span><span class="p">)</span>  <span class="c1"># frontal view</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_key_events</span><span class="p">[</span><span class="s2">"2"</span><span class="p">]</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_view</span><span class="p">(</span><span class="s2">"XZ"</span><span class="p">)</span>  <span class="c1"># lateral view</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_key_events</span><span class="p">[</span><span class="s2">"3"</span><span class="p">]</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_view</span><span class="p">(</span><span class="s2">"YZ"</span><span class="p">)</span>  <span class="c1"># top view</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_key_events</span><span class="p">[(</span><span class="s2">"1"</span><span class="p">,</span> <span class="p">(</span><span class="s2">"Shift"</span><span class="p">,))]</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_view</span><span class="p">(</span><span class="s2">"-XY"</span><span class="p">)</span>  <span class="c1"># back view</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_key_events</span><span class="p">[(</span><span class="s2">"2"</span><span class="p">,</span> <span class="p">(</span><span class="s2">"Shift"</span><span class="p">,))]</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_view</span><span class="p">(</span>
        <span class="s2">"-XZ"</span>
    <span class="p">)</span>  <span class="c1"># other lateral view</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_key_events</span><span class="p">[(</span><span class="s2">"3"</span><span class="p">,</span> <span class="p">(</span><span class="s2">"Shift"</span><span class="p">,))]</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">set_view</span><span class="p">(</span>
        <span class="s2">"-YZ"</span>
    <span class="p">)</span>  <span class="c1"># bottom view</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_key_events</span><span class="p">[</span><span class="s2">"f"</span><span class="p">]</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_toggle_fps</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_key_events</span><span class="p">[</span><span class="s2">"c"</span><span class="p">]</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_toggle_controls</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_keydown</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Handle key presses."""</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">event</span><span class="o">.</span><span class="n">modifiers</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_key_events</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_key_events</span><span class="p">[</span><span class="n">event</span><span class="o">.</span><span class="n">key</span><span class="p">]()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tup</span> <span class="o">=</span> <span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">key</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">modifiers</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">tup</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_key_events</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_key_events</span><span class="p">[</span><span class="n">tup</span><span class="p">]()</span>

    <span class="c1"># Register events</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">renderer</span><span class="o">.</span><span class="n">add_event_handler</span><span class="p">(</span><span class="n">_keydown</span><span class="p">,</span> <span class="s2">"key_down"</span><span class="p">)</span>

    <span class="c1"># Finally, setting some variables</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_show_bounds</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_shadows</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_animations</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_animations_flagged_for_removal</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_animations_frame_counter</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_on_double_click</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_on_hover</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_objects_pickable</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_selected</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_render_trigger</span> <span class="o">=</span> <span class="s2">"continuous"</span>

    <span class="n">viewers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="c1"># This starts the animation loop</span>
    <span class="k">if</span> <span class="n">show</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_jupyter</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">start_loop</span><span class="o">=</span><span class="n">show</span> <span class="o">==</span> <span class="s2">"start_loop"</span><span class="p">)</span>
</code></pre></div></td></tr></tbody></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id="octarine.Viewer.add" class="doc doc-heading"> <code class="highlight language-python"><span class="n">add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">clear</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code> <a href="#octarine.Viewer.add" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <p>Add object to canvas.</p> <p>This function is a general entry point for adding objects to the canvas. It will look at the type of the input and try to find an appropriate function to convert the input to visuals.</p> <p>Use <code>octarine.register_converter</code> to add custom converters.</p> <table> <thead> <tr> <th><span class="doc-section-title">PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class="doc-section-item"> <td> <code>x</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    Object(s) to add to the canvas.
</code></pre></div> </div> <p> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>name</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    Name for the visual(s).
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> str</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>center</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    If True, re-center camera to all objects on canvas.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> bool</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>True</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>clear</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    If True, clear canvas before adding new objects.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> bool</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>False</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>**kwargs</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    Keyword arguments passed to the conversion functions when
    generating visuals.
</code></pre></div> </div> <p> <span class="doc-param-default"> <b>DEFAULT:</b> <code>{}</code> </span> </p> </td> </tr> </tbody> </table> <table> <thead> <tr> <th><span class="doc-section-title">RETURNS</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class="doc-section-item"> <td> <span class="doc-returns-annotation"> <code>None</code> </span> </td> <td class="doc-returns-details"> <div class="doc-md-description"> </div> </td> </tr> </tbody> </table> <details class="quote"> <summary>Source code in <code>octarine/viewer.py</code></summary> <div class="highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@update_viewer</span><span class="p">(</span><span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">clear</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Add object to canvas.</span>

<span class="sd">    This function is a general entry point for adding objects to the canvas.</span>
<span class="sd">    It will look at the type of the input and try to find an appropriate</span>
<span class="sd">    function to convert the input to visuals.</span>

<span class="sd">    Use `octarine.register_converter` to add custom converters.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x</span>
<span class="sd">                Object(s) to add to the canvas.</span>
<span class="sd">    name :      str, optional</span>
<span class="sd">                Name for the visual(s).</span>
<span class="sd">    center :    bool, optional</span>
<span class="sd">                If True, re-center camera to all objects on canvas.</span>
<span class="sd">    clear :     bool, optional</span>
<span class="sd">                If True, clear canvas before adding new objects.</span>
<span class="sd">    **kwargs</span>
<span class="sd">                Keyword arguments passed to the conversion functions when</span>
<span class="sd">                generating visuals.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>

<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">clear</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">utils</span><span class="o">.</span><span class="n">is_iterable</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">xx</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">clear</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">center</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">center_camera</span><span class="p">()</span>
        <span class="k">return</span>

    <span class="n">converter</span> <span class="o">=</span> <span class="n">get_converter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">raise_missing</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">converter</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"No converter found for </span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="s2">)"</span><span class="p">)</span>

    <span class="c1"># Check if we have to provide a color</span>
    <span class="k">if</span> <span class="s2">"color"</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="s2">"color"</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">converter</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span><span class="p">:</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">"color"</span><span class="p">]</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_next_color</span><span class="p">()</span><span class="o">.</span><span class="n">rgba</span><span class="p">)</span>

    <span class="n">visuals</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">make_iterable</span><span class="p">(</span><span class="n">converter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">visuals</span><span class="p">:</span>
        <span class="c1"># If we have a name, assign it to the visual</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">v</span><span class="o">.</span><span class="n">_object_id</span> <span class="o">=</span> <span class="n">name</span>
        <span class="c1"># If not we either use existing ID or generate a new one</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Give visuals an _object_id if they don't already have one</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="s2">"_object_id"</span><span class="p">):</span>
                <span class="n">new_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_label</span><span class="p">(</span><span class="s2">"Object"</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">v2</span> <span class="ow">in</span> <span class="n">visuals</span><span class="p">:</span>
                    <span class="n">v</span><span class="o">.</span><span class="n">_object_id</span> <span class="o">=</span> <span class="n">new_id</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">_object_id</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">v</span><span class="o">.</span><span class="n">_object_id</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">_object_id</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">center</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">center_camera</span><span class="p">()</span>
</code></pre></div></td></tr></tbody></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id="octarine.Viewer.add_animation" class="doc doc-heading"> <code class="highlight language-python"><span class="n">add_animation</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">on_error</span><span class="o">=</span><span class="s1">'remove'</span><span class="p">,</span> <span class="n">run_every</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">req_render</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code> <a href="#octarine.Viewer.add_animation" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <p>Add animation function to the Viewer.</p> <table> <thead> <tr> <th><span class="doc-section-title">PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class="doc-section-item"> <td> <code>x</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    Function to add to the animation loop.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> callable</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>on_error</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    What to do if the function throws an error. If "remove",
    the function will be removed from the animation loop. If
    "ignore", the error will be ignored and the function will
    continue to be called.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> "remove" | "ignore" | "raise"</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>'remove'</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>run_every</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    Use to run the function every n frames.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>req_render</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    Whether this animation requires a re-render of the scene.
    This is mainly a flag to help the viewer to decide
    whether/when to trigger a render. See also the `render_trigger`
    property.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>True</code> </span> </p> </td> </tr> </tbody> </table> <details class="quote"> <summary>Source code in <code>octarine/viewer.py</code></summary> <div class="highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_animation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">on_error</span><span class="o">=</span><span class="s2">"remove"</span><span class="p">,</span> <span class="n">run_every</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">req_render</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Add animation function to the Viewer.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x :         callable</span>
<span class="sd">                Function to add to the animation loop.</span>
<span class="sd">    on_error :  "remove" | "ignore" | "raise"</span>
<span class="sd">                What to do if the function throws an error. If "remove",</span>
<span class="sd">                the function will be removed from the animation loop. If</span>
<span class="sd">                "ignore", the error will be ignored and the function will</span>
<span class="sd">                continue to be called.</span>
<span class="sd">    run_every : int, optional</span>
<span class="sd">                Use to run the function every n frames.</span>
<span class="sd">    req_render : bool, optional</span>
<span class="sd">                Whether this animation requires a re-render of the scene.</span>
<span class="sd">                This is mainly a flag to help the viewer to decide</span>
<span class="sd">                whether/when to trigger a render. See also the `render_trigger`</span>
<span class="sd">                property.</span>

<span class="sd">    """</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">callable</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Expected callable, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">on_error</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">"remove"</span><span class="p">,</span> <span class="s2">"ignore"</span><span class="p">,</span> <span class="s2">"raise"</span><span class="p">]</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_animations</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">on_error</span><span class="p">,</span> <span class="n">run_every</span><span class="p">,</span> <span class="n">req_render</span><span class="p">)</span>
</code></pre></div></td></tr></tbody></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id="octarine.Viewer.add_effect" class="doc doc-heading"> <code class="highlight language-python"><span class="n">add_effect</span><span class="p">(</span><span class="n">effect</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code> <a href="#octarine.Viewer.add_effect" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <p>Add post-processing effect to the renderer.</p> <p>You can also use this method to adjust the parameters of an existing effect.</p> <table> <thead> <tr> <th><span class="doc-section-title">PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class="doc-section-item"> <td> <code>effect</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    Name of the effect to add. Currently supported:
     - "edl" (Eye-Dome Lighting)
       This effect enhances depth perception for complex
       geometries by darkening edges based on depth differences.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> str</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>**kwargs</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    Keyword arguments passed to the effect constructor:
    - edl:
      - strength (default 5): EDL strength; ypical range ~ [0.5, 10.0].
      - radius (default 1.5): sampling radius in pixels
      - depth_edge_threshold (default 0.0)
</code></pre></div> </div> <p> <span class="doc-param-default"> <b>DEFAULT:</b> <code>{}</code> </span> </p> </td> </tr> </tbody> </table> <details class="quote"> <summary>Source code in <code>octarine/viewer.py</code></summary> <div class="highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_effect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">effect</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Add post-processing effect to the renderer.</span>

<span class="sd">    You can also use this method to adjust the parameters of an existing effect.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    effect :   str</span>
<span class="sd">                Name of the effect to add. Currently supported:</span>
<span class="sd">                 - "edl" (Eye-Dome Lighting)</span>
<span class="sd">                   This effect enhances depth perception for complex</span>
<span class="sd">                   geometries by darkening edges based on depth differences.</span>

<span class="sd">    **kwargs</span>
<span class="sd">                Keyword arguments passed to the effect constructor:</span>
<span class="sd">                - edl:</span>
<span class="sd">                  - strength (default 5): EDL strength; ypical range ~ [0.5, 10.0].</span>
<span class="sd">                  - radius (default 1.5): sampling radius in pixels</span>
<span class="sd">                  - depth_edge_threshold (default 0.0)</span>

<span class="sd">    """</span>
    <span class="n">effect</span> <span class="o">=</span> <span class="n">EFFECT_CLASSES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">effect</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">effect</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Unknown effect: </span><span class="si">{</span><span class="n">effect</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

    <span class="c1"># Check if we already have this effect</span>
    <span class="n">p</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">renderer</span><span class="o">.</span><span class="n">effect_passes</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">effect</span><span class="p">):</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">e</span>
            <span class="k">break</span>

    <span class="k">if</span> <span class="n">p</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Overwrite the default of 1 (seems too weak in my hands)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">effect</span> <span class="ow">is</span> <span class="n">EDLPass</span><span class="p">)</span> <span class="ow">and</span> <span class="s2">"strength"</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">"strength"</span><span class="p">]</span> <span class="o">=</span> <span class="mf">5.0</span>

        <span class="n">p</span> <span class="o">=</span> <span class="n">effect</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">renderer</span><span class="o">.</span><span class="n">effect_passes</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">renderer</span><span class="o">.</span><span class="n">effect_passes</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="n">p</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Update parameters</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Effect '</span><span class="si">{</span><span class="n">effect</span><span class="si">}</span><span class="s2">' has no parameter '</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">'"</span><span class="p">)</span>
</code></pre></div></td></tr></tbody></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id="octarine.Viewer.add_lines" class="doc doc-heading"> <code class="highlight language-python"><span class="n">add_lines</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">linewidth_space</span><span class="o">=</span><span class="s1">'screen'</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">'solid'</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code> <a href="#octarine.Viewer.add_lines" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <p>Add lines to canvas.</p> <table> <thead> <tr> <th><span class="doc-section-title">PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class="doc-section-item"> <td> <code>lines</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    Lines to plot. If a list of arrays, each array
    represents a separate line. If a single array,
    each row represents a point in the line. You can
    introduce breaks in the line by inserting NaNs.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> list of (N, 3) arrays | (N, 3) array</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>name</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    Name for the visual.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> str</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>color</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    Color to use for plotting. Can be a single color
    or one for every point in the line(s).
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> str | tuple</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>linewidth</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    Line width.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>1</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>linewidth_space</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    Units to use for the line width. "screen" (default)
    will keep the line width constant on the screen, while
    "world" and "model" will keep it constant in world and
    model coordinates, respectively.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><span title="screen">screen</span> | <span title="world">world</span> | <span title="model">model</span></code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>'screen'</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>linestyle</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    Line style to use. If a tuple, must define the on/off
    sequence.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><span title="solid">solid</span> | <span title="dashed">dashed</span> | <span title="dotted">dotted</span> | <span title="dashdot">dashdot</span> | <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a></code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>'solid'</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>center</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    If True, re-center camera to all objects on canvas.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> bool</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>True</code> </span> </p> </td> </tr> </tbody> </table> <details class="quote"> <summary>Source code in <code>octarine/viewer.py</code></summary> <div class="highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_lines</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">lines</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">linewidth_space</span><span class="o">=</span><span class="s2">"screen"</span><span class="p">,</span>
    <span class="n">linestyle</span><span class="o">=</span><span class="s2">"solid"</span><span class="p">,</span>
    <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">"""Add lines to canvas.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    lines :     list of (N, 3) arrays | (N, 3) array</span>
<span class="sd">                Lines to plot. If a list of arrays, each array</span>
<span class="sd">                represents a separate line. If a single array,</span>
<span class="sd">                each row represents a point in the line. You can</span>
<span class="sd">                introduce breaks in the line by inserting NaNs.</span>
<span class="sd">    name :      str, optional</span>
<span class="sd">                Name for the visual.</span>
<span class="sd">    color :     str | tuple, optional</span>
<span class="sd">                Color to use for plotting. Can be a single color</span>
<span class="sd">                or one for every point in the line(s).</span>
<span class="sd">    linewidth : float, optional</span>
<span class="sd">                Line width.</span>
<span class="sd">    linewidth_space : "screen" | "world" | "model", optional</span>
<span class="sd">                Units to use for the line width. "screen" (default)</span>
<span class="sd">                will keep the line width constant on the screen, while</span>
<span class="sd">                "world" and "model" will keep it constant in world and</span>
<span class="sd">                model coordinates, respectively.</span>
<span class="sd">    linestyle : "solid" | "dashed" | "dotted" | "dashdot" | tuple, optional</span>
<span class="sd">                Line style to use. If a tuple, must define the on/off</span>
<span class="sd">                sequence.</span>
<span class="sd">    center :    bool, optional</span>
<span class="sd">                If True, re-center camera to all objects on canvas.</span>

<span class="sd">    """</span>
    <span class="c1"># TODO:</span>
    <span class="c1"># - allow providing a tuple of (positions, edges) for lines</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">lines</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">lines</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Expected (N, 3) array, got </span><span class="si">{</span><span class="n">lines</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">all</span><span class="p">([</span><span class="n">l</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">l</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">]):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">"Expected list of (N, 3) arrays."</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Expected numpy array or list, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_color</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_label</span><span class="p">(</span><span class="s2">"Lines"</span><span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

    <span class="n">visual</span> <span class="o">=</span> <span class="n">lines2gfx</span><span class="p">(</span>
        <span class="n">lines</span><span class="p">,</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span>
        <span class="n">linewidth_space</span><span class="o">=</span><span class="n">linewidth_space</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
        <span class="n">dash_pattern</span><span class="o">=</span><span class="n">linestyle</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">visual</span><span class="o">.</span><span class="n">_object_id</span> <span class="o">=</span> <span class="n">name</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_add_to_scene</span><span class="p">(</span><span class="n">visual</span><span class="p">,</span> <span class="n">center</span><span class="p">)</span>
</code></pre></div></td></tr></tbody></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id="octarine.Viewer.add_mesh" class="doc doc-heading"> <code class="highlight language-python"><span class="n">add_mesh</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code> <a href="#octarine.Viewer.add_mesh" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <p>Add mesh to canvas.</p> <table> <thead> <tr> <th><span class="doc-section-title">PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class="doc-section-item"> <td> <code>mesh</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    Mesh to plot. If this is a pygfx.Mesh, it will be added
    directly to the scene without modification (i.e. `color`,
    `alpha`, etc. will be ignored).
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> Mesh-like</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>name</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    Name for the visual.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> str</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>color</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    Color to use for plotting. If multiple colors,
    must be a list of colors with the same length as
    the number of faces or vertices.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> str | tuple</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>alpha</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    Opacity value [0-1]. If provided, will override
    the alpha channel of the color.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> float</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>center</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    If True, re-center camera to all objects on canvas.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> bool</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>True</code> </span> </p> </td> </tr> </tbody> </table> <details class="quote"> <summary>Source code in <code>octarine/viewer.py</code></summary> <div class="highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_mesh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mesh</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Add mesh to canvas.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mesh :      Mesh-like</span>
<span class="sd">                Mesh to plot. If this is a pygfx.Mesh, it will be added</span>
<span class="sd">                directly to the scene without modification (i.e. `color`,</span>
<span class="sd">                `alpha`, etc. will be ignored).</span>
<span class="sd">    name :      str, optional</span>
<span class="sd">                Name for the visual.</span>
<span class="sd">    color :     str | tuple, optional</span>
<span class="sd">                Color to use for plotting. If multiple colors,</span>
<span class="sd">                must be a list of colors with the same length as</span>
<span class="sd">                the number of faces or vertices.</span>
<span class="sd">    alpha :     float, optional</span>
<span class="sd">                Opacity value [0-1]. If provided, will override</span>
<span class="sd">                the alpha channel of the color.</span>
<span class="sd">    center :    bool, optional</span>
<span class="sd">                If True, re-center camera to all objects on canvas.</span>

<span class="sd">    """</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">tm</span><span class="o">.</span><span class="n">Scene</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">ob</span> <span class="ow">in</span> <span class="n">mesh</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">ob</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">utils</span><span class="o">.</span><span class="n">is_mesh_like</span><span class="p">(</span><span class="n">mesh</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Expected mesh-like object, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">mesh</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_color</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_label</span><span class="p">(</span><span class="s2">"Mesh"</span><span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">gfx</span><span class="o">.</span><span class="n">Mesh</span><span class="p">):</span>
        <span class="n">visual</span> <span class="o">=</span> <span class="n">mesh2gfx</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">visual</span> <span class="o">=</span> <span class="n">mesh</span>

    <span class="n">visual</span><span class="o">.</span><span class="n">_object_id</span> <span class="o">=</span> <span class="n">name</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_add_to_scene</span><span class="p">(</span><span class="n">visual</span><span class="p">,</span> <span class="n">center</span><span class="p">)</span>
</code></pre></div></td></tr></tbody></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id="octarine.Viewer.add_points" class="doc doc-heading"> <code class="highlight language-python"><span class="n">add_points</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">size_space</span><span class="o">=</span><span class="s1">'screen'</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code> <a href="#octarine.Viewer.add_points" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <p>Add points plot to canvas.</p> <table> <thead> <tr> <th><span class="doc-section-title">PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class="doc-section-item"> <td> <code>points</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    Points to plot.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> (N, 3) array</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>name</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    Name for the visual.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> str</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>color</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    Color to use for plotting. Can be the name of
    a colormap or a single color.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> str | tuple</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>marker</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    Marker to use for plotting. By default (None), will
    use a point. Other options include e.g. "circle", "ring"
    or "diamond". See `pygfx.MarkerShape` for the definitive
    list of options. Please note that you may have to
    increase the size of the marker to see some of the shapes.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> str</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>size</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    Marker size. Can be a single value or an array of
    sizes for each point.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> int | float</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>2</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>size_space</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    Units to use for the marker size. "screen" (default)
    will keep the line width constant on the screen, while
    "world" and "model" will keep it constant in world and
    model coordinates, respectively. In the latter two cases,
    `size` corresponds to the diameter (not radius) of the
    marker!
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><span title="screen">screen</span> | <span title="world">world</span> | <span title="model">model</span></code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>'screen'</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>center</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    If True, re-center camera to all objects on canvas.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> bool</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>True</code> </span> </p> </td> </tr> </tbody> </table> <details class="quote"> <summary>Source code in <code>octarine/viewer.py</code></summary> <div class="highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_points</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">points</span><span class="p">,</span>
    <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">marker</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">size_space</span><span class="o">=</span><span class="s2">"screen"</span><span class="p">,</span>
    <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">"""Add points plot to canvas.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    points :    (N, 3) array</span>
<span class="sd">                Points to plot.</span>
<span class="sd">    name :      str, optional</span>
<span class="sd">                Name for the visual.</span>
<span class="sd">    color :     str | tuple, optional</span>
<span class="sd">                Color to use for plotting. Can be the name of</span>
<span class="sd">                a colormap or a single color.</span>
<span class="sd">    marker :    str, optional</span>
<span class="sd">                Marker to use for plotting. By default (None), will</span>
<span class="sd">                use a point. Other options include e.g. "circle", "ring"</span>
<span class="sd">                or "diamond". See `pygfx.MarkerShape` for the definitive</span>
<span class="sd">                list of options. Please note that you may have to</span>
<span class="sd">                increase the size of the marker to see some of the shapes.</span>
<span class="sd">    size :      int | float</span>
<span class="sd">                Marker size. Can be a single value or an array of</span>
<span class="sd">                sizes for each point.</span>
<span class="sd">    size_space : "screen" | "world" | "model", optional</span>
<span class="sd">                Units to use for the marker size. "screen" (default)</span>
<span class="sd">                will keep the line width constant on the screen, while</span>
<span class="sd">                "world" and "model" will keep it constant in world and</span>
<span class="sd">                model coordinates, respectively. In the latter two cases,</span>
<span class="sd">                `size` corresponds to the diameter (not radius) of the</span>
<span class="sd">                marker!</span>
<span class="sd">    center :    bool, optional</span>
<span class="sd">                If True, re-center camera to all objects on canvas.</span>

<span class="sd">    """</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Expected numpy array, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">points</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">points</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">points</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Expected (N, 3) array, got </span><span class="si">{</span><span class="n">points</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_color</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_label</span><span class="p">(</span><span class="s2">"Scatter"</span><span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

    <span class="n">visual</span> <span class="o">=</span> <span class="n">points2gfx</span><span class="p">(</span>
        <span class="n">points</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">size_space</span><span class="o">=</span><span class="n">size_space</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span>
    <span class="p">)</span>
    <span class="n">visual</span><span class="o">.</span><span class="n">_object_id</span> <span class="o">=</span> <span class="n">name</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_add_to_scene</span><span class="p">(</span><span class="n">visual</span><span class="p">,</span> <span class="n">center</span><span class="p">)</span>
</code></pre></div></td></tr></tbody></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id="octarine.Viewer.add_volume" class="doc doc-heading"> <code class="highlight language-python"><span class="n">add_volume</span><span class="p">(</span><span class="n">volume</span><span class="p">,</span> <span class="n">spacing</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">clim</span><span class="o">=</span><span class="s1">'data'</span><span class="p">,</span> <span class="nb">slice</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">'linear'</span><span class="p">,</span> <span class="n">hide_zero</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code> <a href="#octarine.Viewer.add_volume" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <p>Add image volume to canvas.</p> <p>Note that the default blend mode for the renderer may cause objects behind or inside the volume to look funny. You can change the blend mode by setting e.g. <code>viewer.blend_mode='additive'</code>.</p> <table> <thead> <tr> <th><span class="doc-section-title">PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class="doc-section-item"> <td> <code>volume</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    Volume to plot.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> (N, M, K) array</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>spacing</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    Spacing between voxels.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> tuple</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>(1, 1, 1)</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>name</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    Name for the visual.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> str</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>color</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    Colormap to render the volume. This can be:
      - name of a colormap (e.g. "viridis" or "magma")
      - a single color (name, hex, rgb, rgba)
      - a list of colors
      - a 1D pygfx.Texture
    Note that single colors typically don't look good and
    it's better to define at least two colors. For example,
    instead of "red" use ["red", "yellow"]. If `None` will
    use one of the built-in pygfx colormaps.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> color | list of colors | pygfx.Texture</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>opacity</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    Overall opacity of the volume. Must be between 0 and 1.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> float</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>1.0</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>offset</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    (x, y, z) offset for the volume. If None, will use (0, 0, 0).
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> tuple</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>(0, 0, 0)</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>clim</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    The contrast limits to scale the data values with.
      - "data" (default) will use the min/max of the data
      - "datatype" will use (0, theoretical max of data type)
        for integer data, e.g. (0, 255) for int8 and uint8,
        and (0, 1) for float data assuming the data has been
        normalized
      - tuple of min/max values or combination of "data" and
        "datatype" strings
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> "data" | "datatype" | tuple</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>'data'</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>slice</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>        Render volume slices instead of the full volume:
        - True: render slices along all three dimensions
        - tuple of bools, e.g. `(True, True, False)`: render slices
          in the respective dimensions
        - tuple of floats, e.g. `(0.5, 0.5, 0.5)`: render slices
          at the respective positions (relative to the volume size)
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> bool | tuple</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>False</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>interpolation</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    Interpolation to use when rendering the volume. "linear"
    (default) looks better but is slower.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><span title="linear">linear</span> | <span title="nearest">nearest</span></code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>'linear'</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>hide_zero</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    If True, will hide voxels with lowest value according to `cmin`.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>True</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>center</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    If True, re-center camera to all objects on canvas.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> bool</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>True</code> </span> </p> </td> </tr> </tbody> </table> <details class="quote"> <summary>Source code in <code>octarine/viewer.py</code></summary> <div class="highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_volume</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">volume</span><span class="p">,</span>
    <span class="n">spacing</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">opacity</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">offset</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">clim</span><span class="o">=</span><span class="s2">"data"</span><span class="p">,</span>
    <span class="nb">slice</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">interpolation</span><span class="o">=</span><span class="s2">"linear"</span><span class="p">,</span>
    <span class="n">hide_zero</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">"""Add image volume to canvas.</span>

<span class="sd">    Note that the default blend mode for the renderer may cause objects</span>
<span class="sd">    behind or inside the volume to look funny. You can change the blend</span>
<span class="sd">    mode by setting e.g. `viewer.blend_mode='additive'`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    volume :    (N, M, K) array</span>
<span class="sd">                Volume to plot.</span>
<span class="sd">    spacing :   tuple</span>
<span class="sd">                Spacing between voxels.</span>
<span class="sd">    name :      str, optional</span>
<span class="sd">                Name for the visual.</span>
<span class="sd">    color :     color | list of colors | pygfx.Texture, optional</span>
<span class="sd">                Colormap to render the volume. This can be:</span>
<span class="sd">                  - name of a colormap (e.g. "viridis" or "magma")</span>
<span class="sd">                  - a single color (name, hex, rgb, rgba)</span>
<span class="sd">                  - a list of colors</span>
<span class="sd">                  - a 1D pygfx.Texture</span>
<span class="sd">                Note that single colors typically don't look good and</span>
<span class="sd">                it's better to define at least two colors. For example,</span>
<span class="sd">                instead of "red" use ["red", "yellow"]. If `None` will</span>
<span class="sd">                use one of the built-in pygfx colormaps.</span>
<span class="sd">    opacity :   float, optional</span>
<span class="sd">                Overall opacity of the volume. Must be between 0 and 1.</span>
<span class="sd">    offset :    tuple, optional</span>
<span class="sd">                (x, y, z) offset for the volume. If None, will use (0, 0, 0).</span>
<span class="sd">    clim :      "data" | "datatype" | tuple, optional</span>
<span class="sd">                The contrast limits to scale the data values with.</span>
<span class="sd">                  - "data" (default) will use the min/max of the data</span>
<span class="sd">                  - "datatype" will use (0, theoretical max of data type)</span>
<span class="sd">                    for integer data, e.g. (0, 255) for int8 and uint8,</span>
<span class="sd">                    and (0, 1) for float data assuming the data has been</span>
<span class="sd">                    normalized</span>
<span class="sd">                  - tuple of min/max values or combination of "data" and</span>
<span class="sd">                    "datatype" strings</span>
<span class="sd">    slice :         bool | tuple, optional</span>
<span class="sd">                    Render volume slices instead of the full volume:</span>
<span class="sd">                    - True: render slices along all three dimensions</span>
<span class="sd">                    - tuple of bools, e.g. `(True, True, False)`: render slices</span>
<span class="sd">                      in the respective dimensions</span>
<span class="sd">                    - tuple of floats, e.g. `(0.5, 0.5, 0.5)`: render slices</span>
<span class="sd">                      at the respective positions (relative to the volume size)</span>
<span class="sd">    interpolation : "linear" | "nearest"</span>
<span class="sd">                Interpolation to use when rendering the volume. "linear"</span>
<span class="sd">                (default) looks better but is slower.</span>
<span class="sd">    hide_zero : bool</span>
<span class="sd">                If True, will hide voxels with lowest value according to `cmin`.</span>
<span class="sd">    center :    bool, optional</span>
<span class="sd">                If True, re-center camera to all objects on canvas.</span>

<span class="sd">    """</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">volume</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Expected numpy array, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">volume</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">volume</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Expected 3D array, got </span><span class="si">{</span><span class="n">volume</span><span class="o">.</span><span class="n">ndim</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_next_label</span><span class="p">(</span><span class="s2">"Volume"</span><span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

    <span class="n">visuals</span> <span class="o">=</span> <span class="n">volume2gfx</span><span class="p">(</span>
        <span class="n">volume</span><span class="p">,</span>
        <span class="n">spacing</span><span class="o">=</span><span class="n">spacing</span><span class="p">,</span>
        <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
        <span class="n">opacity</span><span class="o">=</span><span class="n">opacity</span><span class="p">,</span>
        <span class="n">clim</span><span class="o">=</span><span class="n">clim</span><span class="p">,</span>
        <span class="nb">slice</span><span class="o">=</span><span class="nb">slice</span><span class="p">,</span>
        <span class="n">interpolation</span><span class="o">=</span><span class="n">interpolation</span><span class="p">,</span>
        <span class="n">hide_zero</span><span class="o">=</span><span class="n">hide_zero</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">name</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">vis</span> <span class="ow">in</span> <span class="n">visuals</span><span class="p">:</span>
        <span class="n">vis</span><span class="o">.</span><span class="n">_object_id</span> <span class="o">=</span> <span class="n">name</span> <span class="k">if</span> <span class="n">name</span> <span class="k">else</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_to_scene</span><span class="p">(</span><span class="n">vis</span><span class="p">,</span> <span class="n">center</span><span class="p">)</span>
</code></pre></div></td></tr></tbody></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id="octarine.Viewer.bind_key" class="doc doc-heading"> <code class="highlight language-python"><span class="n">bind_key</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">modifiers</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code> <a href="#octarine.Viewer.bind_key" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <p>Bind a function to a key press.</p> <p>Note that any existing keybindings for <code>key</code> + <code>modifiers</code> will be silently overwritten.</p> <table> <thead> <tr> <th><span class="doc-section-title">PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class="doc-section-item"> <td> <code>key</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    Key to bind to. Can be any key on the keyboard.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> str</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>func</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    Function to call when key is pressed.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> callable</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>modifiers</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    Modifier(s) to use with the key. Can be "Shift", "Control",
    "Alt" or "Meta".
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code>str | list thereof</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> </tbody> </table> <details class="quote"> <summary>Source code in <code>octarine/viewer.py</code></summary> <div class="highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2032</span>
<span class="normal">2033</span>
<span class="normal">2034</span>
<span class="normal">2035</span>
<span class="normal">2036</span>
<span class="normal">2037</span>
<span class="normal">2038</span>
<span class="normal">2039</span>
<span class="normal">2040</span>
<span class="normal">2041</span>
<span class="normal">2042</span>
<span class="normal">2043</span>
<span class="normal">2044</span>
<span class="normal">2045</span>
<span class="normal">2046</span>
<span class="normal">2047</span>
<span class="normal">2048</span>
<span class="normal">2049</span>
<span class="normal">2050</span>
<span class="normal">2051</span>
<span class="normal">2052</span>
<span class="normal">2053</span>
<span class="normal">2054</span>
<span class="normal">2055</span>
<span class="normal">2056</span>
<span class="normal">2057</span>
<span class="normal">2058</span>
<span class="normal">2059</span>
<span class="normal">2060</span>
<span class="normal">2061</span>
<span class="normal">2062</span>
<span class="normal">2063</span>
<span class="normal">2064</span>
<span class="normal">2065</span>
<span class="normal">2066</span>
<span class="normal">2067</span>
<span class="normal">2068</span>
<span class="normal">2069</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">bind_key</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">modifiers</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Bind a function to a key press.</span>

<span class="sd">    Note that any existing keybindings for `key` + `modifiers` will be</span>
<span class="sd">    silently overwritten.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    key :       str</span>
<span class="sd">                Key to bind to. Can be any key on the keyboard.</span>
<span class="sd">    func :      callable</span>
<span class="sd">                Function to call when key is pressed.</span>
<span class="sd">    modifiers : str | list thereof, optional</span>
<span class="sd">                Modifier(s) to use with the key. Can be "Shift", "Control",</span>
<span class="sd">                "Alt" or "Meta".</span>

<span class="sd">    """</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">callable</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">"`func` needs to be callable"</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Expected `key` to be a string, got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">modifiers</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_key_events</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># We need to make `modifiers` is hashable</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">modifiers</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">modifiers</span> <span class="o">=</span> <span class="p">(</span><span class="n">modifiers</span><span class="p">,)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">modifiers</span><span class="p">,</span> <span class="p">(</span><span class="nb">set</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
            <span class="n">modifiers</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">modifiers</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">modifiers</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">"Unexpected datatype for `modifiers`: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">modifiers</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_key_events</span><span class="p">[(</span><span class="n">key</span><span class="p">,</span> <span class="n">modifiers</span><span class="p">)]</span> <span class="o">=</span> <span class="n">func</span>
</code></pre></div></td></tr></tbody></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id="octarine.Viewer.center_camera" class="doc doc-heading"> <code class="highlight language-python"><span class="n">center_camera</span><span class="p">()</span></code> <a href="#octarine.Viewer.center_camera" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <p>Center camera on visuals.</p> <details class="quote"> <summary>Source code in <code>octarine/viewer.py</code></summary> <div class="highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">center_camera</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Center camera on visuals."""</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">show_object</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">view_dir</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="n">up</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
        <span class="p">)</span>
</code></pre></div></td></tr></tbody></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id="octarine.Viewer.clear" class="doc doc-heading"> <code class="highlight language-python"><span class="n">clear</span><span class="p">()</span></code> <a href="#octarine.Viewer.clear" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <p>Clear canvas of objects (expects lights and background).</p> <details class="quote"> <summary>Source code in <code>octarine/viewer.py</code></summary> <div class="highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@update_viewer</span><span class="p">(</span><span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Clear canvas of objects (expects lights and background)."""</span>
    <span class="c1"># Skip if running in headless mode</span>
    <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="s2">"HEADLESS"</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
        <span class="k">return</span>

    <span class="c1"># Remove everything but the lights and backgrounds</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">visuals</span><span class="p">)</span>

    <span class="c1"># Rset the transform gizmo</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">transform_gizmo</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></tbody></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id="octarine.Viewer.close" class="doc doc-heading"> <code class="highlight language-python"><span class="n">close</span><span class="p">()</span></code> <a href="#octarine.Viewer.close" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <p>Close the viewer.</p> <details class="quote"> <summary>Source code in <code>octarine/viewer.py</code></summary> <div class="highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Close the viewer."""</span>
    <span class="c1"># Skip if this is headless mode</span>
    <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="s2">"HEADLESS"</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
        <span class="k">return</span>

    <span class="c1"># Clear first to free all visuals</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

    <span class="c1"># Remove from config if this is the primary viewer</span>
    <span class="k">if</span> <span class="bp">self</span> <span class="o">==</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="s2">"PRIMARY_VIEWER"</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
        <span class="k">del</span> <span class="n">config</span><span class="o">.</span><span class="n">PRIMARY_VIEWER</span>

    <span class="c1"># Close if not already closed</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">get_closed</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">"_controls"</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_controls</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="c1"># Close the Jupyter widget</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">"widget"</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="p">,</span> <span class="s2">"_is_closed"</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">close_viewer</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">viewers</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">pass</span>
</code></pre></div></td></tr></tbody></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id="octarine.Viewer.colorize" class="doc doc-heading"> <code class="highlight language-python"><span class="n">colorize</span><span class="p">(</span><span class="n">palette</span><span class="o">=</span><span class="s1">'seaborn:tab10'</span><span class="p">,</span> <span class="n">objects</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">randomize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code> <a href="#octarine.Viewer.colorize" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <p>Colorize objects using a color palette.</p> <table> <thead> <tr> <th><span class="doc-section-title">PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class="doc-section-item"> <td> <code>palette</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    Name of the `cmap` palette to use. See
    https://cmap-docs.readthedocs.io/en/latest/catalog/#colormaps-by-category
    for available options.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> str | cmap Colormap</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>'seaborn:tab10'</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>objects</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    Objects to colorize. If None, will colorize all objects.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> list</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>randomize</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    If True (default), will randomly shuffle the colors.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>True</code> </span> </p> </td> </tr> </tbody> </table> <details class="quote"> <summary>Source code in <code>octarine/viewer.py</code></summary> <div class="highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1872</span>
<span class="normal">1873</span>
<span class="normal">1874</span>
<span class="normal">1875</span>
<span class="normal">1876</span>
<span class="normal">1877</span>
<span class="normal">1878</span>
<span class="normal">1879</span>
<span class="normal">1880</span>
<span class="normal">1881</span>
<span class="normal">1882</span>
<span class="normal">1883</span>
<span class="normal">1884</span>
<span class="normal">1885</span>
<span class="normal">1886</span>
<span class="normal">1887</span>
<span class="normal">1888</span>
<span class="normal">1889</span>
<span class="normal">1890</span>
<span class="normal">1891</span>
<span class="normal">1892</span>
<span class="normal">1893</span>
<span class="normal">1894</span>
<span class="normal">1895</span>
<span class="normal">1896</span>
<span class="normal">1897</span>
<span class="normal">1898</span>
<span class="normal">1899</span>
<span class="normal">1900</span>
<span class="normal">1901</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">colorize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="s2">"seaborn:tab10"</span><span class="p">,</span> <span class="n">objects</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">randomize</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Colorize objects using a color palette.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    palette :   str | cmap Colormap</span>
<span class="sd">                Name of the `cmap` palette to use. See</span>
<span class="sd">                https://cmap-docs.readthedocs.io/en/latest/catalog/#colormaps-by-category</span>
<span class="sd">                for available options.</span>
<span class="sd">    objects :   list, optional</span>
<span class="sd">                Objects to colorize. If None, will colorize all objects.</span>
<span class="sd">    randomize : bool</span>
<span class="sd">                If True (default), will randomly shuffle the colors.</span>

<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">objects</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span>  <span class="c1"># grab once to speed things up</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">palette</span><span class="p">,</span> <span class="n">cmap</span><span class="o">.</span><span class="n">_colormap</span><span class="o">.</span><span class="n">Colormap</span><span class="p">):</span>
        <span class="n">palette</span> <span class="o">=</span> <span class="n">cmap</span><span class="o">.</span><span class="n">Colormap</span><span class="p">(</span><span class="n">palette</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">randomize</span><span class="p">:</span>
        <span class="c1"># Note: can't use numpy here because it claims array is not 1d</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">palette</span><span class="o">.</span><span class="n">iter_colors</span><span class="p">()),</span> <span class="n">k</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">objects</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">palette</span><span class="o">.</span><span class="n">iter_colors</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">objects</span><span class="p">)))</span>

    <span class="n">colormap</span> <span class="o">=</span> <span class="p">{</span><span class="n">s</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">rgba</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">objects</span><span class="p">)}</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">set_colors</span><span class="p">(</span><span class="n">colormap</span><span class="p">)</span>
</code></pre></div></td></tr></tbody></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id="octarine.Viewer.get_view" class="doc doc-heading"> <code class="highlight language-python"><span class="n">get_view</span><span class="p">()</span></code> <a href="#octarine.Viewer.get_view" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <p>Get current camera position.</p> <details class="quote"> <summary>Source code in <code>octarine/viewer.py</code></summary> <div class="highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2028</span>
<span class="normal">2029</span>
<span class="normal">2030</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_view</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Get current camera position."""</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">get_state</span><span class="p">()</span>
</code></pre></div></td></tr></tbody></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id="octarine.Viewer.hide_controls" class="doc doc-heading"> <code class="highlight language-python"><span class="n">hide_controls</span><span class="p">()</span></code> <a href="#octarine.Viewer.hide_controls" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <p>Hide controls.</p> <details class="quote"> <summary>Source code in <code>octarine/viewer.py</code></summary> <div class="highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">hide_controls</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Hide controls."""</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_jupyter</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">toolbar</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">hide</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">"_controls"</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_controls</span><span class="o">.</span><span class="n">hide</span><span class="p">()</span>
</code></pre></div></td></tr></tbody></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id="octarine.Viewer.hide_objects" class="doc doc-heading"> <code class="highlight language-python"><span class="n">hide_objects</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span></code> <a href="#octarine.Viewer.hide_objects" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <p>Hide given object(s).</p> <table> <thead> <tr> <th><span class="doc-section-title">PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class="doc-section-item"> <td> <code>obj</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>Object(s) to hide.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> str | list</code> </span> </p> </td> </tr> </tbody> </table> <details class="quote"> <summary>Source code in <code>octarine/viewer.py</code></summary> <div class="highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@update_viewer</span><span class="p">(</span><span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">hide_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Hide given object(s).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    obj :   str | list</span>
<span class="sd">            Object(s) to hide.</span>

<span class="sd">    """</span>
    <span class="n">objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span>  <span class="c1"># grab once to speed things up</span>
    <span class="k">for</span> <span class="n">ob</span> <span class="ow">in</span> <span class="n">utils</span><span class="o">.</span><span class="n">make_iterable</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">ob</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">objects</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s1">'Object "</span><span class="si">{</span><span class="n">ob</span><span class="si">}</span><span class="s1">" not found on canvas.'</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">objects</span><span class="p">[</span><span class="n">ob</span><span class="p">]:</span>
            <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="s2">"_pinned"</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">visible</span><span class="p">:</span>
                <span class="n">v</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="kc">False</span>
</code></pre></div></td></tr></tbody></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id="octarine.Viewer.hide_selected" class="doc doc-heading"> <code class="highlight language-python"><span class="n">hide_selected</span><span class="p">()</span></code> <a href="#octarine.Viewer.hide_selected" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <p>Hide currently selected object(s).</p> <details class="quote"> <summary>Source code in <code>octarine/viewer.py</code></summary> <div class="highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@update_viewer</span><span class="p">(</span><span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">hide_selected</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Hide currently selected object(s)."""</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">hide_neurons</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selected</span><span class="p">)</span>
</code></pre></div></td></tr></tbody></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id="octarine.Viewer.highlight_objects" class="doc doc-heading"> <code class="highlight language-python"><span class="n">highlight_objects</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span></code> <a href="#octarine.Viewer.highlight_objects" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <p>Highlight given object(s) by increasing their brightness.</p> <table> <thead> <tr> <th><span class="doc-section-title">PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class="doc-section-item"> <td> <code>obj</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>Object(s) to highlight. Can be the name(s) or ID(s) of
the object(s), their index(es) in the list of visuals,
or the visual(s) themselves. Objects already highlighted
will be silently ignored.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> str | int | list | visual</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>color</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>Color to use for highlighting. If a float, will change
the HSV value of the current color. If a tuple, will
use the RGB(A) color.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a> | <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a></code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>0.2</code> </span> </p> </td> </tr> </tbody> </table> <details class="see-also" open> <summary>See Also</summary> <p>Viewer.unhighlight_objects Use to remove highlights.</p> </details> <details class="quote"> <summary>Source code in <code>octarine/viewer.py</code></summary> <div class="highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">highlight_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="mf">0.2</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Highlight given object(s) by increasing their brightness.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    obj :   str | int | list | visual</span>
<span class="sd">            Object(s) to highlight. Can be the name(s) or ID(s) of</span>
<span class="sd">            the object(s), their index(es) in the list of visuals,</span>
<span class="sd">            or the visual(s) themselves. Objects already highlighted</span>
<span class="sd">            will be silently ignored.</span>
<span class="sd">    color : float | tuple</span>
<span class="sd">            Color to use for highlighting. If a float, will change</span>
<span class="sd">            the HSV value of the current color. If a tuple, will</span>
<span class="sd">            use the RGB(A) color.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    Viewer.unhighlight_objects</span>
<span class="sd">            Use to remove highlights.</span>

<span class="sd">    """</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">utils</span><span class="o">.</span><span class="n">is_iterable</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
        <span class="n">objects</span> <span class="o">=</span> <span class="p">[</span><span class="n">obj</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">objects</span> <span class="o">=</span> <span class="n">obj</span>

    <span class="n">all_objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span>  <span class="c1"># grab once to speed things up</span>

    <span class="k">for</span> <span class="n">ob</span> <span class="ow">in</span> <span class="n">objects</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ob</span> <span class="ow">in</span> <span class="n">all_objects</span><span class="p">:</span>
            <span class="n">list_</span> <span class="o">=</span> <span class="n">all_objects</span><span class="p">[</span><span class="n">ob</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ob</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">list_</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="n">ob</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ob</span><span class="p">,</span> <span class="n">gfx</span><span class="o">.</span><span class="n">WorldObject</span><span class="p">):</span>
            <span class="n">list_</span> <span class="o">=</span> <span class="p">[</span><span class="n">ob</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Unknown object type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">ob</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">list_</span><span class="p">:</span>
            <span class="c1"># Skip if object is pinned</span>
            <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="s2">"_pinned"</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="c1"># Skip if object is already highlighted</span>
            <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="s2">"_highlighted"</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
                <span class="c1"># Work in HSL space</span>
                <span class="n">h</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">l</span> <span class="o">=</span> <span class="n">o</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">to_hsl</span><span class="p">()</span>
                <span class="c1"># If the value is not maxed yet, increase it</span>
                <span class="k">if</span> <span class="n">l</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">l</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="n">color</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">l</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">l</span> <span class="o">-</span> <span class="n">color</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

                <span class="n">new_color</span> <span class="o">=</span> <span class="n">gfx</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">from_hsl</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># See if pygfx can handle the color</span>
                <span class="n">new_color</span> <span class="o">=</span> <span class="n">gfx</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>

            <span class="n">o</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">_original_color</span> <span class="o">=</span> <span class="n">o</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">color</span>
            <span class="n">o</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">new_color</span>
            <span class="n">o</span><span class="o">.</span><span class="n">_highlighted</span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></div></td></tr></tbody></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id="octarine.Viewer.pin_objects" class="doc doc-heading"> <code class="highlight language-python"><span class="n">pin_objects</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span></code> <a href="#octarine.Viewer.pin_objects" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <p>Pin given object(s).</p> <p>Changes to the color or visibility of pinned neurons are silently ignored. You can use this to keep specific neurons visible while cycling through the rest - useful for comparisons.</p> <details class="quote"> <summary>Source code in <code>octarine/viewer.py</code></summary> <div class="highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1750</span>
<span class="normal">1751</span>
<span class="normal">1752</span>
<span class="normal">1753</span>
<span class="normal">1754</span>
<span class="normal">1755</span>
<span class="normal">1756</span>
<span class="normal">1757</span>
<span class="normal">1758</span>
<span class="normal">1759</span>
<span class="normal">1760</span>
<span class="normal">1761</span>
<span class="normal">1762</span>
<span class="normal">1763</span>
<span class="normal">1764</span>
<span class="normal">1765</span>
<span class="normal">1766</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">pin_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Pin given object(s).</span>

<span class="sd">    Changes to the color or visibility of pinned neurons are silently</span>
<span class="sd">    ignored. You can use this to keep specific neurons visible while</span>
<span class="sd">    cycling through the rest - useful for comparisons.</span>

<span class="sd">    """</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">make_iterable</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
    <span class="n">objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span>  <span class="c1"># grab only once to speed things up</span>

    <span class="k">for</span> <span class="n">ob</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ob</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">objects</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Object </span><span class="si">{</span><span class="n">ob</span><span class="si">}</span><span class="s2"> not found on canvas."</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">objects</span><span class="p">[</span><span class="n">ob</span><span class="p">]:</span>
            <span class="n">v</span><span class="o">.</span><span class="n">_pinned</span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></div></td></tr></tbody></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id="octarine.Viewer.pop" class="doc doc-heading"> <code class="highlight language-python"><span class="n">pop</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code> <a href="#octarine.Viewer.pop" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <p>Remove the most recently added N visuals.</p> <details class="quote"> <summary>Source code in <code>octarine/viewer.py</code></summary> <div class="highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@update_viewer</span><span class="p">(</span><span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">pop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Remove the most recently added N visuals."""</span>
    <span class="k">for</span> <span class="n">vis</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="o">-</span><span class="n">N</span><span class="p">:]:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">remove_objects</span><span class="p">(</span><span class="n">vis</span><span class="p">)</span>
</code></pre></div></td></tr></tbody></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id="octarine.Viewer.remove_animation" class="doc doc-heading"> <code class="highlight language-python"><span class="n">remove_animation</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></code> <a href="#octarine.Viewer.remove_animation" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <p>Remove animation function from the Viewer.</p> <table> <thead> <tr> <th><span class="doc-section-title">PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class="doc-section-item"> <td> <code>x</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>Either the function itself or its index
in the list of animations.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> callable | int</code> </span> </p> </td> </tr> </tbody> </table> <details class="quote"> <summary>Source code in <code>octarine/viewer.py</code></summary> <div class="highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">remove_animation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Remove animation function from the Viewer.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x :     callable | int</span>
<span class="sd">            Either the function itself or its index</span>
<span class="sd">            in the list of animations.</span>

<span class="sd">    """</span>
    <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_animations_flagged_for_removal</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_animations_flagged_for_removal</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_animations</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="n">x</span><span class="p">]</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Expected callable or index (int), got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</code></pre></div></td></tr></tbody></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id="octarine.Viewer.remove_bounds" class="doc doc-heading"> <code class="highlight language-python"><span class="n">remove_bounds</span><span class="p">()</span></code> <a href="#octarine.Viewer.remove_bounds" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <p>Remove bounding box visual.</p> <details class="quote"> <summary>Source code in <code>octarine/viewer.py</code></summary> <div class="highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">remove_bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Remove bounding box visual."""</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_show_bounds</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">visuals</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="s2">"_object_type"</span><span class="p">,</span> <span class="s2">""</span><span class="p">)</span> <span class="o">==</span> <span class="s2">"boundingbox"</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_objects</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
</code></pre></div></td></tr></tbody></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id="octarine.Viewer.remove_objects" class="doc doc-heading"> <code class="highlight language-python"><span class="n">remove_objects</span><span class="p">(</span><span class="n">to_remove</span><span class="p">)</span></code> <a href="#octarine.Viewer.remove_objects" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <p>Remove given neurons/visuals from canvas.</p> <details class="quote"> <summary>Source code in <code>octarine/viewer.py</code></summary> <div class="highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@update_viewer</span><span class="p">(</span><span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">remove_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">to_remove</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Remove given neurons/visuals from canvas."""</span>
    <span class="n">to_remove</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">make_iterable</span><span class="p">(</span><span class="n">to_remove</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">vis</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">children</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">vis</span> <span class="ow">in</span> <span class="n">to_remove</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">vis</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">vis</span><span class="p">,</span> <span class="s2">"_object_id"</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">vis</span><span class="o">.</span><span class="n">_object_id</span> <span class="ow">in</span> <span class="n">to_remove</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">vis</span><span class="p">)</span>
</code></pre></div></td></tr></tbody></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id="octarine.Viewer.resize" class="doc doc-heading"> <code class="highlight language-python"><span class="n">resize</span><span class="p">(</span><span class="n">size</span><span class="p">)</span></code> <a href="#octarine.Viewer.resize" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <p>Resize canvas.</p> <table> <thead> <tr> <th><span class="doc-section-title">PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class="doc-section-item"> <td> <code>size</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>New size of the canvas.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> (width, height) tuple</code> </span> </p> </td> </tr> </tbody> </table> <details class="quote"> <summary>Source code in <code>octarine/viewer.py</code></summary> <div class="highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">resize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Resize canvas.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    size :  (width, height) tuple</span>
<span class="sd">            New size of the canvas.</span>
<span class="sd">    """</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">size</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">set_logical_size</span><span class="p">(</span><span class="o">*</span><span class="n">size</span><span class="p">)</span>
</code></pre></div></td></tr></tbody></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id="octarine.Viewer.screenshot" class="doc doc-heading"> <code class="highlight language-python"><span class="n">screenshot</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">'screenshot.png'</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pixel_ratio</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code> <a href="#octarine.Viewer.screenshot" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <p>Save a screenshot of the canvas.</p> <table> <thead> <tr> <th><span class="doc-section-title">PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class="doc-section-item"> <td> <code>filename</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>        Filename to save to. If ``None``, will return image array.
        Note that this will always save a PNG file, no matter
        the extension.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> str | pathlib.Path</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>'screenshot.png'</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>size</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>        Size of the screenshot. If provided, will temporarily
        change the canvas size.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> tuple</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>pixel_ratio</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>        Factor by which to scale canvas. Determines image
        dimensions. Note that this seems to have no effect
        on offscreen canvases.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> int</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>alpha</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>        If True, will export transparent background.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> bool</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>True</code> </span> </p> </td> </tr> </tbody> </table> <details class="quote"> <summary>Source code in <code>octarine/viewer.py</code></summary> <div class="highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1918</span>
<span class="normal">1919</span>
<span class="normal">1920</span>
<span class="normal">1921</span>
<span class="normal">1922</span>
<span class="normal">1923</span>
<span class="normal">1924</span>
<span class="normal">1925</span>
<span class="normal">1926</span>
<span class="normal">1927</span>
<span class="normal">1928</span>
<span class="normal">1929</span>
<span class="normal">1930</span>
<span class="normal">1931</span>
<span class="normal">1932</span>
<span class="normal">1933</span>
<span class="normal">1934</span>
<span class="normal">1935</span>
<span class="normal">1936</span>
<span class="normal">1937</span>
<span class="normal">1938</span>
<span class="normal">1939</span>
<span class="normal">1940</span>
<span class="normal">1941</span>
<span class="normal">1942</span>
<span class="normal">1943</span>
<span class="normal">1944</span>
<span class="normal">1945</span>
<span class="normal">1946</span>
<span class="normal">1947</span>
<span class="normal">1948</span>
<span class="normal">1949</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">screenshot</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s2">"screenshot.png"</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pixel_ratio</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="kc">True</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">"""Save a screenshot of the canvas.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    filename :      str | pathlib.Path, optional</span>
<span class="sd">                    Filename to save to. If ``None``, will return image array.</span>
<span class="sd">                    Note that this will always save a PNG file, no matter</span>
<span class="sd">                    the extension.</span>
<span class="sd">    size :          tuple, optional</span>
<span class="sd">                    Size of the screenshot. If provided, will temporarily</span>
<span class="sd">                    change the canvas size.</span>
<span class="sd">    pixel_ratio :   int, optional</span>
<span class="sd">                    Factor by which to scale canvas. Determines image</span>
<span class="sd">                    dimensions. Note that this seems to have no effect</span>
<span class="sd">                    on offscreen canvases.</span>
<span class="sd">    alpha :         bool, optional</span>
<span class="sd">                    If True, will export transparent background.</span>

<span class="sd">    """</span>
    <span class="n">im</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_screenshot</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">pixel_ratio</span><span class="o">=</span><span class="n">pixel_ratio</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">filename</span><span class="p">:</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">suffix</span> <span class="o">!=</span> <span class="s2">".png"</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">filename</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">.png"</span>
        <span class="n">png</span><span class="o">.</span><span class="n">from_array</span><span class="p">(</span>
            <span class="n">im</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">im</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">im</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">im</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="n">mode</span><span class="o">=</span><span class="s2">"RGBA"</span>
        <span class="p">)</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">filename</span><span class="o">.</span><span class="n">resolve</span><span class="p">()))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">im</span>
</code></pre></div></td></tr></tbody></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id="octarine.Viewer.set_alpha_mode" class="doc doc-heading"> <code class="highlight language-python"><span class="n">set_alpha_mode</span><span class="p">(</span><span class="n">mode</span><span class="p">,</span> <span class="n">objects</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code> <a href="#octarine.Viewer.set_alpha_mode" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <p>Defines how objects' colors are blended.</p> <p>With version v0.13.0 pygfx replaced the single renderer.blend_mode property with customizable per-material alpha modes. The Viewer.set_alpha_mode function provides a high-level interface to these settings. If you need more fine-grained control, see the material.alpha_mode property of individual objects.</p> <table> <thead> <tr> <th><span class="doc-section-title">PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class="doc-section-item"> <td> <code>mode</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    The mode to set. Please see the pygfx documentation for details:
      &gt;&gt;&gt; import pygfx
      &gt;&gt;&gt; help(pygfx.Material.alpha_mode)
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> str</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>objects</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    Objects to set the alpha mode for. If None, will set for all objects.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> list</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> </tbody> </table> <details class="quote"> <summary>Source code in <code>octarine/viewer.py</code></summary> <div class="highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1787</span>
<span class="normal">1788</span>
<span class="normal">1789</span>
<span class="normal">1790</span>
<span class="normal">1791</span>
<span class="normal">1792</span>
<span class="normal">1793</span>
<span class="normal">1794</span>
<span class="normal">1795</span>
<span class="normal">1796</span>
<span class="normal">1797</span>
<span class="normal">1798</span>
<span class="normal">1799</span>
<span class="normal">1800</span>
<span class="normal">1801</span>
<span class="normal">1802</span>
<span class="normal">1803</span>
<span class="normal">1804</span>
<span class="normal">1805</span>
<span class="normal">1806</span>
<span class="normal">1807</span>
<span class="normal">1808</span>
<span class="normal">1809</span>
<span class="normal">1810</span>
<span class="normal">1811</span>
<span class="normal">1812</span>
<span class="normal">1813</span>
<span class="normal">1814</span>
<span class="normal">1815</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@update_viewer</span><span class="p">(</span><span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">set_alpha_mode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">objects</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Defines how objects' colors are blended.</span>

<span class="sd">    With version v0.13.0 pygfx replaced the single renderer.blend_mode property with</span>
<span class="sd">    customizable per-material alpha modes. The Viewer.set_alpha_mode function provides</span>
<span class="sd">    a high-level interface to these settings. If you need more fine-grained control,</span>
<span class="sd">    see the material.alpha_mode property of individual objects.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    mode :      str</span>
<span class="sd">                The mode to set. Please see the pygfx documentation for details:</span>
<span class="sd">                  &gt;&gt;&gt; import pygfx</span>
<span class="sd">                  &gt;&gt;&gt; help(pygfx.Material.alpha_mode)</span>
<span class="sd">    objects :   list, optional</span>
<span class="sd">                Objects to set the alpha mode for. If None, will set for all objects.</span>

<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">objects</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">objects</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">objects</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span><span class="p">[</span><span class="n">n</span><span class="p">]:</span>
            <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="s2">"_pinned"</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="s2">"material"</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="n">v</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">alpha_mode</span> <span class="o">=</span> <span class="n">mode</span>
</code></pre></div></td></tr></tbody></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id="octarine.Viewer.set_bgcolor" class="doc doc-heading"> <code class="highlight language-python"><span class="n">set_bgcolor</span><span class="p">(</span><span class="n">c</span><span class="p">)</span></code> <a href="#octarine.Viewer.set_bgcolor" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <p>Set background color.</p> <table> <thead> <tr> <th><span class="doc-section-title">PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class="doc-section-item"> <td> <code>c</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>RGB(A) color to use for the background.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> tuple | str</code> </span> </p> </td> </tr> </tbody> </table> <details class="quote"> <summary>Source code in <code>octarine/viewer.py</code></summary> <div class="highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1903</span>
<span class="normal">1904</span>
<span class="normal">1905</span>
<span class="normal">1906</span>
<span class="normal">1907</span>
<span class="normal">1908</span>
<span class="normal">1909</span>
<span class="normal">1910</span>
<span class="normal">1911</span>
<span class="normal">1912</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_bgcolor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Set background color.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    c :     tuple | str</span>
<span class="sd">            RGB(A) color to use for the background.</span>

<span class="sd">    """</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_background</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">set_colors</span><span class="p">(</span><span class="n">gfx</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">rgba</span><span class="p">)</span>
</code></pre></div></td></tr></tbody></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id="octarine.Viewer.set_colors" class="doc doc-heading"> <code class="highlight language-python"><span class="n">set_colors</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">alpha_mode</span><span class="o">=</span><span class="s1">'auto'</span><span class="p">)</span></code> <a href="#octarine.Viewer.set_colors" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <p>Set object color.</p> <table> <thead> <tr> <th><span class="doc-section-title">PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class="doc-section-item"> <td> <code>c</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>RGB color(s) to apply. Values must be 0-1. Accepted:
   1. Tuple of single color. Applied to all visible objects.
   2. Dictionary names/IDs to colors.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> tuple | dict</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>alpha_mode</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>If "auto" (default), will set the alpha mode to "add" if the
opacity is &lt; 1, and "opaque" otherwise. Set `alpha_mode` to `None` to
skip this adjustment.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>'auto'</code> </span> </p> </td> </tr> </tbody> </table> <details class="quote"> <summary>Source code in <code>octarine/viewer.py</code></summary> <div class="highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1817</span>
<span class="normal">1818</span>
<span class="normal">1819</span>
<span class="normal">1820</span>
<span class="normal">1821</span>
<span class="normal">1822</span>
<span class="normal">1823</span>
<span class="normal">1824</span>
<span class="normal">1825</span>
<span class="normal">1826</span>
<span class="normal">1827</span>
<span class="normal">1828</span>
<span class="normal">1829</span>
<span class="normal">1830</span>
<span class="normal">1831</span>
<span class="normal">1832</span>
<span class="normal">1833</span>
<span class="normal">1834</span>
<span class="normal">1835</span>
<span class="normal">1836</span>
<span class="normal">1837</span>
<span class="normal">1838</span>
<span class="normal">1839</span>
<span class="normal">1840</span>
<span class="normal">1841</span>
<span class="normal">1842</span>
<span class="normal">1843</span>
<span class="normal">1844</span>
<span class="normal">1845</span>
<span class="normal">1846</span>
<span class="normal">1847</span>
<span class="normal">1848</span>
<span class="normal">1849</span>
<span class="normal">1850</span>
<span class="normal">1851</span>
<span class="normal">1852</span>
<span class="normal">1853</span>
<span class="normal">1854</span>
<span class="normal">1855</span>
<span class="normal">1856</span>
<span class="normal">1857</span>
<span class="normal">1858</span>
<span class="normal">1859</span>
<span class="normal">1860</span>
<span class="normal">1861</span>
<span class="normal">1862</span>
<span class="normal">1863</span>
<span class="normal">1864</span>
<span class="normal">1865</span>
<span class="normal">1866</span>
<span class="normal">1867</span>
<span class="normal">1868</span>
<span class="normal">1869</span>
<span class="normal">1870</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@update_viewer</span><span class="p">(</span><span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">set_colors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">alpha_mode</span><span class="o">=</span><span class="s2">"auto"</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Set object color.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    c :     tuple | dict</span>
<span class="sd">            RGB color(s) to apply. Values must be 0-1. Accepted:</span>
<span class="sd">               1. Tuple of single color. Applied to all visible objects.</span>
<span class="sd">               2. Dictionary names/IDs to colors.</span>
<span class="sd">    alpha_mode : str</span>
<span class="sd">            If "auto" (default), will set the alpha mode to "add" if the</span>
<span class="sd">            opacity is &lt; 1, and "opaque" otherwise. Set `alpha_mode` to `None` to</span>
<span class="sd">            skip this adjustment.</span>

<span class="sd">    """</span>
    <span class="n">objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span>  <span class="c1"># grab once to speed things up</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">str</span><span class="p">)):</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="p">{</span><span class="n">s</span><span class="p">:</span> <span class="n">c</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">objects</span><span class="p">}</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="n">c</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">'Unable to use colors of type "</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="si">}</span><span class="s1">"'</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">objects</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">cmap</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">objects</span><span class="p">[</span><span class="n">n</span><span class="p">]:</span>
                <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="s2">"_pinned"</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
                    <span class="k">continue</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="s2">"material"</span><span class="p">):</span>
                    <span class="k">continue</span>
                <span class="c1"># Note: there is currently a bug where removing or adding an alpha</span>
                <span class="c1"># channel from a color will break the rendering pipeline</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">color</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                    <span class="n">new_c</span> <span class="o">=</span> <span class="n">gfx</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="n">cmap</span><span class="p">[</span><span class="n">n</span><span class="p">])</span><span class="o">.</span><span class="n">rgba</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">new_c</span> <span class="o">=</span> <span class="n">gfx</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="n">cmap</span><span class="p">[</span><span class="n">n</span><span class="p">])</span><span class="o">.</span><span class="n">rgb</span>
                <span class="n">v</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">gfx</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="n">new_c</span><span class="p">)</span>

                <span class="c1"># Determine if we consider this transparent</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_c</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span> <span class="ow">and</span> <span class="n">new_c</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">is_transparent</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">elif</span> <span class="n">v</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">opacity</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">is_transparent</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">is_transparent</span> <span class="o">=</span> <span class="kc">False</span>

                <span class="k">if</span> <span class="n">alpha_mode</span> <span class="o">==</span> <span class="s2">"auto"</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">is_transparent</span><span class="p">:</span>
                        <span class="n">v</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">alpha_mode</span> <span class="o">=</span> <span class="s2">"add"</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">v</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">alpha_mode</span> <span class="o">=</span> <span class="s2">"solid"</span>
                <span class="k">elif</span> <span class="n">alpha_mode</span><span class="p">:</span>
                    <span class="n">v</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">alpha_mode</span> <span class="o">=</span> <span class="n">alpha_mode</span>
</code></pre></div></td></tr></tbody></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id="octarine.Viewer.set_view" class="doc doc-heading"> <code class="highlight language-python"><span class="n">set_view</span><span class="p">(</span><span class="n">view</span><span class="p">)</span></code> <a href="#octarine.Viewer.set_view" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <p>(Re-)set camera position.</p> <table> <thead> <tr> <th><span class="doc-section-title">PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class="doc-section-item"> <td> <code>view</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    View to set. Can be inverted to e.g. "-XY" to show view from back.
    If a dictionary, should describe the state of the camera. Typically,
    this is obtained by calling `viewer.get_view()`.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> XY | XZ | YZ | dict</code> </span> </p> </td> </tr> </tbody> </table> <details class="quote"> <summary>Source code in <code>octarine/viewer.py</code></summary> <div class="highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1988</span>
<span class="normal">1989</span>
<span class="normal">1990</span>
<span class="normal">1991</span>
<span class="normal">1992</span>
<span class="normal">1993</span>
<span class="normal">1994</span>
<span class="normal">1995</span>
<span class="normal">1996</span>
<span class="normal">1997</span>
<span class="normal">1998</span>
<span class="normal">1999</span>
<span class="normal">2000</span>
<span class="normal">2001</span>
<span class="normal">2002</span>
<span class="normal">2003</span>
<span class="normal">2004</span>
<span class="normal">2005</span>
<span class="normal">2006</span>
<span class="normal">2007</span>
<span class="normal">2008</span>
<span class="normal">2009</span>
<span class="normal">2010</span>
<span class="normal">2011</span>
<span class="normal">2012</span>
<span class="normal">2013</span>
<span class="normal">2014</span>
<span class="normal">2015</span>
<span class="normal">2016</span>
<span class="normal">2017</span>
<span class="normal">2018</span>
<span class="normal">2019</span>
<span class="normal">2020</span>
<span class="normal">2021</span>
<span class="normal">2022</span>
<span class="normal">2023</span>
<span class="normal">2024</span>
<span class="normal">2025</span>
<span class="normal">2026</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_view</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">view</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""(Re-)set camera position.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    view :      XY | XZ | YZ | dict</span>
<span class="sd">                View to set. Can be inverted to e.g. "-XY" to show view from back.</span>
<span class="sd">                If a dictionary, should describe the state of the camera. Typically,</span>
<span class="sd">                this is obtained by calling `viewer.get_view()`.</span>

<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">view</span> <span class="o">==</span> <span class="s2">"XY"</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">show_object</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">,</span> <span class="n">view_dir</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="n">up</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">view</span> <span class="o">==</span> <span class="s2">"-XY"</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">show_object</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">,</span> <span class="n">view_dir</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">),</span> <span class="n">up</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">view</span> <span class="o">==</span> <span class="s2">"XZ"</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">show_object</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">view_dir</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="n">up</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">view</span> <span class="o">==</span> <span class="s2">"-XZ"</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">show_object</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">view_dir</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="n">up</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">view</span> <span class="o">==</span> <span class="s2">"YZ"</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">show_object</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">view_dir</span><span class="o">=</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="n">up</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">view</span> <span class="o">==</span> <span class="s2">"YZ"</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">show_object</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">view_dir</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="n">up</span><span class="o">=</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">view</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">set_state</span><span class="p">(</span><span class="n">view</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Unable to set view from </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">view</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</code></pre></div></td></tr></tbody></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id="octarine.Viewer.show" class="doc doc-heading"> <code class="highlight language-python"><span class="n">show</span><span class="p">(</span><span class="n">use_sidecar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">toolbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">start_loop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code> <a href="#octarine.Viewer.show" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <p>Show viewer.</p> <table> <thead> <tr> <th><span class="doc-section-title">PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class="doc-section-item"> <td> <code>For</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> </div> <p> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>use_sidecar</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>      If True, will use the Sidecar extension to display the
      viewer outside the notebooks. Will throw an error if
      Sidecar is not installed.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>False</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>toolbar</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>      If True, will show a toolbar. You can always show/hide
      the toolbar with ``viewer.show_controls()`` and
      ``viewer.hide_controls()``, or the `c` hotkey.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> bool</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>False</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>For</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> </div> <p> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>start_loop</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>      If True, will start the blocking (!) event loop. This is
      the recommended way to show the viewer when using it in a script.
      From an interactive REPL such as IPython you should be able to
      just call ``Viewer.show()`` and the interactive viewer will appear
      while still allowing you to interact with the REPL.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> bool</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>False</code> </span> </p> </td> </tr> </tbody> </table> <details class="quote"> <summary>Source code in <code>octarine/viewer.py</code></summary> <div class="highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span>
<span class="normal">975</span>
<span class="normal">976</span>
<span class="normal">977</span>
<span class="normal">978</span>
<span class="normal">979</span>
<span class="normal">980</span>
<span class="normal">981</span>
<span class="normal">982</span>
<span class="normal">983</span>
<span class="normal">984</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">use_sidecar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">toolbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">start_loop</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Show viewer.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    For Jupyter lab only:</span>

<span class="sd">    use_sidecar : bool</span>
<span class="sd">                  If True, will use the Sidecar extension to display the</span>
<span class="sd">                  viewer outside the notebooks. Will throw an error if</span>
<span class="sd">                  Sidecar is not installed.</span>
<span class="sd">    toolbar :     bool</span>
<span class="sd">                  If True, will show a toolbar. You can always show/hide</span>
<span class="sd">                  the toolbar with ``viewer.show_controls()`` and</span>
<span class="sd">                  ``viewer.hide_controls()``, or the `c` hotkey.</span>

<span class="sd">    For scripts &amp; standard REPL:</span>

<span class="sd">    start_loop :  bool</span>
<span class="sd">                  If True, will start the blocking (!) event loop. This is</span>
<span class="sd">                  the recommended way to show the viewer when using it in a script.</span>
<span class="sd">                  From an interactive REPL such as IPython you should be able to</span>
<span class="sd">                  just call ``Viewer.show()`` and the interactive viewer will appear</span>
<span class="sd">                  while still allowing you to interact with the REPL.</span>

<span class="sd">    """</span>
    <span class="c1"># This is for e.g. headless testing</span>
    <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="s2">"HEADLESS"</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">"Viewer widget not shown - running in headless mode."</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="c1"># Start the animation loop</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">request_draw</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_animate</span><span class="p">)</span>

    <span class="c1"># If this is an offscreen canvas, we don't need to do anything else</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">,</span> <span class="n">OffscreenRenderCanvas</span><span class="p">):</span>
        <span class="k">return</span>

    <span class="c1"># In terminal we can just show the window</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_jupyter</span><span class="p">:</span>
        <span class="c1"># Not all backends have a show method (e.g. GLFW does not)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">,</span> <span class="s2">"show"</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">start_loop</span><span class="p">:</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">rendercanvas.auto</span><span class="w"> </span><span class="kn">import</span> <span class="n">loop</span>

            <span class="n">loop</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">utils</span><span class="o">.</span><span class="n">_type_of_script</span><span class="p">()</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">"terminal"</span><span class="p">,</span> <span class="s2">"script"</span><span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">"Running in a (potentially) non-interactive terminal or script "</span>
                <span class="s2">"environment. You may have to manually start the event loop "</span>
                <span class="s2">"for the canvas to render:</span><span class="se">\n\n</span><span class="s2">"</span>
                <span class="s2">"  &gt;&gt;&gt; v = octarine.Viewer(show=False)</span><span class="se">\n</span><span class="s2">"</span>
                <span class="s2">"  &gt;&gt;&gt; ...  # setup your viewer</span><span class="se">\n</span><span class="s2">"</span>
                <span class="s2">"  &gt;&gt;&gt; v.show(start_loop=True)</span><span class="se">\n\n</span><span class="s2">"</span>
                <span class="s2">"Alternatively, use the loop.run() function:</span><span class="se">\n\n</span><span class="s2">"</span>
                <span class="s2">"  &gt;&gt;&gt; from rendercanvas.auto import loop</span><span class="se">\n</span><span class="s2">"</span>
                <span class="s2">"  &gt;&gt;&gt; ...  # setup your viewer</span><span class="se">\n</span><span class="s2">"</span>
                <span class="s2">"  &gt;&gt;&gt; v.show()</span><span class="se">\n</span><span class="s2">"</span>
                <span class="s2">"  &gt;&gt;&gt; loop.run()</span><span class="se">\n\n</span><span class="s2">"</span>  <span class="c1"># do not remove the \n\n here</span>
            <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># if not hasattr(self, 'widget'):</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">.jupyter</span><span class="w"> </span><span class="kn">import</span> <span class="n">JupyterOutput</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">display</span>

        <span class="c1"># Construct the widget</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">"widget"</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget</span> <span class="o">=</span> <span class="n">JupyterOutput</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span>
                <span class="n">use_sidecar</span><span class="o">=</span><span class="n">use_sidecar</span><span class="p">,</span>
                <span class="n">toolbar</span><span class="o">=</span><span class="n">toolbar</span><span class="p">,</span>
                <span class="n">sidecar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">"title"</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_title</span><span class="p">},</span>
            <span class="p">)</span>

        <span class="c1"># This will display the viewer right here and there</span>
        <span class="n">display</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="p">)</span>
</code></pre></div></td></tr></tbody></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id="octarine.Viewer.show_controls" class="doc doc-heading"> <code class="highlight language-python"><span class="n">show_controls</span><span class="p">()</span></code> <a href="#octarine.Viewer.show_controls" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <p>Show controls.</p> <details class="quote"> <summary>Source code in <code>octarine/viewer.py</code></summary> <div class="highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">show_controls</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Show controls."""</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_jupyter</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">toolbar</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">widget</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">"_controls"</span><span class="p">):</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">.controls</span><span class="w"> </span><span class="kn">import</span> <span class="n">Controls</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_controls</span> <span class="o">=</span> <span class="n">Controls</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_controls</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></tbody></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id="octarine.Viewer.show_message" class="doc doc-heading"> <code class="highlight language-python"><span class="n">show_message</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s1">'top-right'</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code> <a href="#octarine.Viewer.show_message" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <p>Show message on canvas.</p> <table> <thead> <tr> <th><span class="doc-section-title">PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class="doc-section-item"> <td> <code>message</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    Message to show. Set to `None` to remove the existing message.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> str | None</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>position</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    Position of the message on the canvas.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> "top-left" | "top-right" | "bottom-left" | "bottom-right" | "center"</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>'top-right'</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>font_size</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    Font size of the message.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>20</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>color</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    Color of the message. If `None`, will use white.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> str | tuple</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> <tr class="doc-section-item"> <td> <code>duration</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>    Number of seconds after which to fade the message.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> int</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> </tbody> </table> <details class="quote"> <summary>Source code in <code>octarine/viewer.py</code></summary> <div class="highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">show_message</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s2">"top-right"</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="kc">None</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">"""Show message on canvas.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    message :   str | None</span>
<span class="sd">                Message to show. Set to `None` to remove the existing message.</span>
<span class="sd">    position :  "top-left" | "top-right" | "bottom-left" | "bottom-right" | "center"</span>
<span class="sd">                Position of the message on the canvas.</span>
<span class="sd">    font_size : int, optional</span>
<span class="sd">                Font size of the message.</span>
<span class="sd">    color :     str | tuple, optional</span>
<span class="sd">                Color of the message. If `None`, will use white.</span>
<span class="sd">    duration :  int, optional</span>
<span class="sd">                Number of seconds after which to fade the message.</span>

<span class="sd">    """</span>
    <span class="k">if</span> <span class="n">message</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">"_message_text"</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_text</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">overlay_scene</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_message_text</span><span class="p">)</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_text</span>
        <span class="k">return</span>

    <span class="n">_positions</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">"top-left"</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="s2">"top-right"</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="s2">"bottom-left"</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.95</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.95</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="s2">"bottom-right"</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.95</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.95</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="s2">"center"</span><span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="n">position</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">_positions</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Unknown position: </span><span class="si">{</span><span class="n">position</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">"_message_text"</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_message_text</span> <span class="o">=</span> <span class="n">text2gfx</span><span class="p">(</span>
            <span class="n">message</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"white"</span><span class="p">,</span> <span class="n">font_size</span><span class="o">=</span><span class="n">font_size</span><span class="p">,</span> <span class="n">screen_space</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>

    <span class="c1"># Make sure the text is in the scene</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_text</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">overlay_scene</span><span class="o">.</span><span class="n">children</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">overlay_scene</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_message_text</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_message_text</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_message_text</span><span class="o">.</span><span class="n">font_size</span> <span class="o">=</span> <span class="n">font_size</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_message_text</span><span class="o">.</span><span class="n">anchor</span> <span class="o">=</span> <span class="n">position</span>
    <span class="k">if</span> <span class="n">color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_message_text</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">cmap</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="n">color</span><span class="p">)</span><span class="o">.</span><span class="n">rgba</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_message_text</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">opacity</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_message_text</span><span class="o">.</span><span class="n">local</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">_positions</span><span class="p">[</span><span class="n">position</span><span class="p">]</span>

    <span class="c1"># When do we need to start fading out?</span>
    <span class="k">if</span> <span class="n">duration</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fade_out_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">+</span> <span class="n">duration</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">_fade_message</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">"_message_text"</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">remove_animation</span><span class="p">(</span><span class="n">_fade_message</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fade_out_time</span><span class="p">:</span>
                    <span class="c1"># This means the text will fade fade over 1/0.02 = 50 frames</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_message_text</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">opacity</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_message_text</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">opacity</span> <span class="o">-</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mi">0</span>
                    <span class="p">)</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_text</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">opacity</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_message_text</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">overlay_scene</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_message_text</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">remove_animation</span><span class="p">(</span><span class="n">_fade_message</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_animation</span><span class="p">(</span><span class="n">_fade_message</span><span class="p">)</span>
</code></pre></div></td></tr></tbody></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id="octarine.Viewer.toggle_bounds" class="doc doc-heading"> <code class="highlight language-python"><span class="n">toggle_bounds</span><span class="p">()</span></code> <a href="#octarine.Viewer.toggle_bounds" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <p>Toggle bounding box.</p> <details class="quote"> <summary>Source code in <code>octarine/viewer.py</code></summary> <div class="highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">toggle_bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Toggle bounding box."""</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">show_bounds</span> <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">show_bounds</span>
</code></pre></div></td></tr></tbody></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id="octarine.Viewer.unhide_objects" class="doc doc-heading"> <code class="highlight language-python"><span class="n">unhide_objects</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code> <a href="#octarine.Viewer.unhide_objects" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <p>Unhide given object(s).</p> <table> <thead> <tr> <th><span class="doc-section-title">PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class="doc-section-item"> <td> <code>obj</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>Object(s) to unhide. If None, will unhide all objects.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> str | list | None</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> </tbody> </table> <details class="quote"> <summary>Source code in <code>octarine/viewer.py</code></summary> <div class="highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@update_viewer</span><span class="p">(</span><span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">unhide_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Unhide given object(s).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    obj :   str | list | None</span>
<span class="sd">            Object(s) to unhide. If None, will unhide all objects.</span>

<span class="sd">    """</span>
    <span class="n">objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span>  <span class="c1"># grab once to speed things up</span>
    <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ids</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">make_iterable</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ids</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">objects</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="k">for</span> <span class="n">ob</span> <span class="ow">in</span> <span class="n">ids</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ob</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">objects</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Object </span><span class="si">{</span><span class="n">ob</span><span class="si">}</span><span class="s2"> not found on canvas."</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">objects</span><span class="p">[</span><span class="n">ob</span><span class="p">]:</span>
            <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="s2">"_pinned"</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">v</span><span class="o">.</span><span class="n">visible</span><span class="p">:</span>
                <span class="n">v</span><span class="o">.</span><span class="n">visible</span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></div></td></tr></tbody></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id="octarine.Viewer.unhighlight_objects" class="doc doc-heading"> <code class="highlight language-python"><span class="n">unhighlight_objects</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code> <a href="#octarine.Viewer.unhighlight_objects" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <p>Unhighlight given object(s).</p> <table> <thead> <tr> <th><span class="doc-section-title">PARAMETER</span></th> <th><span>DESCRIPTION</span></th> </tr> </thead> <tbody> <tr class="doc-section-item"> <td> <code>obj</code> </td> <td class="doc-param-details"> <div class="doc-md-description"> <div class="highlight"><pre><span></span><code>Object(s) to unhighlight. Can be the name(s) or ID(s) of
the object(s), their index(es) in the list of visuals,
or the visual(s) themselves. If None, will unhighlight all
objects. Objects that aren't highlighted will be silently
ignored.
</code></pre></div> </div> <p> <span class="doc-param-annotation"> <b>TYPE:</b> <code> str | int | list | visual</code> </span> <span class="doc-param-default"> <b>DEFAULT:</b> <code>None</code> </span> </p> </td> </tr> </tbody> </table> <details class="see-also" open> <summary>See Also</summary> <p>Viewer.highlight_objects Use to highlight objects</p> </details> <details class="quote"> <summary>Source code in <code>octarine/viewer.py</code></summary> <div class="highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span>
<span class="normal">1726</span>
<span class="normal">1727</span>
<span class="normal">1728</span>
<span class="normal">1729</span>
<span class="normal">1730</span>
<span class="normal">1731</span>
<span class="normal">1732</span>
<span class="normal">1733</span>
<span class="normal">1734</span>
<span class="normal">1735</span>
<span class="normal">1736</span>
<span class="normal">1737</span>
<span class="normal">1738</span>
<span class="normal">1739</span>
<span class="normal">1740</span>
<span class="normal">1741</span>
<span class="normal">1742</span>
<span class="normal">1743</span>
<span class="normal">1744</span>
<span class="normal">1745</span>
<span class="normal">1746</span>
<span class="normal">1747</span>
<span class="normal">1748</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">unhighlight_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Unhighlight given object(s).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    obj :   str | int | list | visual</span>
<span class="sd">            Object(s) to unhighlight. Can be the name(s) or ID(s) of</span>
<span class="sd">            the object(s), their index(es) in the list of visuals,</span>
<span class="sd">            or the visual(s) themselves. If None, will unhighlight all</span>
<span class="sd">            objects. Objects that aren't highlighted will be silently</span>
<span class="sd">            ignored.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    Viewer.highlight_objects</span>
<span class="sd">            Use to highlight objects</span>

<span class="sd">    """</span>
    <span class="c1"># Important note: it looks like any attribute we added previously</span>
    <span class="c1"># will (at some point) have been silently renamed to "_Viewer{attribute}"</span>
    <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">visuals</span> <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="s2">"_highlighted"</span><span class="p">,</span> <span class="kc">False</span><span class="p">)]</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">utils</span><span class="o">.</span><span class="n">is_iterable</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
        <span class="n">objects</span> <span class="o">=</span> <span class="p">[</span><span class="n">obj</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">objects</span> <span class="o">=</span> <span class="n">obj</span>

    <span class="n">all_objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span>  <span class="c1"># grab once to speed things up</span>

    <span class="k">for</span> <span class="n">ob</span> <span class="ow">in</span> <span class="n">objects</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ob</span> <span class="ow">in</span> <span class="n">all_objects</span><span class="p">:</span>
            <span class="n">list_</span> <span class="o">=</span> <span class="n">all_objects</span><span class="p">[</span><span class="n">ob</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ob</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">list_</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">visuals</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="n">ob</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ob</span><span class="p">,</span> <span class="n">gfx</span><span class="o">.</span><span class="n">WorldObject</span><span class="p">):</span>
            <span class="n">list_</span> <span class="o">=</span> <span class="p">[</span><span class="n">ob</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Unknown object type: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">ob</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">list_</span><span class="p">:</span>
            <span class="c1"># Skip if object is pinned</span>
            <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="s2">"_pinned"</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
                <span class="k">continue</span>

            <span class="c1"># Skip if object isn't actually highlighed</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="s2">"_highlighted"</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="n">o</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">o</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">_original_color</span>
            <span class="k">del</span> <span class="n">o</span><span class="o">.</span><span class="n">material</span><span class="o">.</span><span class="n">_original_color</span>
            <span class="k">del</span> <span class="n">o</span><span class="o">.</span><span class="n">_highlighted</span>
</code></pre></div></td></tr></tbody></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id="octarine.Viewer.unpin_objects" class="doc doc-heading"> <code class="highlight language-python"><span class="n">unpin_objects</span><span class="p">(</span><span class="n">obj</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code> <a href="#octarine.Viewer.unpin_objects" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <p>Unpin given object(s).</p> <p>Use <code>obj</code> to unhide specific neurons.</p> <details class="quote"> <summary>Source code in <code>octarine/viewer.py</code></summary> <div class="highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1768</span>
<span class="normal">1769</span>
<span class="normal">1770</span>
<span class="normal">1771</span>
<span class="normal">1772</span>
<span class="normal">1773</span>
<span class="normal">1774</span>
<span class="normal">1775</span>
<span class="normal">1776</span>
<span class="normal">1777</span>
<span class="normal">1778</span>
<span class="normal">1779</span>
<span class="normal">1780</span>
<span class="normal">1781</span>
<span class="normal">1782</span>
<span class="normal">1783</span>
<span class="normal">1784</span>
<span class="normal">1785</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">unpin_objects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Unpin given object(s).</span>

<span class="sd">    Use ``obj`` to unhide specific neurons.</span>

<span class="sd">    """</span>
    <span class="n">objects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objects</span>  <span class="c1"># grab once to speed things up</span>
    <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">objects</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">make_iterable</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">ob</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ob</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">objects</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Object </span><span class="si">{</span><span class="n">ob</span><span class="si">}</span><span class="s2"> not found on canvas."</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">objects</span><span class="p">[</span><span class="n">ob</span><span class="p">]:</span>
            <span class="n">v</span><span class="o">.</span><span class="n">_pinned</span> <span class="o">=</span> <span class="kc">False</span>
</code></pre></div></td></tr></tbody></table></div> </details> </div> </div> <div class="doc doc-object doc-function"> <h3 id="octarine.Viewer.update_bounds" class="doc doc-heading"> <code class="highlight language-python"><span class="n">update_bounds</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">'w'</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code> <a href="#octarine.Viewer.update_bounds" class="headerlink" title="Permanent link">#</a></h3> <div class="doc doc-contents "> <p>Update bounding box visual.</p> <details class="quote"> <summary>Source code in <code>octarine/viewer.py</code></summary> <div class="highlight"><table class="highlighttable"><tbody><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">update_bounds</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"w"</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Update bounding box visual."""</span>
    <span class="c1"># Remove any existing visual</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">remove_bounds</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_show_bounds</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="c1"># Skip if no visual on canvas</span>
    <span class="n">bounds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">get_bounding_box</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bounds</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
        <span class="k">return</span>

    <span class="c1"># Create box visual</span>
    <span class="n">box</span> <span class="o">=</span> <span class="n">gfx</span><span class="o">.</span><span class="n">BoxHelper</span><span class="p">()</span>
    <span class="n">box</span><span class="o">.</span><span class="n">set_transform_by_aabb</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span>

    <span class="c1"># Add custom attributes</span>
    <span class="n">box</span><span class="o">.</span><span class="n">_object_type</span> <span class="o">=</span> <span class="s2">"boundingbox"</span>
    <span class="n">box</span><span class="o">.</span><span class="n">_object_id</span> <span class="o">=</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">box</span><span class="p">)</span>
</code></pre></div></td></tr></tbody></table></div> </details> </div> </div> </div> </div> </div> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <footer class="md-footer"> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class="md-copyright"> Made with <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener"> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class="md-dialog" data-md-component="dialog"> <div class="md-dialog__inner md-typeset"></div> </div> <script id="__config" type="application/json">{"base": "../..", "features": ["content.tabs.link", "content.code.annotate", "navigation.indexes", "navigation.instant", "content.code.copy"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script> <script src="../../assets/external/unpkg.com/mermaid@11/dist/mermaid.min.js"></script>  <script id="init-glightbox">document.querySelectorAll('.glightbox').forEach(function(element) {
    try {
        var img = element.querySelector('img');
        if (img && img.src) {
            element.setAttribute('href', img.src);
        } else {
            console.log('No img element with src attribute found');
        }
    } catch (error) {
        console.log('Error:', error);
    }
});
const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(()=>{ lightbox.reload(); });
</script></body></html>